# Phase 5: æ©Ÿèƒ½æ‹¡å¼µãƒ»ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹çµ±åˆ

## ğŸ“‹ æ¦‚è¦

ã“ã®Phaseã§ã¯ã€Power Apps Code Appsã«Dataverseã‚„ãã®ä»–ã®ã‚³ãƒã‚¯ã‚¿ãƒ¼ã‚’çµ±åˆã—ã€å®Ÿéš›ã®ãƒ“ã‚¸ãƒã‚¹ãƒ‡ãƒ¼ã‚¿ã¨é€£æºã™ã‚‹æ©Ÿèƒ½ã‚’å®Ÿè£…ã—ã¾ã™ã€‚

**ä¸»ãªå®Ÿæ–½å†…å®¹:**
- ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹æ¥ç¶šã®è¨­å®š
- Dataverseãƒ†ãƒ¼ãƒ–ãƒ«ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹
- ã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯ã®ä½œæˆ
- UIçµ±åˆã¨ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°
- æ©Ÿèƒ½æ‹¡å¼µã®å®Ÿè£…

---

## ğŸš€ ã‚¯ã‚¤ãƒƒã‚¯ãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹

### **å®Ÿæ–½ã™ã‚‹Stepï¼ˆæ¦‚è¦ï¼‰:**

1. **æ¥ç¶šä½œæˆ** - Power Appsãƒãƒ¼ã‚¿ãƒ«ã§ã‚³ãƒã‚¯ã‚¿ãƒ¼æ¥ç¶šã‚’æ‰‹å‹•ä½œæˆ
2. **æ¥ç¶šIDå–å¾—** - ãƒ–ãƒ©ã‚¦ã‚¶URLã‹ã‚‰æ¥ç¶šIDã‚’ã‚³ãƒ”ãƒ¼
3. **ã‚µãƒ¼ãƒ“ã‚¹ã‚¯ãƒ©ã‚¹ç”Ÿæˆ** - `pac code add-data-source` ã§TypeScriptå‹å®šç¾©ã‚’è‡ªå‹•ç”Ÿæˆ
4. **SDKåˆæœŸåŒ–ç¢ºèª** - `usePowerPlatform().isInitialized` ã§Power Apps SDKåˆæœŸåŒ–ã‚’ç¢ºèª
5. **ã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯ä½œæˆ** - ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ã‚’ã‚«ãƒ—ã‚»ãƒ«åŒ–ï¼ˆCRUDæ“ä½œï¼‰
6. **UIçµ±åˆ** - Reactã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã§ãƒ‡ãƒ¼ã‚¿ã‚’è¡¨ç¤ºãƒ»æ“ä½œ
7. **ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°** - `IOperationResult.isSuccess` ã§ã‚¨ãƒ©ãƒ¼å‡¦ç†

### **çµ±åˆã‚³ãƒãƒ³ãƒ‰ï¼ˆOffice 365 Usersï¼‰:**

```bash
# æ¥ç¶šä½œæˆï¼ˆPower Appsãƒãƒ¼ã‚¿ãƒ«ï¼‰â†’ æ¥ç¶šIDå–å¾—
pac code add-data-source -a "shared_office365users" -c "{æ¥ç¶šID}"
npm run build && npm run lint
```

### **çµ±åˆã‚³ãƒãƒ³ãƒ‰ï¼ˆDataverseï¼‰:**

```bash
# æ¥ç¶šä½œæˆï¼ˆPower Appsãƒãƒ¼ã‚¿ãƒ«ï¼‰â†’ æ¥ç¶šIDå–å¾—
pac code add-data-source -a "shared_commondataserviceforapps" -c "{æ¥ç¶šID}" -t "systemusers"
npm run build && npm run lint
```

### **Phase 5 å®Œäº†æ¡ä»¶:**

- âœ… Power Appsãƒãƒ¼ã‚¿ãƒ«ã§ã‚³ãƒã‚¯ã‚¿ãƒ¼æ¥ç¶šãŒä½œæˆã•ã‚Œã¦ã„ã‚‹
- âœ… æ¥ç¶šIDãŒæ­£ã—ãå–å¾—ã§ãã¦ã„ã‚‹
- âœ… `pac code add-data-source` ãŒæˆåŠŸã—ã€ã‚µãƒ¼ãƒ“ã‚¹ã‚¯ãƒ©ã‚¹ãŒç”Ÿæˆã•ã‚Œã¦ã„ã‚‹
- âœ… ã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯ãŒä½œæˆã•ã‚Œã€`isInitialized` ãƒã‚§ãƒƒã‚¯ãŒå®Ÿè£…ã•ã‚Œã¦ã„ã‚‹
- âœ… ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ãŒå®Ÿè£…ã•ã‚Œã¦ã„ã‚‹ï¼ˆ`IOperationResult.isSuccess` ç¢ºèªï¼‰
- âœ… ãƒ‡ãƒ¼ã‚¿ã®èª­ã¿å–ã‚ŠãŒæˆåŠŸã™ã‚‹
- âœ… CRUDæ“ä½œãŒæ­£å¸¸ã«å‹•ä½œã™ã‚‹ï¼ˆè©²å½“ã™ã‚‹å ´åˆï¼‰
- âœ… UIçµ±åˆãŒå®Œäº†ã—ã€ãƒ‡ãƒ¼ã‚¿ãŒæ­£ã—ãè¡¨ç¤ºã•ã‚Œã‚‹
- âœ… Power Appsç’°å¢ƒã§ã‚¢ãƒ—ãƒªãŒæ­£å¸¸ã«å‹•ä½œã™ã‚‹

> **âš ï¸ é‡è¦åŸå‰‡**: Power Apps Code Appsã§ã¯ã€**å¿…ãšPower Apps SDKçµŒç”±ã§è‡ªå‹•ç”Ÿæˆã•ã‚ŒãŸã‚µãƒ¼ãƒ“ã‚¹ã‚¯ãƒ©ã‚¹**ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚Dataverse Web APIã€Xrm.WebApiã€ç›´æ¥REST APIã¯ä½¿ç”¨ã—ãªã„ã§ãã ã•ã„ã€‚

---

## ğŸ¯ Phase 5ã®ç›®æ¨™

**Phase 5ã§ã¯ã€ãƒ¢ãƒƒã‚¯ãƒ‡ãƒ¼ã‚¿ã‹ã‚‰å®Ÿãƒ‡ãƒ¼ã‚¿ã¸ã®å®Œå…¨ç§»è¡Œã‚’å®Ÿç¾ã—ã¾ã™ã€‚**

**å®Œäº†æ¡ä»¶:**
- âœ… ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ãŒæ­£å¸¸ã«æ¥ç¶šã•ã‚Œã¦ã„ã‚‹
- âœ… Dataverseãƒ†ãƒ¼ãƒ–ãƒ«ã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã§ãã‚‹
- âœ… CRUDæ“ä½œãŒæ­£å¸¸ã«å‹•ä½œã™ã‚‹
- âœ… ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ãŒé©åˆ‡ã«å®Ÿè£…ã•ã‚Œã¦ã„ã‚‹
- âœ… ãƒ¢ãƒƒã‚¯ãƒ‡ãƒ¼ã‚¿ãŒå®Œå…¨ã«å‰Šé™¤ã•ã‚Œã¦ã„ã‚‹

---

## ğŸ—ï¸ ãƒªã‚¢ãƒ«ãƒ‡ãƒ¼ã‚¿æ¥ç¶šã®ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

### ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£æ¦‚è¦

Power Apps Code Appsã«ãŠã‘ã‚‹å®Ÿãƒ‡ãƒ¼ã‚¿æ¥ç¶šã¯ã€ä»¥ä¸‹ã®4ã¤ã®ã‚¹ãƒ†ãƒƒãƒ—ã§å®Ÿç¾ã•ã‚Œã¾ã™ã€‚

```mermaid
graph TB
    subgraph "Step 1: æ¥ç¶šIDå–å¾—"
        A1[Power Appsãƒãƒ¼ã‚¿ãƒ«] --> A2[ã‚³ãƒã‚¯ã‚¿ãƒ¼æ¥ç¶šä½œæˆ]
        A2 --> A3[URLã‹ã‚‰æ¥ç¶šIDã‚³ãƒ”ãƒ¼]
    end
    
    subgraph "Step 2: ã‚¹ã‚­ãƒ¼ãƒå–å¾—"
        B1[ã‚½ãƒªãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ] --> B2[customization.xmlã‚’æŠ½å‡º]
        B2 --> B3[ãƒ¯ãƒ¼ã‚¯ã‚¹ãƒšãƒ¼ã‚¹ãƒ«ãƒ¼ãƒˆã«é…ç½®]
    end
    
    subgraph "Step 3: ã‚µãƒ¼ãƒ“ã‚¹ã‚¯ãƒ©ã‚¹ç”Ÿæˆ"
        C1[pac code add-data-source] --> C2[TypeScriptå‹å®šç¾©ç”Ÿæˆ]
        C2 --> C3[Power Apps SDKçµ±åˆ]
    end
    
    subgraph "Step 4: ãƒ‡ãƒ¼ã‚¿çµ±åˆ"
        D1[ãƒ¢ãƒƒã‚¯ãƒ‡ãƒ¼ã‚¿å‰Šé™¤] --> D2[ã‚µãƒ¼ãƒ“ã‚¹ã‚¯ãƒ©ã‚¹å‘¼ã³å‡ºã—]
        D2 --> D3[Dataverseãƒ‡ãƒ¼ã‚¿è¡¨ç¤º]
    end
    
    A3 --> C1
    B3 --> C1
    C3 --> D1
    
    style A3 fill:#e3f2fd
    style B3 fill:#e8f5e9
    style C3 fill:#fff3e0
    style D3 fill:#f3e5f5
```

### ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼

```mermaid
sequenceDiagram
    participant User as ãƒ¦ãƒ¼ã‚¶ãƒ¼
    participant Portal as Power Appsãƒãƒ¼ã‚¿ãƒ«
    participant CLI as PAC CLI
    participant App as Code Apps
    participant SDK as Power Apps SDK
    participant DV as Dataverse
    
    User->>Portal: 1. ã‚³ãƒã‚¯ã‚¿ãƒ¼æ¥ç¶šä½œæˆ
    Portal-->>User: æ¥ç¶šID (URLã‹ã‚‰å–å¾—)
    
    User->>Portal: 2. ã‚½ãƒªãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ
    Portal-->>User: customization.xml
    
    User->>CLI: 3. pac code add-data-source
    Note over CLI: æ¥ç¶šID + customization.xmlä½¿ç”¨
    CLI-->>App: TypeScriptã‚µãƒ¼ãƒ“ã‚¹ã‚¯ãƒ©ã‚¹ç”Ÿæˆ
    
    User->>App: 4. ãƒ¢ãƒƒã‚¯ãƒ‡ãƒ¼ã‚¿å‰Šé™¤
    App->>SDK: ã‚µãƒ¼ãƒ“ã‚¹ã‚¯ãƒ©ã‚¹çµŒç”±ã§ãƒ‡ãƒ¼ã‚¿è¦æ±‚
    SDK->>DV: OData APIãƒªã‚¯ã‚¨ã‚¹ãƒˆ
    DV-->>SDK: ãƒ‡ãƒ¼ã‚¿è¿”å´
    SDK-->>App: TypeScriptå‹ä»˜ããƒ‡ãƒ¼ã‚¿
    App-->>User: UIã«å®Ÿãƒ‡ãƒ¼ã‚¿è¡¨ç¤º
```

### 4ã‚¹ãƒ†ãƒƒãƒ—ã®è©³ç´°

| ã‚¹ãƒ†ãƒƒãƒ— | å®Ÿæ–½å†…å®¹ | æˆæœç‰© | æ‰€è¦æ™‚é–“ |
|---------|---------|-------|---------|
| **1. æ¥ç¶šIDå–å¾—** | Power Appsãƒãƒ¼ã‚¿ãƒ«ã§æ‰‹å‹•æ¥ç¶šä½œæˆ â†’ URLã‹ã‚‰æ¥ç¶šIDã‚’ã‚³ãƒ”ãƒ¼ | æ¥ç¶šID (GUIDå½¢å¼) | 2-3åˆ† |
| **2. ã‚¹ã‚­ãƒ¼ãƒå–å¾—** | ã‚½ãƒªãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ â†’ customization.xmlã‚’ãƒ¯ãƒ¼ã‚¯ã‚¹ãƒšãƒ¼ã‚¹ãƒ«ãƒ¼ãƒˆã«é…ç½® | customization.xml | 5åˆ† |
| **3. ã‚µãƒ¼ãƒ“ã‚¹ã‚¯ãƒ©ã‚¹ç”Ÿæˆ** | `pac code add-data-source` å®Ÿè¡Œ â†’ Power Apps SDKãƒ™ãƒ¼ã‚¹ã®TypeScriptã‚³ãƒ¼ãƒ‰è‡ªå‹•ç”Ÿæˆ | ã‚µãƒ¼ãƒ“ã‚¹ã‚¯ãƒ©ã‚¹ (.ts) | 1-2åˆ† |
| **4. ãƒ‡ãƒ¼ã‚¿çµ±åˆ** | ãƒ¢ãƒƒã‚¯ãƒ‡ãƒ¼ã‚¿å‰Šé™¤ â†’ ã‚µãƒ¼ãƒ“ã‚¹ã‚¯ãƒ©ã‚¹å‘¼ã³å‡ºã—ã§Dataverseãƒ‡ãƒ¼ã‚¿å–å¾— | å®Ÿãƒ‡ãƒ¼ã‚¿è¡¨ç¤º | 10-30åˆ† |

### é‡è¦ãªæŠ€è¡“è¦ç´ 

#### Power Apps SDK ã®å½¹å‰²

```typescript
// Power Apps SDKãŒæä¾›ã™ã‚‹ä¸»è¦ãªæ©Ÿèƒ½
import { usePowerPlatform } from '@microsoft/power-apps';
import type { IOperationResult } from '@microsoft/power-apps/data';

// 1. SDKåˆæœŸåŒ–çŠ¶æ…‹ã®ç¢ºèª
const { isInitialized } = usePowerPlatform();

// 2. ã‚µãƒ¼ãƒ“ã‚¹ã‚¯ãƒ©ã‚¹ã‚’é€šã˜ãŸãƒ‡ãƒ¼ã‚¿ã‚¢ã‚¯ã‚»ã‚¹
const result: IOperationResult<SystemUsers[]> = await SystemUsersService.getAll({
  select: ['systemuserid', 'fullname'],
  filter: 'isdisabled eq false'
});

// 3. å‹å®‰å…¨ãªã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°
if (result.isSuccess && result.value) {
  // ãƒ‡ãƒ¼ã‚¿å–å¾—æˆåŠŸ
  console.log(result.value);
} else {
  // ã‚¨ãƒ©ãƒ¼å‡¦ç†
  console.error(result.error);
}
```

#### customization.xml ã®é‡è¦æ€§

`customization.xml` ã«ã¯ä»¥ä¸‹ã®é‡è¦ãªã‚¹ã‚­ãƒ¼ãƒæƒ…å ±ãŒå«ã¾ã‚Œã¦ã„ã¾ã™:

- **ãƒ†ãƒ¼ãƒ–ãƒ«å®šç¾©**: è«–ç†åã€ç‰©ç†åã€ä¸»ã‚­ãƒ¼
- **ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰å®šç¾©**: ãƒ‡ãƒ¼ã‚¿å‹ã€å¿…é ˆ/ä»»æ„ã€æœ€å¤§é•·
- **Choiceå€¤**: ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚»ãƒƒãƒˆã®å€¤ã¨ãƒ©ãƒ™ãƒ«
- **ãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚·ãƒƒãƒ—**: Lookup/1å¯¾å¤š/å¤šå¯¾å¤šã®é–¢ä¿‚

ã“ã®æƒ…å ±ã‚’åŸºã«ã€`pac code add-data-source` ãŒTypeScriptå‹å®šç¾©ã‚’è‡ªå‹•ç”Ÿæˆã—ã¾ã™ã€‚

---

## âš ï¸ é‡è¦: SDKåˆæœŸåŒ–ã¨ã‚³ãƒã‚¯ã‚¿ãƒ¼æ¥ç¶šã®ã‚¿ã‚¤ãƒŸãƒ³ã‚°

Dataverseã‚„Office 365ã‚³ãƒã‚¯ã‚¿ãƒ¼ãªã©ã«æ¥ç¶šã™ã‚‹å ´åˆã€**Power Apps SDKã®åˆæœŸåŒ–ãŒå®Œäº†ã—ã¦ã‹ã‚‰**ã‚³ãƒã‚¯ã‚¿ãƒ¼ã«æ¥ç¶šã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

### ã‚ˆãã‚ã‚‹ã‚¨ãƒ©ãƒ¼

```
Error fetching SystemUsers: PowerDataRuntimeError: An unknown error occurred: 
PowerDataRuntime is not initialized. Please call initializeRuntime() first.
```

**åŸå› :**  
PowerDataRuntimeï¼ˆPower Apps SDKï¼‰ãŒåˆæœŸåŒ–ã•ã‚Œã‚‹å‰ã«Dataverseãƒ†ãƒ¼ãƒ–ãƒ«ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã‚ˆã†ã¨ã—ãŸ

### æ­£ã—ã„å®Ÿè£…ãƒ‘ã‚¿ãƒ¼ãƒ³

```typescript
import { usePowerPlatform } from '@microsoft/power-apps';
import { useEffect, useState } from 'react';

export function App() {
  const { isInitialized } = usePowerPlatform();
  const [data, setData] = useState([]);

  useEffect(() => {
    // âœ… SDKåˆæœŸåŒ–å®Œäº†å¾Œã«ã®ã¿ãƒ‡ãƒ¼ã‚¿å–å¾—
    if (!isInitialized) {
      console.log('Power Apps SDK åˆæœŸåŒ–ä¸­...');
      return;
    }

    loadData();
  }, [isInitialized]);

  // âŒ åˆæœŸåŒ–å‰ã«ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã—ãªã„
  if (!isInitialized) {
    return <div>åˆæœŸåŒ–ä¸­...</div>;
  }

  return <YourApp data={data} />;
}
```

**é‡è¦ãªãƒã‚¤ãƒ³ãƒˆ:**
- âœ… `usePowerPlatform().isInitialized` ã§åˆæœŸåŒ–çŠ¶æ…‹ã‚’ãƒã‚§ãƒƒã‚¯
- âœ… `isInitialized === false` ã®é–“ã¯Loadingè¡¨ç¤º
- âœ… `isInitialized === true` ã«ãªã£ã¦ã‹ã‚‰Dataverseã‚¢ã‚¯ã‚»ã‚¹
- âœ… `useEffect` ã®ä¾å­˜é…åˆ—ã« `isInitialized` ã‚’å«ã‚ã‚‹
- âŒ åˆæœŸåŒ–å‰ã«ã‚µãƒ¼ãƒ“ã‚¹ã‚¯ãƒ©ã‚¹ã®ãƒ¡ã‚½ãƒƒãƒ‰ã‚’å‘¼ã³å‡ºã•ãªã„

---

## ğŸ“ Phase 5ã®å®Ÿè£…æ‰‹é †

### Step 1: æ¥ç¶šIDã®å–å¾—

**Power Appsãƒãƒ¼ã‚¿ãƒ«ã§æ¥ç¶šã‚’ä½œæˆã—ã€URLã‹ã‚‰æ¥ç¶šIDã‚’å–å¾—ã—ã¾ã™ã€‚**

#### 1-1. Power Appsãƒãƒ¼ã‚¿ãƒ«ã§æ¥ç¶šã‚’ä½œæˆ

1. **Power Apps Maker Portalã«ã‚¢ã‚¯ã‚»ã‚¹**
   ```
   https://make.powerapps.com
   ```

2. **ç’°å¢ƒã‚’é¸æŠ**
   - ç”»é¢å³ä¸Šã§é©åˆ‡ãªç’°å¢ƒã‚’é¸æŠ

3. **æ¥ç¶šãƒšãƒ¼ã‚¸ã«ç§»å‹•**
   - å·¦å´ãƒ¡ãƒ‹ãƒ¥ãƒ¼: **ãƒ‡ãƒ¼ã‚¿** â†’ **æ¥ç¶š**

4. **æ–°ã—ã„æ¥ç¶šã‚’ä½œæˆ**
   - ã€Œ**+ æ–°ã—ã„æ¥ç¶š**ã€ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯
   - æ¤œç´¢ãƒœãƒƒã‚¯ã‚¹ã§ã€Œ**Dataverse**ã€ã‚’æ¤œç´¢
   - ã€Œ**Microsoft Dataverse**ã€ã‚’é¸æŠ
   - ã€Œ**ä½œæˆ**ã€ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯

5. **èªè¨¼å®Œäº†ã‚’ç¢ºèª**
   - ã‚µã‚¤ãƒ³ã‚¤ãƒ³ãŒæ±‚ã‚ã‚‰ã‚ŒãŸå ´åˆã¯èªè¨¼ã‚’å®Œäº†
   - æ¥ç¶šãŒä½œæˆã•ã‚Œã‚‹ã¨ã€Œæ¥ç¶šã€ãƒšãƒ¼ã‚¸ã«è¡¨ç¤ºã•ã‚Œã¾ã™

#### 1-2. URLã‹ã‚‰æ¥ç¶šIDã‚’å–å¾— â­é‡è¦

æ¥ç¶šIDã¯**ãƒ–ãƒ©ã‚¦ã‚¶ã®URLã‹ã‚‰ç›´æ¥å–å¾—**ã—ã¾ã™ã€‚

**æ‰‹é †:**

1. ä½œæˆã—ãŸæ¥ç¶šã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦è©³ç´°ãƒšãƒ¼ã‚¸ã‚’é–‹ã
2. ãƒ–ãƒ©ã‚¦ã‚¶ã®ã‚¢ãƒ‰ãƒ¬ã‚¹ãƒãƒ¼ã®URLã‚’ç¢ºèª
3. URLã®æœ«å°¾ã«ã‚ã‚‹GUIDå½¢å¼ã®æ–‡å­—åˆ—ãŒæ¥ç¶šID

**URLã®ä¾‹:**
```
https://make.powerapps.com/environments/12345678-abcd-1234-abcd-123456789012/connections/shared_commondataserviceforapps/a1b2c3d4-e5f6-7890-abcd-ef1234567890/details
                                                                                                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                                                                                                              ã“ã‚ŒãŒæ¥ç¶šID
```

**æ¥ç¶šIDã®ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ:**
```
a1b2c3d4-e5f6-7890-abcd-ef1234567890
```

**ğŸ“‹ æ¥ç¶šIDã‚’ãƒ¡ãƒ¢å¸³ã«ã‚³ãƒ”ãƒ¼ã—ã¦ãã ã•ã„ã€‚Step 3ã§ä½¿ç”¨ã—ã¾ã™ã€‚**

#### 1-3. (ä»£æ›¿æ–¹æ³•) PAC CLIã§ã®ç¢ºèª

ã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³ã§æ¥ç¶šã‚’ç¢ºèªã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™:

```powershell
# æ¥ç¶šä¸€è¦§ã‚’è¡¨ç¤º
pac connector list

# å‡ºåŠ›ä¾‹:
# Connector Display Name: Microsoft Dataverse
# Connector Name: shared_commondataserviceforapps  
# Connection Id: a1b2c3d4-e5f6-7890-abcd-ef1234567890
```

> **ğŸ’¡ ãƒ’ãƒ³ãƒˆ**: URLã‹ã‚‰ã®å–å¾—ãŒæœ€ã‚‚ç¢ºå®Ÿãªæ–¹æ³•ã§ã™ã€‚

---

### Step 2: Dataverseã‚¹ã‚­ãƒ¼ãƒã®å–å¾—

**ã‚½ãƒªãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰ `customization.xml` ã‚’å–å¾—ã—ã€ãƒ¯ãƒ¼ã‚¯ã‚¹ãƒšãƒ¼ã‚¹ã®ãƒ«ãƒ¼ãƒˆãƒ•ã‚©ãƒ«ãƒ€ã«é…ç½®ã—ã¾ã™ã€‚**

> **ğŸ“˜ è©³ç´°ãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹**  
> Dataverseã‚¹ã‚­ãƒ¼ãƒã®å–å¾—æ–¹æ³•ã®è©³ç´°ã¯ **[HOW_TO_GET_DATAVERSE_SCHEMA.md](./docs/HOW_TO_GET_DATAVERSE_SCHEMA.md)** ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚

#### 2-1. ã‚½ãƒªãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³ã®ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ

1. **Power Apps Maker Portalã«ã‚¢ã‚¯ã‚»ã‚¹**
   ```
   https://make.powerapps.com
   ```

2. **ã‚½ãƒªãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³ãƒšãƒ¼ã‚¸ã«ç§»å‹•**
   - å·¦å´ãƒ¡ãƒ‹ãƒ¥ãƒ¼: **ã‚½ãƒªãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³**

3. **å¯¾è±¡ã®ã‚½ãƒªãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³ã‚’é¸æŠ**
   - ä½¿ç”¨ã™ã‚‹ãƒ†ãƒ¼ãƒ–ãƒ«ãŒå«ã¾ã‚Œã¦ã„ã‚‹ã‚½ãƒªãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³ã‚’é¸æŠ
   - ã‚«ã‚¹ã‚¿ãƒ ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’ä½¿ç”¨ã™ã‚‹å ´åˆã¯ã€ãã®ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’å«ã‚€ã‚½ãƒªãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³ã‚’é¸æŠ

4. **ã‚½ãƒªãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ**
   - ã‚½ãƒªãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³ã‚’é¸æŠã—ãŸçŠ¶æ…‹ã§ã€Œ**ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ**ã€ã‚’ã‚¯ãƒªãƒƒã‚¯
   - ã€Œ**ã‚¢ãƒ³ãƒãƒãƒ¼ã‚¸ãƒ‰**ã€ã‚’é¸æŠ
   - ã€Œ**ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ**ã€ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯

5. **ZIPãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰**
   - ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆãŒå®Œäº†ã™ã‚‹ã¨ã€ZIPãƒ•ã‚¡ã‚¤ãƒ«ãŒãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã•ã‚Œã¾ã™

#### 2-2. customization.xml ã®æŠ½å‡º

1. **ZIPãƒ•ã‚¡ã‚¤ãƒ«ã‚’è§£å‡**
   - ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ãŸZIPãƒ•ã‚¡ã‚¤ãƒ«ã‚’è§£å‡

2. **customization.xml ã‚’è¦‹ã¤ã‘ã‚‹**
   ```
   è§£å‡ãƒ•ã‚©ãƒ«ãƒ€/
   â””â”€â”€ Customizations/
       â””â”€â”€ customization.xml  â† ã“ã‚Œã‚’ã‚³ãƒ”ãƒ¼
   ```

3. **ãƒ¯ãƒ¼ã‚¯ã‚¹ãƒšãƒ¼ã‚¹ã®ãƒ«ãƒ¼ãƒˆã«é…ç½®** â­é‡è¦
   ```
   YourCodeAppsProject/    â† ãƒ¯ãƒ¼ã‚¯ã‚¹ãƒšãƒ¼ã‚¹ãƒ«ãƒ¼ãƒˆ
   â”œâ”€â”€ customization.xml   â† ã“ã“ã«é…ç½®
   â”œâ”€â”€ src/
   â”œâ”€â”€ public/
   â”œâ”€â”€ package.json
   â””â”€â”€ vite.config.ts
   ```

**é…ç½®ã‚³ãƒãƒ³ãƒ‰ä¾‹ (PowerShell):**
```powershell
# ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ãƒ•ã‚©ãƒ«ãƒ€ã‹ã‚‰ã‚³ãƒ”ãƒ¼
Copy-Item "C:\Users\YourName\Downloads\ExtractedSolution\Customizations\customization.xml" -Destination ".\customization.xml"

# é…ç½®ç¢ºèª
Get-Item .\customization.xml
```

#### 2-3. customization.xml ã®å†…å®¹ç¢ºèª

ãƒ•ã‚¡ã‚¤ãƒ«ã«ã¯ä»¥ä¸‹ã®ã‚ˆã†ãªæƒ…å ±ãŒå«ã¾ã‚Œã¦ã„ã¾ã™:

```xml
<ImportExportXml>
  <Entities>
    <Entity Name="geek_project_task">
      <EntityInfo>
        <entity Name="geek_project_task">
          <LocalizedNames>
            <LocalizedName description="ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚¿ã‚¹ã‚¯" languagecode="1041" />
          </LocalizedNames>
          <attributes>
            <attribute PhysicalName="geek_name" LogicalName="geek_name" Type="nvarchar" />
            <attribute PhysicalName="geek_assignedto" LogicalName="geek_assignedto" Type="lookup" />
          </attributes>
        </entity>
      </EntityInfo>
    </Entity>
  </Entities>
</ImportExportXml>
```

ã“ã®æƒ…å ±ã‚’åŸºã«ã€æ¬¡ã®Stepã§TypeScriptå‹å®šç¾©ãŒç”Ÿæˆã•ã‚Œã¾ã™ã€‚

---

### Step 3: ã‚µãƒ¼ãƒ“ã‚¹ã‚¯ãƒ©ã‚¹ã®ç”Ÿæˆ

**`pac code add-data-source` ã‚³ãƒãƒ³ãƒ‰ã§ã€Power Apps SDKãƒ™ãƒ¼ã‚¹ã®TypeScriptã‚µãƒ¼ãƒ“ã‚¹ã‚¯ãƒ©ã‚¹ã‚’è‡ªå‹•ç”Ÿæˆã—ã¾ã™ã€‚**

#### 3-1. ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹è¿½åŠ ã‚³ãƒãƒ³ãƒ‰å®Ÿè¡Œ

**åŸºæœ¬ã‚³ãƒãƒ³ãƒ‰:**
```powershell
pac code add-data-source `
  --connector "shared_commondataserviceforapps" `
  --connection-id "<Step 1ã§å–å¾—ã—ãŸæ¥ç¶šID>"
```

**å®Ÿè¡Œä¾‹:**
```powershell
pac code add-data-source `
  --connector "shared_commondataserviceforapps" `
  --connection-id "a1b2c3d4-e5f6-7890-abcd-ef1234567890"
```

**ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’æŒ‡å®šã™ã‚‹å ´åˆ:**
```powershell
# SystemUsersãƒ†ãƒ¼ãƒ–ãƒ«ã®ã¿ç”Ÿæˆ
pac code add-data-source `
  --connector "shared_commondataserviceforapps" `
  --connection-id "a1b2c3d4-e5f6-7890-abcd-ef1234567890" `
  --table "systemusers"

# ã‚«ã‚¹ã‚¿ãƒ ãƒ†ãƒ¼ãƒ–ãƒ« (geek_project_task) ã‚’ç”Ÿæˆ
pac code add-data-source `
  --connector "shared_commondataserviceforapps" `
  --connection-id "a1b2c3d4-e5f6-7890-abcd-ef1234567890" `
  --table "geek_project_task"
```

#### 3-2. ç”Ÿæˆã•ã‚Œã‚‹ãƒ•ã‚¡ã‚¤ãƒ«

ã‚³ãƒãƒ³ãƒ‰å®Ÿè¡Œå¾Œã€ä»¥ä¸‹ã®ãƒ•ã‚¡ã‚¤ãƒ«ãŒè‡ªå‹•ç”Ÿæˆã•ã‚Œã¾ã™:

```
src/
â””â”€â”€ generated/
    â”œâ”€â”€ models/
    â”‚   â”œâ”€â”€ SystemUsersModel.ts           # SystemUserså‹å®šç¾©
    â”‚   â””â”€â”€ GeekProjectTasksModel.ts      # ã‚«ã‚¹ã‚¿ãƒ ãƒ†ãƒ¼ãƒ–ãƒ«å‹å®šç¾©
    â””â”€â”€ services/
        â”œâ”€â”€ SystemUsersService.ts         # SystemUsersã‚µãƒ¼ãƒ“ã‚¹ã‚¯ãƒ©ã‚¹
        â””â”€â”€ GeekProjectTasksService.ts    # ã‚«ã‚¹ã‚¿ãƒ ãƒ†ãƒ¼ãƒ–ãƒ«ã‚µãƒ¼ãƒ“ã‚¹ã‚¯ãƒ©ã‚¹
```

#### 3-3. ç”Ÿæˆã•ã‚ŒãŸã‚³ãƒ¼ãƒ‰ã®ç¢ºèª

**Modelä¾‹ (SystemUsersModel.ts):**
```typescript
export interface SystemUsers {
  systemuserid: string;
  fullname: string;
  internalemailaddress: string;
  isdisabled: boolean;
  // ... ä»–ã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰
}
```

**Serviceä¾‹ (SystemUsersService.ts):**
```typescript
import { getClient } from '@microsoft/power-apps/data';
import type { IOperationResult } from '@microsoft/power-apps/data';
import type { SystemUsers } from '../models/SystemUsersModel';

export class SystemUsersService {
  static async getAll(options?: {
    select?: string[];
    filter?: string;
    orderBy?: string;
    top?: number;
    expand?: Array<{ navigationProperty: string; select?: string[] }>;
  }): Promise<IOperationResult<SystemUsers[]>> {
    const client = getClient();
    // Power Apps SDKçµŒç”±ã§ãƒ‡ãƒ¼ã‚¿å–å¾—
    return await client.retrieveMultipleRecords('systemuser', options);
  }

  static async getById(id: string): Promise<IOperationResult<SystemUsers>> {
    const client = getClient();
    return await client.retrieveRecord('systemuser', id);
  }

  // ... create, update, delete ãƒ¡ã‚½ãƒƒãƒ‰
}
```

#### 3-4. ãƒ“ãƒ«ãƒ‰ã¨Lintç¢ºèª

ç”Ÿæˆã•ã‚ŒãŸã‚³ãƒ¼ãƒ‰ã‚’ãƒ“ãƒ«ãƒ‰ã—ã¦ç¢ºèªã—ã¾ã™:

```powershell
# ãƒ“ãƒ«ãƒ‰
npm run build

# Lintç¢ºèª
npm run lint

# ä¸¡æ–¹ã‚’å®Ÿè¡Œ
npm run build; npm run lint
```

ã‚¨ãƒ©ãƒ¼ãŒãªã‘ã‚Œã°ã€ã‚µãƒ¼ãƒ“ã‚¹ã‚¯ãƒ©ã‚¹ã®ç”Ÿæˆã¯å®Œäº†ã§ã™ã€‚

---

### âš ï¸ é‡è¦: Dataverseãƒ†ãƒ¼ãƒ–ãƒ«æ¥ç¶šã®æ³¨æ„ç‚¹

Dataverseãƒ†ãƒ¼ãƒ–ãƒ«ã‚’ä½¿ç”¨ã™ã‚‹å ´åˆã€**ç‰¹æœ‰ã®è¨­å®šã¨æ³¨æ„ç‚¹**ãŒã‚ã‚Šã¾ã™ã€‚

ä»¥ä¸‹ã®ã‚¨ãƒ©ãƒ¼ã§ãŠå›°ã‚Šã®å ´åˆã¯ã€å°‚ç”¨ã‚¬ã‚¤ãƒ‰ã‚’å‚ç…§ã—ã¦ãã ã•ã„ï¼š

- âŒ **404 "Resource not found"** ã‚¨ãƒ©ãƒ¼
- âŒ **"Data source not found"** ã‚¨ãƒ©ãƒ¼
- âŒ **"Failed to fetch projects"** ã‚¨ãƒ©ãƒ¼
- âŒ Dataverseã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ãŒå–å¾—ã§ããªã„
- âŒ æ¨©é™å•é¡Œãƒ»ãƒ†ãƒ¼ãƒ–ãƒ«åã®å•é¡Œ

**ğŸ“– è©³ç´°ã¯ [Dataverseãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°å®Œå…¨ã‚¬ã‚¤ãƒ‰](./docs/DATAVERSE_TROUBLESHOOTING.md) ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚**

ã“ã®ã‚¬ã‚¤ãƒ‰ã§ã¯ä»¥ä¸‹ã‚’è©³ã—ãè§£èª¬ã—ã¦ã„ã¾ã™ï¼š

- âœ… `databaseReferences` vs `connectionReferences` ã®é•ã„ã¨æ­£ã—ã„è¨­å®šæ–¹æ³•
- âœ… `dataSourceName`ã®æ‰‹å‹•ä¿®æ­£æ–¹æ³•ï¼ˆPAC CLIã®æ—¢çŸ¥ã®å•é¡Œã¸ã®å¯¾å‡¦ï¼‰
- âœ… 404ã‚¨ãƒ©ãƒ¼ã€"Data source not found"ã€ãƒ‡ãƒ¼ã‚¿å–å¾—ã‚¨ãƒ©ãƒ¼ã®å…¨è§£æ±ºç­–
- âœ… æ¨©é™å•é¡Œã€SDKåˆæœŸåŒ–ã®å•é¡Œã€ãƒ†ãƒ¼ãƒ–ãƒ«åã®å•é¡Œ
- âœ… ãƒ‡ãƒãƒƒã‚°æ‰‹é †ã¨ã‚ˆãã‚ã‚‹ã‚¨ãƒ©ãƒ¼ãƒ‘ã‚¿ãƒ¼ãƒ³
- âœ… å®Ÿè£…ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆï¼ˆè¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã€ç”Ÿæˆãƒ•ã‚¡ã‚¤ãƒ«ã€ãƒ“ãƒ«ãƒ‰/ãƒ‡ãƒ—ãƒ­ã‚¤ï¼‰

---

### Step 4: ãƒ¢ãƒƒã‚¯ãƒ‡ãƒ¼ã‚¿ã®å‰Šé™¤ã¨Dataverseãƒ‡ãƒ¼ã‚¿çµ±åˆ

**ã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯ã¨Reactã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’å®Ÿè£…ã—ã€ãƒ¢ãƒƒã‚¯ãƒ‡ãƒ¼ã‚¿ã‚’å®Œå…¨ã«å‰Šé™¤ã—ã¦Dataverseã®å®Ÿãƒ‡ãƒ¼ã‚¿ã«æ¥ç¶šã—ã¾ã™ã€‚**

#### 4-1. ã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯ã®ä½œæˆ

**ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹:** `src/hooks/useSystemUsers.ts`

```typescript
import { useState, useEffect, useCallback } from 'react';
import { usePowerPlatform } from '@microsoft/power-apps';
import { SystemUsersService } from '../generated/services/SystemUsersService';
import type { SystemUsers } from '../generated/models/SystemUsersModel';

export const useSystemUsers = () => {
  const { isInitialized } = usePowerPlatform();
  const [users, setUsers] = useState<SystemUsers[]>([]);
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState<string | null>(null);

  const loadUsers = useCallback(async () => {
    // âŒ SDKåˆæœŸåŒ–å‰ã¯å®Ÿè¡Œã—ãªã„
    if (!isInitialized) {
      console.warn('Power Apps SDK not initialized yet');
      return;
    }

    try {
      setLoading(true);
      setError(null);
      
      // âœ… Power Apps SDKçµŒç”±ã§ãƒ‡ãƒ¼ã‚¿å–å¾—
      const result = await SystemUsersService.getAll({
        select: ['systemuserid', 'fullname', 'internalemailaddress', 'isdisabled'],
        filter: 'isdisabled eq false',
        orderBy: 'fullname asc',
        top: 100
      });
      
      // âœ… IOperationResult ã§å‹å®‰å…¨ãªã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°
      if (result.isSuccess && result.value) {
        setUsers(result.value);
      } else {
        throw new Error(result.error?.message || 'ãƒ¦ãƒ¼ã‚¶ãƒ¼ä¸€è¦§ã®å–å¾—ã«å¤±æ•—ã—ã¾ã—ãŸ');
      }
    } catch (err) {
      const errorMessage = err instanceof Error ? err.message : 'Unknown error';
      console.error('Error fetching SystemUsers:', err);
      setError(errorMessage);
    } finally {
      setLoading(false);
    }
  }, [isInitialized]);

  // SDKåˆæœŸåŒ–å®Œäº†å¾Œã«è‡ªå‹•ã§ãƒ‡ãƒ¼ã‚¿å–å¾—
  useEffect(() => {
    if (isInitialized) {
      loadUsers();
    }
  }, [isInitialized, loadUsers]);

  return { 
    users, 
    loading, 
    error, 
    refetch: loadUsers, 
    isInitialized 
  };
};
```

**é‡è¦ãªãƒã‚¤ãƒ³ãƒˆ:**
- âœ… `usePowerPlatform().isInitialized` ã§SDKåˆæœŸåŒ–çŠ¶æ…‹ã‚’ç¢ºèª
- âœ… `IOperationResult.isSuccess` ã§å‹å®‰å…¨ãªã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°
- âœ… `useEffect` ã®ä¾å­˜é…åˆ—ã« `isInitialized` ã‚’å«ã‚ã‚‹
- âŒ åˆæœŸåŒ–å‰ã«ã‚µãƒ¼ãƒ“ã‚¹ã‚¯ãƒ©ã‚¹ã®ãƒ¡ã‚½ãƒƒãƒ‰ã‚’å‘¼ã³å‡ºã•ãªã„

#### 4-2. Reactã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã§ã®ä½¿ç”¨

**ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹:** `src/pages/UsersPage.tsx`

```typescript
import { useSystemUsers } from '../hooks/useSystemUsers';
import { Card } from '@/components/ui/card';

export function UsersPage() {
  const { users, loading, error, isInitialized } = useSystemUsers();

  // 1. SDKåˆæœŸåŒ–ä¸­ã®è¡¨ç¤º
  if (!isInitialized) {
    return (
      <div className="flex items-center justify-center h-screen">
        <div className="text-center">
          <div className="animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto"></div>
          <p className="mt-4 text-muted-foreground">Power Platform åˆæœŸåŒ–ä¸­...</p>
        </div>
      </div>
    );
  }

  // 2. ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿ä¸­ã®è¡¨ç¤º
  if (loading) {
    return (
      <div className="flex items-center justify-center h-screen">
        <div className="text-center">
          <div className="animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto"></div>
          <p className="mt-4">ãƒ¦ãƒ¼ã‚¶ãƒ¼èª­ã¿è¾¼ã¿ä¸­...</p>
        </div>
      </div>
    );
  }

  // 3. ã‚¨ãƒ©ãƒ¼ç™ºç”Ÿæ™‚ã®è¡¨ç¤º
  if (error) {
    return (
      <Card className="p-6 bg-red-50 border-red-200">
        <h3 className="text-red-800 font-semibold">ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ</h3>
        <p className="text-red-600">{error}</p>
      </Card>
    );
  }

  // 4. ãƒ‡ãƒ¼ã‚¿è¡¨ç¤º (ãƒ¢ãƒƒã‚¯ãƒ‡ãƒ¼ã‚¿ã§ã¯ãªãå®Ÿãƒ‡ãƒ¼ã‚¿)
  return (
    <div className="space-y-4 p-6">
      <h2 className="text-2xl font-bold">ãƒ¦ãƒ¼ã‚¶ãƒ¼ä¸€è¦§ (Dataverse)</h2>
      <p className="text-sm text-muted-foreground">
        å…¨ {users.length} ä»¶ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼
      </p>
      <div className="grid gap-4">
        {users.map(user => (
          <Card key={user.systemuserid} className="p-4">
            <h3 className="font-semibold">{user.fullname}</h3>
            <p className="text-sm text-muted-foreground">{user.internalemailaddress}</p>
            <p className="text-xs text-muted-foreground">ID: {user.systemuserid}</p>
          </Card>
        ))}
      </div>
    </div>
  );
}
```

#### 4-3. ãƒ¢ãƒƒã‚¯ãƒ‡ãƒ¼ã‚¿ã®å®Œå…¨å‰Šé™¤

ä»¥ä¸‹ã®ãƒ¢ãƒƒã‚¯ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å‰Šé™¤ã—ã¦ãã ã•ã„:

**å‰Šé™¤å¯¾è±¡:**
```
src/
â”œâ”€â”€ data/
â”‚   â”œâ”€â”€ mockUsers.ts          â† å‰Šé™¤
â”‚   â”œâ”€â”€ mockTasks.ts          â† å‰Šé™¤
â”‚   â””â”€â”€ mockData.json         â† å‰Šé™¤
â”œâ”€â”€ hooks/
â”‚   â””â”€â”€ useMockData.ts        â† å‰Šé™¤ (Dataverseç”¨ã®hookã«ç½®ãæ›ãˆ)
â””â”€â”€ utils/
    â””â”€â”€ mockDataGenerator.ts  â† å‰Šé™¤
```

**å‰Šé™¤ã‚³ãƒãƒ³ãƒ‰ (PowerShell):**
```powershell
# ãƒ¢ãƒƒã‚¯ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚©ãƒ«ãƒ€ã‚’å‰Šé™¤
Remove-Item -Path ".\src\data" -Recurse -Force

# ãƒ¢ãƒƒã‚¯ç”¨ã®hookã‚’å‰Šé™¤ (å¿…è¦ã«å¿œã˜ã¦)
Remove-Item -Path ".\src\hooks\useMockData.ts" -Force
```

**App.tsxã®æ›´æ–°ä¾‹:**

```typescript
// âŒ Before: ãƒ¢ãƒƒã‚¯ãƒ‡ãƒ¼ã‚¿ä½¿ç”¨
import { mockUsers } from './data/mockUsers';

function App() {
  const [users] = useState(mockUsers);
  // ...
}

// âœ… After: Dataverseãƒ‡ãƒ¼ã‚¿ä½¿ç”¨
import { useSystemUsers } from './hooks/useSystemUsers';

function App() {
  const { users, loading, error, isInitialized } = useSystemUsers();
  
  if (!isInitialized) return <div>åˆæœŸåŒ–ä¸­...</div>;
  if (loading) return <div>èª­ã¿è¾¼ã¿ä¸­...</div>;
  if (error) return <div>ã‚¨ãƒ©ãƒ¼: {error}</div>;
  
  // å®Ÿãƒ‡ãƒ¼ã‚¿ã‚’ä½¿ç”¨
  return <div>{users.map(u => <div key={u.systemuserid}>{u.fullname}</div>)}</div>;
}
```

#### 4-4. å‹•ä½œç¢ºèª

1. **ãƒ­ãƒ¼ã‚«ãƒ«ã§ç¢ºèª**
   ```powershell
   npm run dev
   ```
   - ãƒ–ãƒ©ã‚¦ã‚¶ã§ http://localhost:5173 ã‚’é–‹ã
   - Dataverseã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ãŒè¡¨ç¤ºã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèª

2. **ãƒ–ãƒ©ã‚¦ã‚¶ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã§ç¢ºèª**
   - F12ã‚’æŠ¼ã—ã¦é–‹ç™ºè€…ãƒ„ãƒ¼ãƒ«ã‚’é–‹ã
   - Console ã‚¿ãƒ–ã§ä»¥ä¸‹ã‚’ç¢ºèª:
     ```
     Power Apps SDK åˆæœŸåŒ–ä¸­...
     Power Apps SDK initialized successfully
     Fetched 10 SystemUsers from Dataverse
     ```

3. **ã‚¨ãƒ©ãƒ¼ãŒãªã„ã“ã¨ã‚’ç¢ºèª**
   - ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã«ã‚¨ãƒ©ãƒ¼ãŒè¡¨ç¤ºã•ã‚Œã¦ã„ãªã„ã“ã¨
   - ãƒ‡ãƒ¼ã‚¿ãŒæ­£ã—ãè¡¨ç¤ºã•ã‚Œã¦ã„ã‚‹ã“ã¨

#### 4-5. CRUDæ“ä½œã®å®Ÿè£… (å¿…è¦ã«å¿œã˜ã¦)

ãƒ‡ãƒ¼ã‚¿ã®ä½œæˆãƒ»æ›´æ–°ãƒ»å‰Šé™¤ãŒå¿…è¦ãªå ´åˆã¯ã€ä»¥ä¸‹ã®ã‚ˆã†ã«å®Ÿè£…ã—ã¾ã™:

```typescript
// hooks/useDataverseTable.ts
export const useDataverseTable = <T>(
  serviceName: string,
  Service: any
) => {
  const { isInitialized } = usePowerPlatform();
  const [items, setItems] = useState<T[]>([]);
  const [loading, setLoading] = useState(false);
  const [error, setError] = useState<string | null>(null);

  // èª­ã¿å–ã‚Š
  const fetchItems = useCallback(async (options?) => {
    if (!isInitialized) return;
    
    setLoading(true);
    try {
      const result = await Service.getAll(options);
      if (result.isSuccess && result.value) {
        setItems(result.value);
      } else {
        throw new Error(result.error?.message || 'ãƒ‡ãƒ¼ã‚¿å–å¾—å¤±æ•—');
      }
    } catch (err) {
      setError(err instanceof Error ? err.message : 'Unknown error');
    } finally {
      setLoading(false);
    }
  }, [isInitialized, Service]);

  // ä½œæˆ
  const createItem = useCallback(async (data: Partial<T>) => {
    if (!isInitialized) return null;
    
    try {
      const result = await Service.create(data);
      if (result.isSuccess) {
        await fetchItems(); // å†èª­ã¿è¾¼ã¿
        return result.value;
      }
      throw new Error(result.error?.message || 'ä½œæˆå¤±æ•—');
    } catch (err) {
      setError(err instanceof Error ? err.message : 'Unknown error');
      return null;
    }
  }, [isInitialized, fetchItems, Service]);

  // æ›´æ–°
  const updateItem = useCallback(async (id: string, data: Partial<T>) => {
    if (!isInitialized) return false;
    
    try {
      const result = await Service.update(id, data);
      if (result.isSuccess) {
        await fetchItems(); // å†èª­ã¿è¾¼ã¿
        return true;
      }
      throw new Error(result.error?.message || 'æ›´æ–°å¤±æ•—');
    } catch (err) {
      setError(err instanceof Error ? err.message : 'Unknown error');
      return false;
    }
  }, [isInitialized, fetchItems, Service]);

  // å‰Šé™¤
  const deleteItem = useCallback(async (id: string) => {
    if (!isInitialized) return false;
    
    try {
      const result = await Service.delete(id);
      if (result.isSuccess) {
        await fetchItems(); // å†èª­ã¿è¾¼ã¿
        return true;
      }
      throw new Error(result.error?.message || 'å‰Šé™¤å¤±æ•—');
    } catch (err) {
      setError(err instanceof Error ? err.message : 'Unknown error');
      return false;
    }
  }, [isInitialized, fetchItems, Service]);

  useEffect(() => {
    if (isInitialized) {
      fetchItems();
    }
  }, [isInitialized, fetchItems]);

  return {
    items,
    loading,
    error,
    refetch: fetchItems,
    create: createItem,
    update: updateItem,
    delete: deleteItem,
    isInitialized
  };
};
```

**ä½¿ç”¨ä¾‹:**

```typescript
import { useDataverseTable } from '../hooks/useDataverseTable';
import { GeekProjectTasksService } from '../generated/services/GeekProjectTasksService';

function TasksPage() {
  const { 
    items: tasks, 
    loading, 
    create, 
    update, 
    delete: deleteTask 
  } = useDataverseTable('geek_project_task', GeekProjectTasksService);

  const handleCreate = async () => {
    await create({ geek_name: 'æ–°ã—ã„ã‚¿ã‚¹ã‚¯', geek_status: 100000000 });
  };

  const handleComplete = async (taskId: string) => {
    await update(taskId, { geek_status: 100000001 });
  };

  const handleDelete = async (taskId: string) => {
    if (confirm('å‰Šé™¤ã—ã¾ã™ã‹?')) {
      await deleteTask(taskId);
    }
  };

  // ... UIå®Ÿè£…
}
```

---

---

## ï¿½ å®Ÿè£…ä¾‹

### ä¾‹1: SystemUsersãƒ†ãƒ¼ãƒ–ãƒ«ã®çµ±åˆ

**ç›®çš„:** Dataverseã®æ¨™æº–ãƒ†ãƒ¼ãƒ–ãƒ« (SystemUsers) ã‹ã‚‰ãƒ¦ãƒ¼ã‚¶ãƒ¼ä¸€è¦§ã‚’å–å¾—ã—ã¦è¡¨ç¤º

**å®Ÿè£…æ‰‹é †:**

1. **æ¥ç¶šä½œæˆã¨IDå–å¾—**
   - Power Appsãƒãƒ¼ã‚¿ãƒ«ã§ Dataverse æ¥ç¶šã‚’ä½œæˆ
   - URLã‹ã‚‰æ¥ç¶šIDå–å¾—: `a1b2c3d4-e5f6-7890-abcd-ef1234567890`

2. **ã‚µãƒ¼ãƒ“ã‚¹ã‚¯ãƒ©ã‚¹ç”Ÿæˆ**
   ```powershell
   pac code add-data-source `
     --connector "shared_commondataserviceforapps" `
     --connection-id "a1b2c3d4-e5f6-7890-abcd-ef1234567890" `
     --table "systemusers"
   ```

3. **ã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯ä½œæˆ** (`src/hooks/useSystemUsers.ts`)
   ```typescript
   import { useState, useEffect, useCallback } from 'react';
   import { usePowerPlatform } from '@microsoft/power-apps';
   import { SystemUsersService } from '../generated/services/SystemUsersService';
   
   export const useSystemUsers = () => {
     const { isInitialized } = usePowerPlatform();
     const [users, setUsers] = useState([]);
     const [loading, setLoading] = useState(true);
     const [error, setError] = useState(null);
   
     const loadUsers = useCallback(async () => {
       if (!isInitialized) return;
       
       try {
         const result = await SystemUsersService.getAll({
           select: ['systemuserid', 'fullname', 'internalemailaddress'],
           filter: 'isdisabled eq false'
         });
         
         if (result.isSuccess && result.value) {
           setUsers(result.value);
         }
       } catch (err) {
         setError(err.message);
       } finally {
         setLoading(false);
       }
     }, [isInitialized]);
   
     useEffect(() => {
       if (isInitialized) loadUsers();
     }, [isInitialized, loadUsers]);
   
     return { users, loading, error, isInitialized };
   };
   ```

4. **ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆå®Ÿè£…**
   ```typescript
   export function UsersPage() {
     const { users, loading, error, isInitialized } = useSystemUsers();
     
     if (!isInitialized) return <div>åˆæœŸåŒ–ä¸­...</div>;
     if (loading) return <div>èª­ã¿è¾¼ã¿ä¸­...</div>;
     if (error) return <div>ã‚¨ãƒ©ãƒ¼: {error}</div>;
     
     return (
       <div>
         <h2>ãƒ¦ãƒ¼ã‚¶ãƒ¼ä¸€è¦§ ({users.length}ä»¶)</h2>
         {users.map(u => (
           <div key={u.systemuserid}>{u.fullname} - {u.internalemailaddress}</div>
         ))}
       </div>
     );
   }
   ```

---

### ä¾‹2: ã‚«ã‚¹ã‚¿ãƒ ãƒ†ãƒ¼ãƒ–ãƒ« (Project Tasks) ã®çµ±åˆ

**ç›®çš„:** ã‚«ã‚¹ã‚¿ãƒ ãƒ†ãƒ¼ãƒ–ãƒ«ã§CRUDæ“ä½œã‚’å®Ÿè£…

**å‰ææ¡ä»¶:**
- ã‚«ã‚¹ã‚¿ãƒ ãƒ†ãƒ¼ãƒ–ãƒ« `geek_project_task` ãŒä½œæˆæ¸ˆã¿
- ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰: `geek_name` (ã‚¿ã‚¹ã‚¯å), `geek_status` (ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹)

**å®Ÿè£…æ‰‹é †:**

1. **customization.xml é…ç½®**
   - ã‚½ãƒªãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ
   - `customization.xml` ã‚’ãƒ¯ãƒ¼ã‚¯ã‚¹ãƒšãƒ¼ã‚¹ãƒ«ãƒ¼ãƒˆã«é…ç½®

2. **ã‚µãƒ¼ãƒ“ã‚¹ã‚¯ãƒ©ã‚¹ç”Ÿæˆ**
   ```powershell
   pac code add-data-source `
     --connector "shared_commondataserviceforapps" `
     --connection-id "a1b2c3d4-e5f6-7890-abcd-ef1234567890" `
     --table "geek_project_task"
   ```

3. **ã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯ä½œæˆ** (`src/hooks/useProjectTasks.ts`)
   ```typescript
   import { useState, useEffect, useCallback } from 'react';
   import { usePowerPlatform } from '@microsoft/power-apps';
   import { GeekProjectTasksService } from '../generated/services/GeekProjectTasksService';
   
   export const useProjectTasks = () => {
     const { isInitialized } = usePowerPlatform();
     const [tasks, setTasks] = useState([]);
     const [loading, setLoading] = useState(false);
     const [error, setError] = useState(null);
   
     const loadTasks = useCallback(async () => {
       if (!isInitialized) return;
       
       setLoading(true);
       try {
         const result = await GeekProjectTasksService.getAll({
           select: ['geek_project_taskid', 'geek_name', 'geek_status'],
           orderBy: 'createdon desc'
         });
         
         if (result.isSuccess && result.value) {
           setTasks(result.value);
         }
       } catch (err) {
         setError(err.message);
       } finally {
         setLoading(false);
       }
     }, [isInitialized]);
   
     const createTask = useCallback(async (name: string) => {
       if (!isInitialized) return false;
       
       try {
         const result = await GeekProjectTasksService.create({
           geek_name: name,
           geek_status: 100000000 // æ–°è¦
         });
         
         if (result.isSuccess) {
           await loadTasks();
           return true;
         }
       } catch (err) {
         setError(err.message);
       }
       return false;
     }, [isInitialized, loadTasks]);
   
     const updateTask = useCallback(async (id: string, status: number) => {
       if (!isInitialized) return false;
       
       try {
         const result = await GeekProjectTasksService.update(id, {
           geek_status: status
         });
         
         if (result.isSuccess) {
           await loadTasks();
           return true;
         }
       } catch (err) {
         setError(err.message);
       }
       return false;
     }, [isInitialized, loadTasks]);
   
     const deleteTask = useCallback(async (id: string) => {
       if (!isInitialized) return false;
       
       try {
         const result = await GeekProjectTasksService.delete(id);
         
         if (result.isSuccess) {
           await loadTasks();
           return true;
         }
       } catch (err) {
         setError(err.message);
       }
       return false;
     }, [isInitialized, loadTasks]);
   
     useEffect(() => {
       if (isInitialized) loadTasks();
     }, [isInitialized, loadTasks]);
   
     return { tasks, loading, error, createTask, updateTask, deleteTask };
   };
   ```

4. **ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆå®Ÿè£…**
   ```typescript
   import { useState } from 'react';
   import { useProjectTasks } from '../hooks/useProjectTasks';
   
   export function TasksPage() {
     const { tasks, loading, createTask, updateTask, deleteTask } = useProjectTasks();
     const [newTaskName, setNewTaskName] = useState('');
   
     const handleCreate = async () => {
       if (newTaskName.trim()) {
         await createTask(newTaskName);
         setNewTaskName('');
       }
     };
   
     const handleComplete = async (taskId: string) => {
       await updateTask(taskId, 100000001); // å®Œäº†
     };
   
     const handleDelete = async (taskId: string) => {
       if (confirm('å‰Šé™¤ã—ã¾ã™ã‹?')) {
         await deleteTask(taskId);
       }
     };
   
     if (loading) return <div>èª­ã¿è¾¼ã¿ä¸­...</div>;
   
     return (
       <div>
         <h2>ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚¿ã‚¹ã‚¯</h2>
         
         {/* æ–°è¦ä½œæˆ */}
         <div>
           <input
             value={newTaskName}
             onChange={(e) => setNewTaskName(e.target.value)}
             placeholder="æ–°ã—ã„ã‚¿ã‚¹ã‚¯"
           />
           <button onClick={handleCreate}>è¿½åŠ </button>
         </div>
   
         {/* ã‚¿ã‚¹ã‚¯ä¸€è¦§ */}
         {tasks.map(task => (
           <div key={task.geek_project_taskid}>
             <span>{task.geek_name}</span>
             <button onClick={() => handleComplete(task.geek_project_taskid)}>å®Œäº†</button>
             <button onClick={() => handleDelete(task.geek_project_taskid)}>å‰Šé™¤</button>
           </div>
         ))}
       </div>
     );
   }
   ```

---

### ä¾‹3: Lookupãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®å‡¦ç†

**ç›®çš„:** ã‚¿ã‚¹ã‚¯ã«æ‹…å½“è€… (Lookup to SystemUsers) ã‚’è¨­å®š

**å‰ææ¡ä»¶:**
- `geek_project_task` ãƒ†ãƒ¼ãƒ–ãƒ«ã« Lookup ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ `geek_AssignedTo` ãŒå­˜åœ¨

> **ğŸ“˜ è©³ç´°ã‚¬ã‚¤ãƒ‰**  
> Lookupãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®å®Œå…¨ãªå®Ÿè£…æ–¹æ³•ã¯ **[LOOKUP_FIELD_GUIDE.md](./docs/LOOKUP_FIELD_GUIDE.md)** ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚

**å®Ÿè£…ä¾‹:**

```typescript
// Lookupãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’$expandã§å±•é–‹ã—ã¦å–å¾—
const result = await GeekProjectTasksService.getAll({
  select: ['geek_project_taskid', 'geek_name', '_geek_assignedto_value'],
  expand: [
    {
      navigationProperty: 'geek_AssignedTo',
      select: ['systemuserid', 'fullname']
    }
  ]
});

// ãƒ‡ãƒ¼ã‚¿æ•´å½¢
const tasks = result.value.map(task => ({
  id: task.geek_project_taskid,
  name: task.geek_name,
  assignedToId: task._geek_assignedto_value,
  assignedToName: task.geek_AssignedTo?.fullname || 'æœªå‰²ã‚Šå½“ã¦'
}));

// æ‹…å½“è€…ã‚’è¨­å®š
await GeekProjectTasksService.update(taskId, {
  'geek_AssignedTo@odata.bind': `/systemusers(${userId})`
});
```

---

---

## ï¿½ ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### ã‚ˆãã‚ã‚‹å•é¡Œã¨è§£æ±ºæ³•

#### å•é¡Œ1: PowerDataRuntime is not initialized

**ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸:**
```
PowerDataRuntimeError: An unknown error occurred: 
PowerDataRuntime is not initialized. Please call initializeRuntime() first.
```

**åŸå› :**  
Power Apps SDKã®åˆæœŸåŒ–ãŒå®Œäº†ã™ã‚‹å‰ã«Dataverseã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã‚ˆã†ã¨ã—ãŸ

**è§£æ±ºæ–¹æ³•:**
```typescript
import { usePowerPlatform } from '@microsoft/power-apps';

export function App() {
  const { isInitialized } = usePowerPlatform();

  // âœ… åˆæœŸåŒ–å®Œäº†ã‚’å¾…ã¤
  if (!isInitialized) {
    return <div>åˆæœŸåŒ–ä¸­...</div>;
  }

  // âœ… åˆæœŸåŒ–å®Œäº†å¾Œã«ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°
  return <YourDataComponent />;
}
```

---

#### å•é¡Œ2: æ¥ç¶šIDãŒè¦‹ã¤ã‹ã‚‰ãªã„

**ç—‡çŠ¶:**  
`pac code add-data-source` å®Ÿè¡Œæ™‚ã«ã€Œæ¥ç¶šãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã€ã‚¨ãƒ©ãƒ¼

**åŸå› :**
- æ¥ç¶šIDãŒé–“é•ã£ã¦ã„ã‚‹
- ç’°å¢ƒãŒç•°ãªã‚‹
- æ¥ç¶šãŒå‰Šé™¤ã•ã‚ŒãŸ

**è§£æ±ºæ–¹æ³•:**

1. **Power Appsãƒãƒ¼ã‚¿ãƒ«ã§å†ç¢ºèª**
   - https://make.powerapps.com â†’ ãƒ‡ãƒ¼ã‚¿ â†’ æ¥ç¶š
   - æ¥ç¶šã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦URLã‹ã‚‰æ¥ç¶šIDã‚’å†å–å¾—
   ```
   https://make.powerapps.com/.../connections/shared_commondataserviceforapps/a1b2c3d4-e5f6-7890-abcd-ef1234567890/details
                                                                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
   ```

2. **ç’°å¢ƒã‚’ç¢ºèª**
   ```powershell
   # ç¾åœ¨ã®ç’°å¢ƒã‚’ç¢ºèª
   pac org who
   
   # ç’°å¢ƒã‚’åˆ‡ã‚Šæ›¿ãˆ
   pac org select --environment <ç’°å¢ƒID>
   ```

3. **æ¥ç¶šã‚’å†ä½œæˆ**
   - Power Appsãƒãƒ¼ã‚¿ãƒ«ã§æ¥ç¶šã‚’å‰Šé™¤
   - æ–°ã—ã„æ¥ç¶šã‚’ä½œæˆ
   - æ–°ã—ã„æ¥ç¶šIDã§å†è©¦è¡Œ

---

#### å•é¡Œ3: customization.xml ãŒè¦‹ã¤ã‹ã‚‰ãªã„

**ç—‡çŠ¶:**  
`pac code add-data-source` å®Ÿè¡Œæ™‚ã«ã‚¹ã‚­ãƒ¼ãƒæƒ…å ±ãŒå–å¾—ã§ããªã„

**åŸå› :**
- `customization.xml` ãŒãƒ¯ãƒ¼ã‚¯ã‚¹ãƒšãƒ¼ã‚¹ãƒ«ãƒ¼ãƒˆã«é…ç½®ã•ã‚Œã¦ã„ãªã„
- ãƒ•ã‚¡ã‚¤ãƒ«åãŒé–“é•ã£ã¦ã„ã‚‹

**è§£æ±ºæ–¹æ³•:**

1. **ãƒ•ã‚¡ã‚¤ãƒ«é…ç½®ã‚’ç¢ºèª**
   ```powershell
   # ãƒ•ã‚¡ã‚¤ãƒ«ã®å­˜åœ¨ç¢ºèª
   Get-Item .\customization.xml
   
   # é…ç½®å ´æ‰€ãŒæ­£ã—ã„ã‹ç¢ºèª
   Get-Location  # ãƒ¯ãƒ¼ã‚¯ã‚¹ãƒšãƒ¼ã‚¹ãƒ«ãƒ¼ãƒˆã«ã„ã‚‹ã“ã¨ã‚’ç¢ºèª
   ```

2. **æ­£ã—ã„é…ç½®å ´æ‰€:**
   ```
   YourCodeAppsProject/    â† ã“ã“ãŒãƒ«ãƒ¼ãƒˆ
   â”œâ”€â”€ customization.xml   â† ã“ã“ã«é…ç½®
   â”œâ”€â”€ src/
   â”œâ”€â”€ package.json
   â””â”€â”€ vite.config.ts
   ```

3. **ã‚½ãƒªãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å†ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ**
   - Power Appsãƒãƒ¼ã‚¿ãƒ« â†’ ã‚½ãƒªãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³
   - å¯¾è±¡ã‚½ãƒªãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³ã‚’é¸æŠ â†’ ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ
   - ã‚¢ãƒ³ãƒãƒãƒ¼ã‚¸ãƒ‰ã‚’é¸æŠ
   - ZIPã‚’è§£å‡ â†’ Customizations/customization.xml ã‚’ã‚³ãƒ”ãƒ¼

---

#### å•é¡Œ4: ãƒ‡ãƒ¼ã‚¿ãŒå–å¾—ã§ããªã„ (ç©ºé…åˆ—ãŒè¿”ã‚‹)

**ç—‡çŠ¶:**  
ã‚¨ãƒ©ãƒ¼ã¯å‡ºãªã„ãŒã€ãƒ‡ãƒ¼ã‚¿ãŒ0ä»¶

**åŸå› ã¨è§£æ±ºæ–¹æ³•:**

**åŸå› 1: filterãŒå³ã—ã™ãã‚‹**
```typescript
// âŒ å…¨ã¦ãƒ•ã‚£ãƒ«ã‚¿ã§é™¤å¤–ã•ã‚Œã¦ã„ã‚‹
const result = await SystemUsersService.getAll({
  filter: 'isdisabled eq false and fullname eq "å­˜åœ¨ã—ãªã„åå‰"'
});

// âœ… ãƒ•ã‚£ãƒ«ã‚¿ã‚’ç·©ã‚ã‚‹ or å‰Šé™¤
const result = await SystemUsersService.getAll({
  filter: 'isdisabled eq false'
});
```

**åŸå› 2: ãƒ†ãƒ¼ãƒ–ãƒ«ã«ãƒ‡ãƒ¼ã‚¿ãŒå­˜åœ¨ã—ãªã„**
```powershell
# Power Appsãƒãƒ¼ã‚¿ãƒ«ã§ç¢ºèª
# https://make.powerapps.com â†’ ãƒ‡ãƒ¼ã‚¿ â†’ ãƒ†ãƒ¼ãƒ–ãƒ« â†’ è©²å½“ãƒ†ãƒ¼ãƒ–ãƒ«
```

**åŸå› 3: ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ­ãƒ¼ãƒ«ã®æ¨©é™ä¸è¶³**
- Dataverseã®ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ­ãƒ¼ãƒ«è¨­å®šã‚’ç¢ºèª
- èª­ã¿å–ã‚Šæ¨©é™ãŒä»˜ä¸ã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª

---

#### å•é¡Œ5: IOperationResult.isSuccess ãŒ false

**ç—‡çŠ¶:**  
`result.isSuccess` ãŒå¸¸ã« `false` ã‚’è¿”ã™

**ãƒ‡ãƒãƒƒã‚°æ–¹æ³•:**

```typescript
const result = await SystemUsersService.getAll();

if (!result.isSuccess) {
  // âœ… ã‚¨ãƒ©ãƒ¼è©³ç´°ã‚’ç¢ºèª
  console.error('Error Code:', result.error?.code);
  console.error('Error Message:', result.error?.message);
  console.error('Error Details:', result.error?.details);
  console.error('Full Error:', JSON.stringify(result.error, null, 2));
}
```

**ã‚ˆãã‚ã‚‹ã‚¨ãƒ©ãƒ¼ã‚³ãƒ¼ãƒ‰ã¨è§£æ±ºæ³•:**

| ã‚¨ãƒ©ãƒ¼ã‚³ãƒ¼ãƒ‰ | åŸå›  | è§£æ±ºæ–¹æ³• |
|------------|------|---------|
| `0x80040217` | ãƒ¬ã‚³ãƒ¼ãƒ‰ãŒå­˜åœ¨ã—ãªã„ | IDã‚’ç¢ºèªã€å‰Šé™¤æ¸ˆã¿ã®å¯èƒ½æ€§ |
| `0x80048306` | æ¨©é™ä¸è¶³ | ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ­ãƒ¼ãƒ«ã‚’ç¢ºèª |
| `0x8004037a` | ãƒ“ã‚¸ãƒã‚¹ãƒ«ãƒ¼ãƒ«é•å | å¿…é ˆãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’ç¢ºèª |
| `0x80040220` | é‡è¤‡æ¤œå‡ºãƒ«ãƒ¼ãƒ« | ãƒ¬ã‚³ãƒ¼ãƒ‰ãŒæ—¢ã«å­˜åœ¨ |

---

#### å•é¡Œ6: Lookupãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ãŒ null

**ç—‡çŠ¶:**  
Lookupãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’å–å¾—ã—ã‚ˆã†ã¨ã™ã‚‹ã¨ `null` ã«ãªã‚‹

**åŸå› :**
- `$expand` ã‚’ä½¿ç”¨ã—ã¦ã„ãªã„
- navigationPropertyåãŒé–“é•ã£ã¦ã„ã‚‹

**è§£æ±ºæ–¹æ³•:**

```typescript
// âŒ expandãªã—ã§ã¯ _geek_assignedto_value (GUID) ã®ã¿å–å¾—
const result = await GeekProjectTasksService.getAll({
  select: ['geek_name', '_geek_assignedto_value']
});
// task.geek_AssignedTo ã¯ undefined

// âœ… $expandã§Lookupãƒ‡ãƒ¼ã‚¿ã‚’å±•é–‹
const result = await GeekProjectTasksService.getAll({
  select: ['geek_name', '_geek_assignedto_value'],
  expand: [
    {
      navigationProperty: 'geek_AssignedTo',  // å¤§æ–‡å­—å°æ–‡å­—ã«æ³¨æ„
      select: ['systemuserid', 'fullname']
    }
  ]
});
// task.geek_AssignedTo.fullname ã§ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½
```

> **ğŸ“˜ è©³ç´°ã‚¬ã‚¤ãƒ‰**  
> Lookupãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã¯ **[LOOKUP_FIELD_GUIDE.md](./docs/LOOKUP_FIELD_GUIDE.md)** ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚

---

#### å•é¡Œ7: Choice (ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚»ãƒƒãƒˆ) ã®å€¤ãŒæ•°å€¤ã§è¡¨ç¤ºã•ã‚Œã‚‹

**ç—‡çŠ¶:**  
ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãŒ `100000000` ã®ã‚ˆã†ãªæ•°å€¤ã§è¡¨ç¤ºã•ã‚Œã‚‹

**åŸå› :**  
Choiceãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã¯å†…éƒ¨çš„ã«æ•´æ•°å€¤ã§ç®¡ç†ã•ã‚Œã¦ã„ã‚‹

**è§£æ±ºæ–¹æ³•:**

```typescript
// Choiceå€¤ã®ãƒãƒƒãƒ”ãƒ³ã‚°ã‚’å®šç¾©
const STATUS_LABELS = {
  100000000: 'æ–°è¦',
  100000001: 'é€²è¡Œä¸­',
  100000002: 'å®Œäº†',
  100000003: 'ã‚­ãƒ£ãƒ³ã‚»ãƒ«'
} as const;

// ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã§ä½¿ç”¨
function TaskCard({ task }) {
  const statusLabel = STATUS_LABELS[task.geek_status] || 'ä¸æ˜';
  
  return (
    <div>
      <h3>{task.geek_name}</h3>
      <p>ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹: {statusLabel}</p>
    </div>
  );
}
```

> **ğŸ“˜ ã‚¹ã‚­ãƒ¼ãƒãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹**  
> Choiceå€¤ã®å®šç¾©ã¯ **[DATAVERSE_SCHEMA_REFERENCE.md](./docs/DATAVERSE_SCHEMA_REFERENCE.md)** ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚

---

### ãƒ‡ãƒãƒƒã‚°æ–¹æ³•

#### ãƒ–ãƒ©ã‚¦ã‚¶ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã§ã®ç¢ºèª

```typescript
// åˆæœŸåŒ–çŠ¶æ…‹ã‚’ç¢ºèª
console.log('SDK Initialized:', isInitialized);

// ãƒ‡ãƒ¼ã‚¿å–å¾—çµæœã‚’ç¢ºèª
const result = await SystemUsersService.getAll();
console.log('Result:', result);
console.log('Is Success:', result.isSuccess);
console.log('Value:', result.value);
console.log('Error:', result.error);

// ãƒ‡ãƒ¼ã‚¿ä»¶æ•°ã‚’ç¢ºèª
console.log('Data count:', result.value?.length);
```

#### Network ã‚¿ãƒ–ã§ã®ç¢ºèª

1. F12ã§é–‹ç™ºè€…ãƒ„ãƒ¼ãƒ«ã‚’é–‹ã
2. **Network** ã‚¿ãƒ–ã‚’é¸æŠ
3. ãƒ‡ãƒ¼ã‚¿å–å¾—æ“ä½œã‚’å®Ÿè¡Œ
4. OData APIãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’ç¢ºèª

**ç¢ºèªãƒã‚¤ãƒ³ãƒˆ:**
- ãƒªã‚¯ã‚¨ã‚¹ãƒˆURL: `/api/data/v9.2/systemusers`
- Status Code: 200 (æˆåŠŸ)
- Response: è¿”ã•ã‚ŒãŸJSONãƒ‡ãƒ¼ã‚¿

#### Power Apps Monitorã§ã®ç¢ºèª

1. Power Apps Maker Portal â†’ ãƒ¢ãƒ‹ã‚¿ãƒ¼
2. Code Appsã‚’èµ·å‹•
3. å®Ÿè¡Œã•ã‚ŒãŸODataã‚¯ã‚¨ãƒªã‚’ç¢ºèª

> **ğŸ“˜ è©³ç´°ãªãƒ‡ãƒãƒƒã‚°æ–¹æ³•**  
> **[DATAVERSE_DEBUG.md](./docs/DATAVERSE_DEBUG.md)** ã¨ **[DATAVERSE_TROUBLESHOOTING.md](./docs/DATAVERSE_TROUBLESHOOTING.md)** ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚

---

## âœ… Phase 5 å®Œäº†ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

### ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹æ¥ç¶š
- [ ] Power Appsãƒãƒ¼ã‚¿ãƒ«ã§æ¥ç¶šãŒä½œæˆã•ã‚Œã¦ã„ã‚‹
- [ ] æ¥ç¶šIDãŒå–å¾—ã§ãã¦ã„ã‚‹
- [ ] `pac code add-data-source` ãŒæˆåŠŸã—ã¦ã„ã‚‹
- [ ] ã‚µãƒ¼ãƒ“ã‚¹ã‚¯ãƒ©ã‚¹ãŒç”Ÿæˆã•ã‚Œã¦ã„ã‚‹

### ã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯
- [ ] ã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯ãŒä½œæˆã•ã‚Œã¦ã„ã‚‹
- [ ] `isInitialized` ãƒã‚§ãƒƒã‚¯ãŒå®Ÿè£…ã•ã‚Œã¦ã„ã‚‹
- [ ] ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ãŒå®Ÿè£…ã•ã‚Œã¦ã„ã‚‹
- [ ] ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°çŠ¶æ…‹ã®ç®¡ç†ãŒå®Ÿè£…ã•ã‚Œã¦ã„ã‚‹

### UIçµ±åˆ
- [ ] ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã§ã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯ã‚’ä½¿ç”¨ã—ã¦ã„ã‚‹
- [ ] åˆæœŸåŒ–ä¸­ã®è¡¨ç¤ºãŒå®Ÿè£…ã•ã‚Œã¦ã„ã‚‹
- [ ] ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ä¸­ã®è¡¨ç¤ºãŒå®Ÿè£…ã•ã‚Œã¦ã„ã‚‹
- [ ] ã‚¨ãƒ©ãƒ¼è¡¨ç¤ºãŒå®Ÿè£…ã•ã‚Œã¦ã„ã‚‹
- [ ] ãƒ‡ãƒ¼ã‚¿ãŒæ­£ã—ãè¡¨ç¤ºã•ã‚Œã‚‹

### å‹•ä½œç¢ºèª
- [ ] ãƒ‡ãƒ¼ã‚¿ã®èª­ã¿å–ã‚ŠãŒæˆåŠŸã™ã‚‹
- [ ] ãƒ‡ãƒ¼ã‚¿ã®ä½œæˆãŒæˆåŠŸã™ã‚‹ï¼ˆè©²å½“ã™ã‚‹å ´åˆï¼‰
- [ ] ãƒ‡ãƒ¼ã‚¿ã®æ›´æ–°ãŒæˆåŠŸã™ã‚‹ï¼ˆè©²å½“ã™ã‚‹å ´åˆï¼‰
- [ ] ãƒ‡ãƒ¼ã‚¿ã®å‰Šé™¤ãŒæˆåŠŸã™ã‚‹ï¼ˆè©²å½“ã™ã‚‹å ´åˆï¼‰
- [ ] ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ãŒæ­£å¸¸ã«å‹•ä½œã™ã‚‹

---

## ï¿½ é–¢é€£ãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹

### Dataverseå®Ÿè£…
- **[LOOKUP_FIELD_GUIDE.md](./docs/LOOKUP_FIELD_GUIDE.md)** - Lookupãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰å®Œå…¨ã‚¬ã‚¤ãƒ‰
- **[DATAVERSE_SCHEMA_REFERENCE.md](./docs/DATAVERSE_SCHEMA_REFERENCE.md)** - ã‚¹ã‚­ãƒ¼ãƒå®šç¾©ã¨Choiceå€¤
- **[HOW_TO_GET_DATAVERSE_SCHEMA.md](./docs/HOW_TO_GET_DATAVERSE_SCHEMA.md)** - ã‚¹ã‚­ãƒ¼ãƒå–å¾—æ–¹æ³•

### ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°
- **[DATAVERSE_TROUBLESHOOTING.md](./docs/DATAVERSE_TROUBLESHOOTING.md)** - ã‚ˆãã‚ã‚‹å•é¡Œã¨è§£æ±ºæ³•
- **[DATAVERSE_DEBUG.md](./docs/DATAVERSE_DEBUG.md)** - ãƒ‡ãƒãƒƒã‚°æ–¹æ³•

---

## âœ… Phase 5 å®Œäº†ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

### Step 1: æ¥ç¶šIDå–å¾—
- [ ] Power Appsãƒãƒ¼ã‚¿ãƒ«ã§ Dataverse æ¥ç¶šãŒä½œæˆã•ã‚Œã¦ã„ã‚‹
- [ ] æ¥ç¶šã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦è©³ç´°ãƒšãƒ¼ã‚¸ã‚’é–‹ã„ãŸ
- [ ] ãƒ–ãƒ©ã‚¦ã‚¶URLã‹ã‚‰æ¥ç¶šIDã‚’ã‚³ãƒ”ãƒ¼ã—ãŸ
- [ ] æ¥ç¶šIDãŒGUIDå½¢å¼ (ä¾‹: `a1b2c3d4-e5f6-7890-abcd-ef1234567890`) ã§ã‚ã‚‹

### Step 2: ã‚¹ã‚­ãƒ¼ãƒå–å¾—
- [ ] Power Appsãƒãƒ¼ã‚¿ãƒ«ã§ã‚½ãƒªãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã—ãŸ
- [ ] ZIPãƒ•ã‚¡ã‚¤ãƒ«ã‚’è§£å‡ã—ãŸ
- [ ] `customization.xml` ã‚’ãƒ¯ãƒ¼ã‚¯ã‚¹ãƒšãƒ¼ã‚¹ãƒ«ãƒ¼ãƒˆã«é…ç½®ã—ãŸ
- [ ] `Get-Item .\customization.xml` ã§ãƒ•ã‚¡ã‚¤ãƒ«å­˜åœ¨ã‚’ç¢ºèªã—ãŸ

### Step 3: ã‚µãƒ¼ãƒ“ã‚¹ã‚¯ãƒ©ã‚¹ç”Ÿæˆ
- [ ] `pac code add-data-source` ã‚³ãƒãƒ³ãƒ‰ãŒæˆåŠŸã—ãŸ
- [ ] `src/generated/models/` ã«Modelå®šç¾©ãŒç”Ÿæˆã•ã‚Œã¦ã„ã‚‹
- [ ] `src/generated/services/` ã«Serviceã‚¯ãƒ©ã‚¹ãŒç”Ÿæˆã•ã‚Œã¦ã„ã‚‹
- [ ] `npm run build` ãŒæˆåŠŸã—ãŸ
- [ ] `npm run lint` ã§ã‚¨ãƒ©ãƒ¼ãŒãªã„

### Step 4: ãƒ‡ãƒ¼ã‚¿çµ±åˆ
- [ ] ã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯ã‚’ä½œæˆã—ãŸ
- [ ] `usePowerPlatform().isInitialized` ãƒã‚§ãƒƒã‚¯ã‚’å®Ÿè£…ã—ãŸ
- [ ] `IOperationResult.isSuccess` ã§ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã‚’å®Ÿè£…ã—ãŸ
- [ ] Reactã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã§ã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯ã‚’ä½¿ç”¨ã—ãŸ
- [ ] ãƒ¢ãƒƒã‚¯ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å‰Šé™¤ã—ãŸ
- [ ] ãƒ¢ãƒƒã‚¯ãƒ‡ãƒ¼ã‚¿ã¸ã®å‚ç…§ã‚’å‰Šé™¤ã—ãŸ

### å‹•ä½œç¢ºèª
- [ ] ãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒã§ã‚¢ãƒ—ãƒªãŒèµ·å‹•ã™ã‚‹ (`npm run dev`)
- [ ] SDKåˆæœŸåŒ–ä¸­ã®è¡¨ç¤ºãŒæ­£ã—ãè¡¨ç¤ºã•ã‚Œã‚‹
- [ ] ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿ä¸­ã®è¡¨ç¤ºãŒæ­£ã—ãè¡¨ç¤ºã•ã‚Œã‚‹
- [ ] Dataverseã‹ã‚‰å®Ÿãƒ‡ãƒ¼ã‚¿ãŒå–å¾—ã§ãã‚‹
- [ ] ãƒ‡ãƒ¼ã‚¿ãŒæ­£ã—ãUIã«è¡¨ç¤ºã•ã‚Œã‚‹
- [ ] ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ãŒæ­£å¸¸ã«å‹•ä½œã™ã‚‹
- [ ] ãƒ–ãƒ©ã‚¦ã‚¶ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã«ã‚¨ãƒ©ãƒ¼ãŒå‡ºã¦ã„ãªã„

### CRUDæ“ä½œ (è©²å½“ã™ã‚‹å ´åˆ)
- [ ] ãƒ‡ãƒ¼ã‚¿ã®ä½œæˆãŒæˆåŠŸã™ã‚‹
- [ ] ãƒ‡ãƒ¼ã‚¿ã®æ›´æ–°ãŒæˆåŠŸã™ã‚‹
- [ ] ãƒ‡ãƒ¼ã‚¿ã®å‰Šé™¤ãŒæˆåŠŸã™ã‚‹
- [ ] æ“ä½œå¾Œã«ãƒ‡ãƒ¼ã‚¿ãŒå†èª­ã¿è¾¼ã¿ã•ã‚Œã‚‹

### Power Appsç’°å¢ƒã§ã®ç¢ºèª
- [ ] `pac code build` ãŒæˆåŠŸã™ã‚‹
- [ ] `pac code push` ãŒæˆåŠŸã™ã‚‹
- [ ] Power Appsç’°å¢ƒã§ã‚¢ãƒ—ãƒªãŒæ­£å¸¸ã«èµ·å‹•ã™ã‚‹
- [ ] Power Appsç’°å¢ƒã§å®Ÿãƒ‡ãƒ¼ã‚¿ãŒè¡¨ç¤ºã•ã‚Œã‚‹

---

## ï¿½ğŸ”„ æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—

Phase 5ãŒå®Œäº†ã—ãŸã‚‰ã€ç¶™ç¶šçš„ãªæ©Ÿèƒ½æ‹¡å¼µã‚µã‚¤ã‚¯ãƒ«ã«å…¥ã‚Šã¾ã™ã€‚

**ç¶™ç¶šé–‹ç™ºã‚µã‚¤ã‚¯ãƒ«:**

```mermaid
graph LR
    A[è¦ä»¶å®šç¾©] --> B[ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«è¨­è¨ˆ]
    B --> C[ã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯å®Ÿè£…]
    C --> D[UIå®Ÿè£…]
    D --> E[ãƒ†ã‚¹ãƒˆ]
    E --> F[ãƒ‡ãƒ—ãƒ­ã‚¤]
    F --> A
    
    style A fill:#e3f2fd
    style B fill:#e8f5e9
    style C fill:#fff3e0
    style D fill:#f3e5f5
    style E fill:#fce4ec
    style F fill:#e0f2f1
```

**å…·ä½“çš„ãªæ¬¡ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³:**

1. **æ–°æ©Ÿèƒ½ã®è¦ä»¶å®šç¾©**
   - ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¹ãƒˆãƒ¼ãƒªãƒ¼ã®ä½œæˆ
   - å¿…è¦ãªãƒ‡ãƒ¼ã‚¿ã®ç‰¹å®š
   - UI/UXãƒ‡ã‚¶ã‚¤ãƒ³

2. **ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«ã®è¨­è¨ˆ**
   - æ–°ã—ã„ãƒ†ãƒ¼ãƒ–ãƒ«ã®ä½œæˆ (å¿…è¦ã«å¿œã˜ã¦)
   - ãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚·ãƒƒãƒ—ã®å®šç¾©
   - ãƒ“ã‚¸ãƒã‚¹ãƒ«ãƒ¼ãƒ«ã®è¨­å®š

3. **ã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯ã®å®Ÿè£…**
   - æ–°ã—ã„ã‚µãƒ¼ãƒ“ã‚¹ã‚¯ãƒ©ã‚¹ã®ç”Ÿæˆ
   - ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ã®å®Ÿè£…
   - ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã®è¿½åŠ 

4. **UIã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®å®Ÿè£…**
   - Reactã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®ä½œæˆ
   - ãƒ‡ã‚¶ã‚¤ãƒ³ã‚·ã‚¹ãƒ†ãƒ ã®é©ç”¨
   - ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–å¯¾å¿œ

5. **ãƒ†ã‚¹ãƒˆ**
   - ãƒ­ãƒ¼ã‚«ãƒ«ã§ã®å‹•ä½œç¢ºèª
   - ã‚¨ãƒƒã‚¸ã‚±ãƒ¼ã‚¹ã®ãƒ†ã‚¹ãƒˆ
   - ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã®ç¢ºèª

6. **ãƒ‡ãƒ—ãƒ­ã‚¤ (Phase 4ã«æˆ»ã‚‹)**
   - `pac code build`
   - `pac code push`
   - Power Appsç’°å¢ƒã§ã®å‹•ä½œç¢ºèª

---

## ğŸ’¡ ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹

### ã‚³ãƒ¼ãƒ‰å“è³ª
- âœ… TypeScriptå‹å®šç¾©ã‚’æ´»ç”¨ã™ã‚‹
- âœ… ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã‚’å¾¹åº•ã™ã‚‹
- âœ… ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°çŠ¶æ…‹ã‚’é©åˆ‡ã«ç®¡ç†ã™ã‚‹
- âœ… ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’å°ã•ãä¿ã¤
- âœ… ã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯ã§ãƒ­ã‚¸ãƒƒã‚¯ã‚’åˆ†é›¢ã™ã‚‹

### ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹
- âœ… `select` ã§å¿…è¦ãªãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®ã¿å–å¾—ã™ã‚‹
- âœ… `filter` ã§ãƒ‡ãƒ¼ã‚¿ã‚’çµã‚Šè¾¼ã‚€
- âœ… `top` ã§å–å¾—ä»¶æ•°ã‚’åˆ¶é™ã™ã‚‹
- âœ… ä¸è¦ãªå†ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã‚’é¿ã‘ã‚‹ (`useMemo`, `useCallback`)
- âœ… Lookupå±•é–‹ã¯å¿…è¦ãªå ´åˆã®ã¿ä½¿ç”¨ã™ã‚‹

### ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£
- âœ… Dataverseã®ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ­ãƒ¼ãƒ«ã‚’é©åˆ‡ã«è¨­å®šã™ã‚‹
- âœ… ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ãƒ¬ãƒ™ãƒ«ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚’æ´»ç”¨ã™ã‚‹
- âœ… ãƒ“ã‚¸ãƒã‚¹ãƒ«ãƒ¼ãƒ«ã§å…¥åŠ›å€¤ã‚’æ¤œè¨¼ã™ã‚‹
- âœ… ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå´ã§æ©Ÿå¯†æƒ…å ±ã‚’ä¿æŒã—ãªã„

### ä¿å®ˆæ€§
- âœ… ã‚³ãƒ¼ãƒ‰ã«ã‚³ãƒ¡ãƒ³ãƒˆã‚’è¿½åŠ ã™ã‚‹
- âœ… å®šæ•°ã‚’åˆ¥ãƒ•ã‚¡ã‚¤ãƒ«ã«åˆ†é›¢ã™ã‚‹
- âœ… ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£é–¢æ•°ã‚’å†åˆ©ç”¨ã™ã‚‹
- âœ… ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’æ›´æ–°ã™ã‚‹
- âœ… ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†ã‚’æ´»ç”¨ã™ã‚‹

---

ğŸ‰ **Phase 5å®Œäº†ãŠã‚ã§ã¨ã†ã”ã–ã„ã¾ã™ï¼**

ãƒ¢ãƒƒã‚¯ãƒ‡ãƒ¼ã‚¿ã‹ã‚‰å®Ÿãƒ‡ãƒ¼ã‚¿ã¸ã®ç§»è¡ŒãŒå®Œäº†ã—ã€Power Apps Code Appsã§æœ¬æ ¼çš„ãªãƒ“ã‚¸ãƒã‚¹ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãŒç¨¼åƒã—ã¦ã„ã¾ã™ã€‚

**ä»Šå¾Œã®å±•é–‹:**
- ğŸ“Š ãƒ¬ãƒãƒ¼ãƒˆæ©Ÿèƒ½ã®è¿½åŠ 
- ğŸ”” é€šçŸ¥æ©Ÿèƒ½ã®å®Ÿè£…
- ğŸ“± ãƒ¢ãƒã‚¤ãƒ«å¯¾å¿œã®å¼·åŒ–
- ğŸ”— å¤–éƒ¨ã‚µãƒ¼ãƒ“ã‚¹ã¨ã®çµ±åˆ
- ğŸš€ ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–

ç¶™ç¶šçš„ã«æ”¹å–„ã‚’é‡ã­ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ä¾¡å€¤ã‚’æä¾›ã—ç¶šã‘ã¾ã—ã‚‡ã†ï¼
```

**ç”Ÿæˆã•ã‚Œã‚‹ãƒ•ã‚¡ã‚¤ãƒ«:**
```
src/generated/services/Office365UsersService.ts
src/generated/models/Office365UsersModel.ts
```

**è‡ªå‹•ç”Ÿæˆã•ã‚Œã‚‹ãƒ¡ã‚½ãƒƒãƒ‰:**
- `MyProfile_V2()` - ç¾åœ¨ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«
- `UserProfile_V2(id)` - ç‰¹å®šãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«
- `SearchUserV2(searchTerm)` - ãƒ¦ãƒ¼ã‚¶ãƒ¼æ¤œç´¢
- `Manager_V2(id)` - ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼æƒ…å ±
- `DirectReports_V2(id)` - ç›´å±ã®éƒ¨ä¸‹

### **3.3 Dataverse: SystemUsers ãƒ†ãƒ¼ãƒ–ãƒ«**

```bash
# SystemUsers ãƒ†ãƒ¼ãƒ–ãƒ«ã®ã‚µãƒ¼ãƒ“ã‚¹ã‚¯ãƒ©ã‚¹ã‚’ç”Ÿæˆ
pac code add-data-source -a "shared_commondataserviceforapps" -c "a1b2c3d4-e5f6-7890-1234-567890abcdef" -t "systemusers"
```

**ç”Ÿæˆã•ã‚Œã‚‹ãƒ•ã‚¡ã‚¤ãƒ«:**
```
src/generated/services/SystemusersService.ts
src/generated/models/SystemusersModel.ts
```

**è‡ªå‹•ç”Ÿæˆã•ã‚Œã‚‹ãƒ¡ã‚½ãƒƒãƒ‰:**
- `getAll(options)` - ODataã‚¯ã‚¨ãƒªã§å–å¾—
- `get(id)` - IDã§1ä»¶å–å¾—
- `create(data)` - æ–°è¦ä½œæˆ
- `update(id, data)` - æ›´æ–°
- `delete(id)` - å‰Šé™¤

### **3.4 Dataverse: è¤‡æ•°ã®æ¨™æº–ãƒ†ãƒ¼ãƒ–ãƒ«**

```bash
# ç’°å¢ƒå¤‰æ•°ã«æ¥ç¶šIDã‚’è¨­å®š (PowerShell)
$connectionId = "a1b2c3d4-e5f6-7890-1234-567890abcdef"

# SystemUsers (ã‚·ã‚¹ãƒ†ãƒ ãƒ¦ãƒ¼ã‚¶ãƒ¼)
pac code add-data-source -a "shared_commondataserviceforapps" -c $connectionId -t "systemusers"

# Accounts (å–å¼•å…ˆä¼æ¥­)
pac code add-data-source -a "shared_commondataserviceforapps" -c $connectionId -t "accounts"

# Contacts (å–å¼•å…ˆæ‹…å½“è€…)
pac code add-data-source -a "shared_commondataserviceforapps" -c $connectionId -t "contacts"

# Tasks (ã‚¿ã‚¹ã‚¯)
pac code add-data-source -a "shared_commondataserviceforapps" -c $connectionId -t "tasks"

# ã‚«ã‚¹ã‚¿ãƒ ãƒ†ãƒ¼ãƒ–ãƒ« (ä¾‹: geek_project_task)
pac code add-data-source -a "shared_commondataserviceforapps" -c $connectionId -t "geek_project_task"
```

**ç”Ÿæˆã•ã‚Œã‚‹ã‚µãƒ¼ãƒ“ã‚¹ã‚¯ãƒ©ã‚¹åè¦å‰‡:**
- ãƒ†ãƒ¼ãƒ–ãƒ«è«–ç†å: `geek_project_task`
- ã‚µãƒ¼ãƒ“ã‚¹ã‚¯ãƒ©ã‚¹: `Geek_project_tasksService` (å…ˆé ­å¤§æ–‡å­—ã€æœ«å°¾ã«sè¿½åŠ )

**ğŸ”§ ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°:**

| å•é¡Œ | åŸå›  | å¯¾ç­– |
|------|------|------|
| `Connection not found` | æ¥ç¶šIDãŒç„¡åŠ¹ | Step 2ã§æ¥ç¶šIDã‚’å†ç¢ºèª |
| `Table not found` | ãƒ†ãƒ¼ãƒ–ãƒ«è«–ç†åãŒé–“é•ã„ | å°æ–‡å­—ãƒ»ã‚¢ãƒ³ãƒ€ãƒ¼ã‚¹ã‚³ã‚¢åŒºåˆ‡ã‚Šã‚’ç¢ºèª |
| `Authentication failed` | pacèªè¨¼ãŒæœŸé™åˆ‡ã‚Œ | `pac auth create` ã§å†èªè¨¼ |
| ãƒ•ã‚¡ã‚¤ãƒ«ãŒç”Ÿæˆã•ã‚Œãªã„ | ã‚³ãƒãƒ³ãƒ‰å®Ÿè¡Œã‚¨ãƒ©ãƒ¼ | ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ç¢ºèª |

---

### **Step 4: è‡ªå‹•ç”Ÿæˆã•ã‚ŒãŸã‚µãƒ¼ãƒ“ã‚¹ã‚¯ãƒ©ã‚¹ã®ç¢ºèª**

pac code add-data-source å®Ÿè¡Œå¾Œã€ä»¥ä¸‹ã®ãƒ•ã‚¡ã‚¤ãƒ«ãŒè‡ªå‹•ç”Ÿæˆã•ã‚Œã¾ã™ã€‚

**ç”Ÿæˆã•ã‚Œã‚‹ãƒ•ã‚¡ã‚¤ãƒ«æ§‹é€ :**

```
src/
  generated/
    services/
      Office365UsersService.ts        # Office 365 Users
      SystemusersService.ts            # Dataverse: SystemUsers
      AccountsService.ts               # Dataverse: Accounts
      Geek_project_tasksService.ts     # ã‚«ã‚¹ã‚¿ãƒ ãƒ†ãƒ¼ãƒ–ãƒ«
    models/
      Office365UsersModel.ts
      SystemusersModel.ts
      AccountsModel.ts
      Geek_project_tasksModel.ts
```

**ã‚µãƒ¼ãƒ“ã‚¹ã‚¯ãƒ©ã‚¹ã®åŸºæœ¬æ§‹é€  (ä¾‹: Office365UsersService):**

```typescript
export class Office365UsersService {
  private static readonly dataSourceName = 'office365users';
  private static readonly client = getClient(dataSourcesInfo);

  public static async MyProfile_V2($select?: string): Promise<IOperationResult<GraphUser_V1>> {
    const params: { $select?: string } = { $select };
    const result = await Office365UsersService.client.executeAsync<{ $select?: string }, GraphUser_V1>({
      connectorOperation: {
        tableName: Office365UsersService.dataSourceName,
        operationName: 'MyProfile_V2',
        parameters: params
      },
    });
    return result;
  }
  // ... ãã®ä»–ã®ãƒ¡ã‚½ãƒƒãƒ‰
}
```

**é‡è¦ãªãƒã‚¤ãƒ³ãƒˆ:**
- âœ… ã™ã¹ã¦ã®ãƒ¡ã‚½ãƒƒãƒ‰ãŒ `static` (ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹åŒ–ä¸è¦)
- âœ… `IOperationResult<T>` ã§çµ±ä¸€ã•ã‚ŒãŸãƒ¬ã‚¹ãƒãƒ³ã‚¹å‹
- âœ… TypeScriptå‹å®šç¾©ãŒè‡ªå‹•ç”Ÿæˆ
- âœ… Power Apps SDK ã® `getClient()` ã‚’ä½¿ç”¨

**ğŸ”§ ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°:**

| å•é¡Œ | åŸå›  | å¯¾ç­– |
|------|------|------|
| ç”Ÿæˆã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«ãŒè¦‹ã¤ã‹ã‚‰ãªã„ | ã‚³ãƒãƒ³ãƒ‰å®Ÿè¡Œå¤±æ•— | ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ç¢ºèª |
| TypeScriptã‚¨ãƒ©ãƒ¼ãŒå‡ºã‚‹ | å‹å®šç¾©ã®ä¸ä¸€è‡´ | `npm run build` ã§ãƒ“ãƒ«ãƒ‰ã‚¨ãƒ©ãƒ¼ã‚’ç¢ºèª |
| ãƒ¡ã‚½ãƒƒãƒ‰ãŒè¦‹ã¤ã‹ã‚‰ãªã„ | ã‚³ãƒã‚¯ã‚¿ãƒ¼ãƒãƒ¼ã‚¸ãƒ§ãƒ³é•ã„ | ç”Ÿæˆã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç›´æ¥ç¢ºèª |

---

### **Step 5: PowerDataRuntime åˆæœŸåŒ–ç¢ºèªãƒ‘ã‚¿ãƒ¼ãƒ³å®Ÿè£…**

**âš ï¸ é‡è¦:** Power Apps SDK ã‚’ä½¿ç”¨ã™ã‚‹å‰ã«ã€**å¿…ãš PowerDataRuntime ã®åˆæœŸåŒ–å®Œäº†ã‚’ç¢ºèª**ã—ã¦ãã ã•ã„ã€‚

**åŸºæœ¬ãƒ‘ã‚¿ãƒ¼ãƒ³:**

```typescript
import { usePowerPlatform } from '@microsoft/power-apps';
import { SystemUsersService } from '../generated/services/SystemUsersService';

export function DataPage() {
  const { isInitialized } = usePowerPlatform();
  const [users, setUsers] = useState([]);

  useEffect(() => {
    // âŒ åˆæœŸåŒ–å‰ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ã¨ã‚¨ãƒ©ãƒ¼
    if (!isInitialized) {
      console.log('SDK not initialized, waiting...');
      return;
    }

    // âœ… åˆæœŸåŒ–å¾Œã«ãƒ‡ãƒ¼ã‚¿å–å¾—
    const loadUsers = async () => {
      const result = await SystemUsersService.getAll();
      if (result.isSuccess && result.value) {
        setUsers(result.value);
      }
    };
    loadUsers();
  }, [isInitialized]); // ä¾å­˜é…åˆ—ã« isInitialized ã‚’å«ã‚ã‚‹

  // ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¡¨ç¤º
  if (!isInitialized) {
    return <div>Power Apps SDK åˆæœŸåŒ–ä¸­...</div>;
  }

  return <div>{/* ãƒ‡ãƒ¼ã‚¿è¡¨ç¤º */}</div>;
}
```

**PowerProvider ã®è¨­å®šç¢ºèª:**

```typescript
// src/main.tsx
import { PowerProvider } from '@microsoft/power-apps';

ReactDOM.createRoot(document.getElementById('root')!).render(
  <PowerProvider>  {/* â† å¿…é ˆ */}
    <App />
  </PowerProvider>
);
```

**ğŸ”§ ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°:**

| ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ | åŸå›  | å¯¾ç­– |
|----------------|------|------|
| `PowerDataRuntime is not initialized` | SDKæœªåˆæœŸåŒ– | `usePowerPlatform().isInitialized` ã‚’ç¢ºèª |
| `PowerProvider not found` | PowerProvideræœªè¨­å®š | main.tsx ã§ PowerProvider ã‚’è¿½åŠ  |
| åˆæœŸåŒ–ãŒå®Œäº†ã—ãªã„ | `pac code run` æœªå®Ÿè¡Œ | `pac code run` ã§ã‚¢ãƒ—ãƒªã‚’èµ·å‹• |

**åˆæœŸåŒ–ç¢ºèªã®ãƒ‡ãƒãƒƒã‚°:**

```typescript
const { isInitialized } = usePowerPlatform();

useEffect(() => {
  console.log('SDKåˆæœŸåŒ–çŠ¶æ…‹:', isInitialized);
}, [isInitialized]);

// npm run dev â†’ isInitialized: false (Power Platformçµ±åˆãªã—)
// pac code run â†’ isInitialized: true (Power Platformçµ±åˆã‚ã‚Š)
```

---

### **Step 6: ã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯ä½œæˆ**

ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ã‚’ã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯ã«ã‚«ãƒ—ã‚»ãƒ«åŒ–ã—ã¾ã™ã€‚

**Office 365 Users ã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯:**

```typescript
// src/hooks/useOffice365Users.ts
import { useState, useCallback } from 'react';
import { usePowerPlatform } from '@microsoft/power-apps';
import { Office365UsersService } from '../generated/services/Office365UsersService';
import type { GraphUser_V1 } from '../generated/models/Office365UsersModel';

export const useOffice365Users = () => {
  const { isInitialized } = usePowerPlatform();
  const [loading, setLoading] = useState(false);
  const [error, setError] = useState<string | null>(null);

  // ç¾åœ¨ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«å–å¾—
  const getMyProfile = useCallback(async () => {
    if (!isInitialized) throw new Error('SDK not initialized');
    
    try {
      setLoading(true);
      const result = await Office365UsersService.MyProfile_V2();
      
      if (result.isSuccess && result.value) {
        return result.value;
      } else {
        throw new Error('ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«å–å¾—ã«å¤±æ•—ã—ã¾ã—ãŸ');
      }
    } catch (err) {
      const errorMessage = err instanceof Error ? err.message : 'Unknown error';
      setError(errorMessage);
      throw err;
    } finally {
      setLoading(false);
    }
  }, [isInitialized]);

  // ãƒ¦ãƒ¼ã‚¶ãƒ¼æ¤œç´¢
  const searchUsers = useCallback(async (searchTerm: string, top: number = 10) => {
    if (!isInitialized) throw new Error('SDK not initialized');
    
    try {
      setLoading(true);
      const result = await Office365UsersService.SearchUserV2(searchTerm, top, false);
      
      if (result.isSuccess && result.value) {
        return result.value.value || [];
      } else {
        throw new Error('ãƒ¦ãƒ¼ã‚¶ãƒ¼æ¤œç´¢ã«å¤±æ•—ã—ã¾ã—ãŸ');
      }
    } catch (err) {
      const errorMessage = err instanceof Error ? err.message : 'Unknown error';
      setError(errorMessage);
      throw err;
    } finally {
      setLoading(false);
    }
  }, [isInitialized]);

  return { getMyProfile, searchUsers, loading, error, isInitialized };
};
```

### **5.2 Dataverse: SystemUsers ã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯å®Ÿè£…**

```typescript
// src/hooks/useSystemUsers.ts
import { useState, useEffect, useCallback } from 'react';
import { usePowerPlatform } from '@microsoft/power-apps';
import { SystemUsersService } from '../generated/services/SystemUsersService';

export const useSystemUsers = () => {
  const { isInitialized } = usePowerPlatform();
  const [users, setUsers] = useState([]);
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState<string | null>(null);

  const fetchUsers = useCallback(async () => {
    if (!isInitialized) return;

    try {
      setLoading(true);
      const result = await SystemUsersService.getAll({
        select: ['systemuserid', 'fullname', 'internalemailaddress'],
        filter: 'isdisabled eq false',
        orderBy: 'fullname asc',
        top: 50
      });

      if (result.isSuccess && result.value) {
        setUsers(result.value);
      } else {
        throw new Error('ãƒ¦ãƒ¼ã‚¶ãƒ¼æ¤œç´¢ã«å¤±æ•—ã—ã¾ã—ãŸ');
      }
    } catch (err) {
      const errorMessage = err instanceof Error ? err.message : 'Unknown error';
      setError(errorMessage);
      throw err;
    } finally {
      setLoading(false);
    }
  }, [isInitialized]);

  return { getMyProfile, searchUsers, loading, error, isInitialized };
};
```

**Dataverse: SystemUsers ã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯:**

```typescript
// src/hooks/useSystemUsers.ts
import { useState, useEffect, useCallback } from 'react';
import { usePowerPlatform } from '@microsoft/power-apps';
import { SystemUsersService } from '../generated/services/SystemUsersService';

export const useSystemUsers = () => {
  const { isInitialized } = usePowerPlatform();
  const [users, setUsers] = useState([]);
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState<string | null>(null);

  const fetchUsers = useCallback(async () => {
    if (!isInitialized) return;

    try {
      setLoading(true);
      const result = await SystemUsersService.getAll({
        select: ['systemuserid', 'fullname', 'internalemailaddress'],
        filter: 'isdisabled eq false',
        orderBy: 'fullname asc',
        top: 50
      });

      if (result.isSuccess && result.value) {
        setUsers(result.value);
      } else {
        throw new Error('ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®å–å¾—ã«å¤±æ•—ã—ã¾ã—ãŸ');
      }
    } catch (err) {
      const errorMessage = err instanceof Error ? err.message : 'Unknown error';
      setError(errorMessage);
    } finally {
      setLoading(false);
    }
  }, [isInitialized]);

  useEffect(() => {
    if (isInitialized) {
      fetchUsers();
    }
  }, [isInitialized, fetchUsers]);

  return { users, loading, error, refetch: fetchUsers, isInitialized };
};
```

---

### **Step 7: Reactã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã§ã®ä½¿ç”¨**

ã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯ã‚’ä½¿ç”¨ã—ã¦Reactã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’å®Ÿè£…ã—ã¾ã™ã€‚

**åŸºæœ¬çš„ãªä½¿ç”¨ä¾‹:**

```typescript
// src/pages/UsersPage.tsx
import React from 'react';
import { useSystemUsers } from '../hooks/useSystemUsers';

export const UsersPage: React.FC = () => {
  const { users, loading, error, isInitialized } = useSystemUsers();

  if (!isInitialized) {
    return <div>Power Apps SDK åˆæœŸåŒ–ä¸­...</div>;
  }

  if (loading) {
    return <div>èª­ã¿è¾¼ã¿ä¸­...</div>;
  }

  if (error) {
    return <div>ã‚¨ãƒ©ãƒ¼: {error}</div>;
  }

  return (
    <div>
      <h1>ã‚·ã‚¹ãƒ†ãƒ ãƒ¦ãƒ¼ã‚¶ãƒ¼ ({users.length})</h1>
      {users.map(user => (
        <div key={user.systemuserid}>
          {user.fullname} - {user.internalemailaddress}
        </div>
      ))}
    </div>
  );
};
```

**ğŸ”§ ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°:**

| å•é¡Œ | åŸå›  | å¯¾ç­– |
|------|------|------|
| ãƒ‡ãƒ¼ã‚¿ãŒè¡¨ç¤ºã•ã‚Œãªã„ | `isInitialized` ãŒ false | `pac code run` ã§èµ·å‹•ã—ã¦ã„ã‚‹ã‹ç¢ºèª |
| ã‚¨ãƒ©ãƒ¼ãŒè¡¨ç¤ºã•ã‚Œã‚‹ | ã‚µãƒ¼ãƒ“ã‚¹ã‚¯ãƒ©ã‚¹ã®ã‚¨ãƒ©ãƒ¼ | `result.isSuccess` ã‚’ç¢ºèªã€ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°ã‚’ç¢ºèª |
| å‹ã‚¨ãƒ©ãƒ¼ãŒå‡ºã‚‹ | è‡ªå‹•ç”Ÿæˆã•ã‚ŒãŸå‹ã¨ä¸ä¸€è‡´ | ç”Ÿæˆã•ã‚ŒãŸModel.tsãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç¢ºèª |

---

## **ğŸ“‹ ã¾ã¨ã‚: ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹æ¥ç¶šã®å®Œå…¨ãƒ•ãƒ­ãƒ¼**

**7ã¤ã®ã‚¹ãƒ†ãƒƒãƒ—ã§å®Œäº†:**

1. âœ… **Power Apps ãƒãƒ¼ã‚¿ãƒ«ã§æ¥ç¶šä½œæˆ** â†’ èªè¨¼å®Œäº†
2. âœ… **ãƒ–ãƒ©ã‚¦ã‚¶URLã‹ã‚‰æ¥ç¶šIDå–å¾—** â†’ ã‚³ãƒ”ãƒ¼
3. âœ… **pac code add-data-source å®Ÿè¡Œ** â†’ ã‚µãƒ¼ãƒ“ã‚¹ã‚¯ãƒ©ã‚¹è‡ªå‹•ç”Ÿæˆ
4. âœ… **è‡ªå‹•ç”Ÿæˆã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«ç¢ºèª** â†’ src/generated/ é…ä¸‹ã‚’ç¢ºèª
5. âœ… **PowerDataRuntime åˆæœŸåŒ–ç¢ºèª** â†’ `isInitialized` ãƒã‚§ãƒƒã‚¯
6. âœ… **ã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯ä½œæˆ** â†’ ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ã‚’ã‚«ãƒ—ã‚»ãƒ«åŒ–
7. âœ… **Reactã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã§ä½¿ç”¨** â†’ UIå®Ÿè£…

**é‡è¦åŸå‰‡:**
- âœ… **Power Apps SDK çµŒç”±ã®ã¿ä½¿ç”¨** - ãƒ¦ãƒ¼ã‚¶ãƒ¼èªè¨¼ãŒè‡ªå‹•å‡¦ç†
- âŒ **ä»–ã®æ¥ç¶šæ–¹æ³•ã¯ä½¿ç”¨ç¦æ­¢** - Web APIã€Power Fxã€ç›´æ¥REST APIã¯ä½¿ç”¨ã—ãªã„
- âœ… **å¿…ãš isInitialized ã‚’ç¢ºèª** - åˆæœŸåŒ–å‰ã®ã‚¢ã‚¯ã‚»ã‚¹ã¯ã‚¨ãƒ©ãƒ¼
- âœ… **IOperationResult ã§çµæœç¢ºèª** - `isSuccess` ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã§æˆåŠŸ/å¤±æ•—ã‚’åˆ¤å®š
- âœ… **ã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯ã§ã‚«ãƒ—ã‚»ãƒ«åŒ–** - å†åˆ©ç”¨å¯èƒ½ãªãƒ­ã‚¸ãƒƒã‚¯å®Ÿè£…

**å®Ÿè¡Œã‚³ãƒãƒ³ãƒ‰ã¾ã¨ã‚:**

```bash
# 1. èªè¨¼ (åˆå›ã®ã¿)
pac auth create

# 2. Office 365 Users è¿½åŠ 
pac code add-data-source -a "shared_office365users" -c "{æ¥ç¶šID}"

# 3. Dataverse ãƒ†ãƒ¼ãƒ–ãƒ«è¿½åŠ 
pac code add-data-source -a "shared_commondataserviceforapps" -c "{æ¥ç¶šID}" -t "systemusers"

# 4. ã‚¢ãƒ—ãƒªå®Ÿè¡Œ (Power Platformçµ±åˆ)
pac code run

# 5. ãƒ“ãƒ«ãƒ‰
npm run build

# 6. ãƒ‡ãƒ—ãƒ­ã‚¤
pac code push
```

---

### **æœªå®Ÿè£…æ©Ÿèƒ½é–‹ç™ºãƒ»ãƒ¦ãƒ¼ã‚¶ãƒ¼ææ¡ˆ**        $value = $option.SelectSingleNode("c:Value", $ns).'#text'
        $label = $option.SelectSingleNode(".//c:Label[@languagecode='1033']", $ns).'#text'
        Write-Host "    $value : $label"
    }
}
```

**å®Ÿè¡Œ:**
```powershell
.\Extract-DataverseChoices.ps1 -XmlPath "customizations.xml" -EntityName "geek_project_task"
```

**å‡ºåŠ›ä¾‹:**
```
=== geek_project_task ã‚¹ã‚­ãƒ¼ãƒæƒ…å ± ===
  - geek_project_taskid (uniqueidentifier)
  - geek_name (string)
  - geek_priority (picklist)
  - geek_status (picklist)

  Choice: geek_priority
    0 : Critical
    1 : High
    2 : Medium
    3 : Low

  Choice: geek_status
    0 : Completed
    1 : InProgress
    2 : NotStarted
```

### **6.2 TypeScript ã‚¹ã‚­ãƒ¼ãƒå®šç¾©ã®ä½œæˆ**

```typescript
// src/types/dataverse.ts

/**
 * geek_project_task ãƒ†ãƒ¼ãƒ–ãƒ«
 * 
 * ã‚¹ã‚­ãƒ¼ãƒåè¦å‰‡:
 * - ãƒ†ãƒ¼ãƒ–ãƒ«è«–ç†å: geek_project_task (å°æ–‡å­—ã€ã‚¢ãƒ³ãƒ€ãƒ¼ã‚¹ã‚³ã‚¢)
 * - ä¸»ã‚­ãƒ¼: geek_project_taskid
 * - å±æ€§ãƒ—ãƒ¬ãƒ•ã‚£ãƒƒã‚¯ã‚¹: geek_
 */

// Choiceå€¤ã®å®šç¾©
export enum TaskPriority {
  Critical = 0,
  High = 1,
  Medium = 2,
  Low = 3
}

export enum TaskStatus {
  Completed = 0,
  InProgress = 1,
  NotStarted = 2
}

// ãƒ†ãƒ¼ãƒ–ãƒ«å‹å®šç¾©
export interface ProjectTask {
  geek_project_taskid?: string;  // ä¸»ã‚­ãƒ¼
  geek_name: string;              // å¿…é ˆ: ã‚¿ã‚¹ã‚¯å
  geek_priority: TaskPriority;    // Choice
  geek_status: TaskStatus;        // Choice
  geek_description?: string;      // ã‚ªãƒ—ã‚·ãƒ§ãƒ³
  geek_duedate?: Date;            // ã‚ªãƒ—ã‚·ãƒ§ãƒ³
}

// ä½œæˆãƒªã‚¯ã‚¨ã‚¹ãƒˆå‹
export interface CreateProjectTaskRequest {
  geek_name: string;
  geek_priority: TaskPriority;
  geek_status: TaskStatus;
  geek_description?: string;
  geek_duedate?: string; // ISO 8601å½¢å¼
}

// æ›´æ–°ãƒªã‚¯ã‚¨ã‚¹ãƒˆå‹
export interface UpdateProjectTaskRequest {
  geek_name?: string;
  geek_priority?: TaskPriority;
  geek_status?: TaskStatus;
  geek_description?: string;
  geek_duedate?: string;
}
```

### **6.3 ã‚«ã‚¹ã‚¿ãƒ ãƒ†ãƒ¼ãƒ–ãƒ«ç”¨ã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯**

```typescript
// src/hooks/useProjectTasks.ts
import { useState, useEffect, useCallback } from 'react';
import { usePowerPlatform } from '@microsoft/power-apps';
import { Geek_project_tasksService } from '../generated/services/Geek_project_tasksService';
import type { ProjectTask, CreateProjectTaskRequest, UpdateProjectTaskRequest } from '../types/dataverse';

export const useProjectTasks = () => {
  const { isInitialized } = usePowerPlatform();
  const [tasks, setTasks] = useState<ProjectTask[]>([]);
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState<string | null>(null);

  // å…¨ã‚¿ã‚¹ã‚¯å–å¾—
  const getAllTasks = useCallback(async () => {
    if (!isInitialized) return;

    try {
      setLoading(true);
      const result = await Geek_project_tasksService.getAll({
        select: ['geek_project_taskid', 'geek_name', 'geek_priority', 'geek_status', 'geek_duedate'],
        orderBy: 'geek_duedate asc',
        top: 100
      });

      if (result.isSuccess && result.value) {
        setTasks(result.value);
      } else {
        throw new Error('ã‚¿ã‚¹ã‚¯ã®å–å¾—ã«å¤±æ•—ã—ã¾ã—ãŸ');
      }
    } catch (err) {
      const errorMessage = err instanceof Error ? err.message : 'Unknown error';
      setError(errorMessage);
    } finally {
      setLoading(false);
    }
  }, [isInitialized]);

  // ã‚¿ã‚¹ã‚¯ä½œæˆ
  const createTask = useCallback(async (taskData: CreateProjectTaskRequest) => {
    if (!isInitialized) throw new Error('SDK not initialized');

    try {
      setLoading(true);
      const result = await Geek_project_tasksService.create(taskData);

      if (result.isSuccess && result.value) {
        await getAllTasks(); // ä¸€è¦§ã‚’å†å–å¾—
        return result.value;
      } else {
        throw new Error('ã‚¿ã‚¹ã‚¯ã®ä½œæˆã«å¤±æ•—ã—ã¾ã—ãŸ');
      }
    } catch (err) {
      const errorMessage = err instanceof Error ? err.message : 'Unknown error';
      setError(errorMessage);
      throw err;
    } finally {
      setLoading(false);
    }
  }, [isInitialized, getAllTasks]);

  // ã‚¿ã‚¹ã‚¯æ›´æ–°
  const updateTask = useCallback(async (taskId: string, taskData: UpdateProjectTaskRequest) => {
    if (!isInitialized) throw new Error('SDK not initialized');

    try {
      setLoading(true);
      const result = await Geek_project_tasksService.update(taskId, taskData);

      if (result.isSuccess && result.value) {
        await getAllTasks(); // ä¸€è¦§ã‚’å†å–å¾—
        return result.value;
      } else {
        throw new Error('ã‚¿ã‚¹ã‚¯ã®æ›´æ–°ã«å¤±æ•—ã—ã¾ã—ãŸ');
      }
    } catch (err) {
      const errorMessage = err instanceof Error ? err.message : 'Unknown error';
      setError(errorMessage);
      throw err;
    } finally {
      setLoading(false);
    }
  }, [isInitialized, getAllTasks]);

  // ã‚¿ã‚¹ã‚¯å‰Šé™¤
  const deleteTask = useCallback(async (taskId: string) => {
    if (!isInitialized) throw new Error('SDK not initialized');

    try {
      setLoading(true);
      const result = await Geek_project_tasksService.delete(taskId);

      if (result.isSuccess) {
        await getAllTasks(); // ä¸€è¦§ã‚’å†å–å¾—
      } else {
        throw new Error('ã‚¿ã‚¹ã‚¯ã®å‰Šé™¤ã«å¤±æ•—ã—ã¾ã—ãŸ');
      }
    } catch (err) {
      const errorMessage = err instanceof Error ? err.message : 'Unknown error';
      setError(errorMessage);
      throw err;
    } finally {
      setLoading(false);
    }
  }, [isInitialized, getAllTasks]);

  useEffect(() => {
    if (isInitialized) {
      getAllTasks();
    }
  }, [isInitialized, getAllTasks]);

  return { 
    tasks, 
    loading, 
    error, 
    getAllTasks,
    createTask, 
    updateTask, 
    deleteTask,
    isInitialized 
  };
};
```

---

## **ğŸ“‹ Step 7: ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°**

### **7.1 ã‚ˆãã‚ã‚‹ã‚¨ãƒ©ãƒ¼ã¨å¯¾ç­–**

| ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ | åŸå›  | å¯¾ç­– |
|----------------|------|------|
| `PowerDataRuntime is not initialized` | SDKæœªåˆæœŸåŒ– | `usePowerPlatform().isInitialized` ã‚’ç¢ºèª |
| `Connection not found` | æ¥ç¶šIDãŒç„¡åŠ¹ | Power Apps ãƒãƒ¼ã‚¿ãƒ«ã§æ¥ç¶šIDã‚’å†ç¢ºèª |
| `Table not found` | ãƒ†ãƒ¼ãƒ–ãƒ«è«–ç†åãŒé–“é•ã„ | customizations.xmlã§ã‚¹ã‚­ãƒ¼ãƒåã‚’ç¢ºèª |
| `Unauthorized` | æ¨©é™ä¸è¶³ | ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ­ãƒ¼ãƒ«ã‚’ç¢ºèª |
| `CORS error` | Web APIç›´æ¥å‘¼ã³å‡ºã— | Power Apps SDKçµŒç”±ã«å¤‰æ›´ |

### **7.2 ãƒ‡ãƒãƒƒã‚°ã®ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹**

```typescript
// IOperationResult ã‚’å¿…ãšç¢ºèª
const result = await SystemUsersService.getAll();

if (result.isSuccess) {
  console.log('æˆåŠŸ:', result.value);
} else {
  console.error('å¤±æ•—:', result.error);
  // error.message, error.code ãªã©ã‚’ç¢ºèª
}
```

---

## **ğŸ“‹ ã¾ã¨ã‚: ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹æ¥ç¶šãƒ•ãƒ­ãƒ¼**

1. **Power Apps ãƒãƒ¼ã‚¿ãƒ«ã§æ¥ç¶šä½œæˆ** â†’ èªè¨¼å®Œäº†
2. **ãƒ–ãƒ©ã‚¦ã‚¶URLã‹ã‚‰æ¥ç¶šIDå–å¾—** â†’ ã‚³ãƒ”ãƒ¼
3. **pac code add-data-source å®Ÿè¡Œ** â†’ ã‚µãƒ¼ãƒ“ã‚¹ã‚¯ãƒ©ã‚¹è‡ªå‹•ç”Ÿæˆ
4. **PowerDataRuntime åˆæœŸåŒ–ç¢ºèª** â†’ `isInitialized` ãƒã‚§ãƒƒã‚¯
5. **ã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯ä½œæˆ** â†’ ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ã‚’ã‚«ãƒ—ã‚»ãƒ«åŒ–
6. **Reactã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã§ä½¿ç”¨** â†’ UIå®Ÿè£…

**é‡è¦:** ã™ã¹ã¦ã®ãƒ‡ãƒ¼ã‚¿ã‚¢ã‚¯ã‚»ã‚¹ã¯ **Power Apps SDK çµŒç”±**ã§è¡Œã„ã€ä»–ã®æ¥ç¶šæ–¹æ³•ã¯ä½¿ç”¨ã—ãªã„ã§ãã ã•ã„ã€‚

---

### **æœªå®Ÿè£…æ©Ÿèƒ½é–‹ç™ºãƒ»ãƒ¦ãƒ¼ã‚¶ãƒ¼ææ¡ˆ**

**Dataverse ã‚³ãƒã‚¯ã‚¿ãƒ¼:**
```bash
# 1. Power Apps ã§æ¥ç¶šä½œæˆï¼ˆæ‰‹å‹•ï¼‰
# Power Apps Maker Portal (make.powerapps.com) ã§:
# a. ã€Œãƒ‡ãƒ¼ã‚¿ã€ > ã€Œæ¥ç¶šã€ > ã€Œ+ æ–°ã—ã„æ¥ç¶šã€
# b. ã€ŒMicrosoft Dataverseã€ã‚’é¸æŠ
# c. èªè¨¼å®Œäº†ã¨æ¥ç¶šç¢ºèª

# 2. æ¥ç¶šIDã‚’å–å¾—
# a. ä½œæˆã—ãŸæ¥ç¶šã‚’ã‚¯ãƒªãƒƒã‚¯
# b. ãƒ–ãƒ©ã‚¦ã‚¶ã®URLã‹ã‚‰æ¥ç¶šIDã‚’ã‚³ãƒ”ãƒ¼
# URLå½¢å¼: /connections/shared_commondataserviceforapps/{æ¥ç¶šID}/details

# 3. ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«æ¥ç¶šIDã‚’ç¢ºèª
# é–‹ç™ºæ™‚ã¯ä»¥ä¸‹ã‚’ç¢ºèª:
# - æ¥ç¶šID (GUIDå½¢å¼): a1b2c3d4-e5f6-7890-1234-567890abcdef

# 4. ã‚µãƒ¼ãƒ“ã‚¹ã‚¯ãƒ©ã‚¹ç”Ÿæˆ
pac code add-data-source -a "shared_commondataserviceforapps" -c "{æ¥ç¶šID}" -t "systemusers"
pac code add-data-source -a "shared_commondataserviceforapps" -c "{æ¥ç¶šID}" -t "accounts"

# 5. customizations.xml ã‹ã‚‰ã‚¹ã‚­ãƒ¼ãƒç¢ºèªï¼ˆã‚«ã‚¹ã‚¿ãƒ ãƒ†ãƒ¼ãƒ–ãƒ«ã®å ´åˆï¼‰
.\Extract-DataverseChoices.ps1 -XmlPath ".\customizations.xml" -EntityName "{è«–ç†å}"

# 6. ã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯ä½œæˆ
# src/hooks/useDataverse{TableName}.ts
# - {Prefix}_{TableName}Service ã‚’ä½¿ç”¨
# - CRUD æ“ä½œå®Ÿè£… (create, update, delete, get, getAll)
# - Choice ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®å‹ãƒãƒƒãƒ”ãƒ³ã‚°
# - usePowerPlatform().isInitialized ã§SDKåˆæœŸåŒ–ãƒã‚§ãƒƒã‚¯

# 7. ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‹ã‚‰ä½¿ç”¨
# const { tasks, createTask, updateTask, deleteTask } = useDataverse{TableName}();

# ã‚¹ã‚­ãƒ¼ãƒåã®ãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€ãƒ¼:
# - ã‚µãƒ¼ãƒ“ã‚¹ã‚¯ãƒ©ã‚¹: {Prefix}_{TableName}Service (ä¾‹: Geek_project_tasksService)
# - dataSourceName: {prefix}_{table_name} (ä¾‹: geek_project_tasks)
# - ãƒ—ãƒ©ã‚¤ãƒãƒªã‚­ãƒ¼: {prefix}_{table_name}id (ä¾‹: geek_project_taskid)

# æ¨™æº–ãƒ†ãƒ¼ãƒ–ãƒ«:
# - SystemUsers: systemusers (ãƒ¦ãƒ¼ã‚¶ãƒ¼ä¸€è¦§)
# - Accounts: accounts (å–å¼•å…ˆä¼æ¥­)
# - Contacts: contacts (å–å¼•å…ˆæ‹…å½“è€…)
```

**ä¸»è¦ãªãƒã‚¤ãƒ³ãƒˆ:**
- âœ… `pac code add-data-source` ã§è‡ªå‹•ç”Ÿæˆã•ã‚ŒãŸã‚µãƒ¼ãƒ“ã‚¹ã‚¯ãƒ©ã‚¹ã‚’ä½¿ç”¨
- âœ… ã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯ã§ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ã‚’ã‚«ãƒ—ã‚»ãƒ«åŒ–
- âœ… TypeScript å‹å®šç¾©ã§å‹å®‰å…¨æ€§ã‚’ç¢ºä¿
- âœ… IOperationResult ã® isSuccess ã§ã‚¨ãƒ©ãƒ¼ãƒã‚§ãƒƒã‚¯
- âŒ ç›´æ¥ `useConnector('office365users')` ã¯ä½¿ç”¨ã—ãªã„ (éæ¨å¥¨)

#### 2. æœªå®Ÿè£…æ©Ÿèƒ½ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¸ã®é–‹ç™ºææ¡ˆ
- å„ªå…ˆé †ä½ã®ææ¡ˆ
- å®Ÿè£…å·¥æ•°ã®è¦‹ç©ã‚‚ã‚Š
- æŠ€è¡“çš„åˆ¶ç´„ã®èª¬æ˜

### ğŸ¯ AIææ¡ˆä¾‹
- *"ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹æ¥ç¶šãŒå®Œäº†ã—ã¾ã—ãŸã€‚ã©ã®æœªå®Ÿè£…æ©Ÿèƒ½ã‹ã‚‰é–‹ç™ºã—ã¾ã™ã‹ï¼Ÿ"*
- *"æ©Ÿèƒ½æ‹¡å¼µãŒå®Œäº†ã—ã¾ã—ãŸã€‚æ¬¡ã®é–‹ç™ºã‚µã‚¤ã‚¯ãƒ«ã‚’é–‹å§‹ã—ã¾ã™ã‹ï¼Ÿ"*

### ğŸ” Phase 2 å®Œäº†æ™‚ã®ã‚¨ãƒ©ãƒ¼ãƒã‚§ãƒƒã‚¯ãƒ»ä¿®æ­£æ‰‹é †

#### 1. ãƒ©ãƒ³ã‚¿ã‚¤ãƒ ã‚¨ãƒ©ãƒ¼ãƒã‚§ãƒƒã‚¯
```pwsh
# ãƒ­ãƒ¼ã‚«ãƒ«å®Ÿè¡Œã§ã®å‹•ä½œç¢ºèª
npm run dev

# ãƒ–ãƒ©ã‚¦ã‚¶ã®é–‹ç™ºè€…ãƒ„ãƒ¼ãƒ«ã§ã‚¨ãƒ©ãƒ¼ç¢ºèª
# - Console ã‚¨ãƒ©ãƒ¼ã‚’ã™ã¹ã¦è§£æ¶ˆ
# - Network ã‚¿ãƒ–ã§ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚¨ãƒ©ãƒ¼ç¢ºèª
# - PowerProvider åˆæœŸåŒ–ãƒ­ã‚°ç¢ºèª
```

#### 2. æ©Ÿèƒ½å‹•ä½œãƒ†ã‚¹ãƒˆ
```pwsh
# åŸºæœ¬æ©Ÿèƒ½ã®ãƒ†ã‚¹ãƒˆæ‰‹é †
# 1. ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®èª­ã¿è¾¼ã¿ç¢ºèª
# 2. ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³å‹•ä½œç¢ºèª  
# 3. UI ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆè¡¨ç¤ºç¢ºèª
# 4. Power Platform SDK åˆæœŸåŒ–ç¢ºèª
```

#### 3. ãƒ‡ãƒ—ãƒ­ã‚¤å‰ãƒã‚§ãƒƒã‚¯
```pwsh
# æœ¬ç•ªãƒ“ãƒ«ãƒ‰ã‚¨ãƒ©ãƒ¼ãƒã‚§ãƒƒã‚¯
npm run build

# dist ãƒ•ã‚©ãƒ«ãƒ€ã®ç”Ÿæˆç¢ºèª
# - index.html ã®å­˜åœ¨ç¢ºèª
# - assets ãƒ•ã‚©ãƒ«ãƒ€ã®ç¢ºèª
# - ç›¸å¯¾ãƒ‘ã‚¹è¨­å®šã®ç¢ºèª
```

#### 4. Power Apps ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ†ã‚¹ãƒˆ
```pwsh
# Power Appsç’°å¢ƒã¸ã®å®‰å…¨ãªãƒ‡ãƒ—ãƒ­ã‚¤
pac code push

# ãƒ‡ãƒ—ãƒ­ã‚¤å¾Œã®å‹•ä½œç¢ºèª
# - Power Apps URL ã§ã®ã‚¢ã‚¯ã‚»ã‚¹ç¢ºèª
# - ãƒ­ãƒ¼ã‚«ãƒ«ã¨åŒã˜å‹•ä½œç¢ºèª
# - ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°ç¢ºèª
```

#### âœ… Phase 2 å®Œäº†ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ
- [ ] ãƒ­ãƒ¼ã‚«ãƒ«å®Ÿè¡Œ: æ­£å¸¸å‹•ä½œ
- [ ] ãƒ–ãƒ©ã‚¦ã‚¶Console: ã‚¨ãƒ©ãƒ¼ãªã—  
- [ ] åŸºæœ¬æ©Ÿèƒ½: ã™ã¹ã¦å‹•ä½œ
- [ ] æœ¬ç•ªãƒ“ãƒ«ãƒ‰: æˆåŠŸ
- [ ] Power Apps ãƒ‡ãƒ—ãƒ­ã‚¤: æˆåŠŸ
- [ ] æœ¬ç•ªç’°å¢ƒ: æ­£å¸¸å‹•ä½œ

**AIææ¡ˆ**: *"Phase 2ã®MVPãŒæ­£å¸¸ã«å‹•ä½œã—ã¦ã„ã¾ã™ã€‚æ©Ÿèƒ½æ‹¡å¼µãƒ»ãƒ‡ãƒ¼ã‚¿çµ±åˆã‚’é–‹å§‹ã—ã¾ã™ã‹ï¼Ÿ"*

### âš ï¸ ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°
- "fetching your app"ã§åœæ­¢ã™ã‚‹å ´åˆ:
  1. `npm run build`ã®å®Ÿè¡Œç¢ºèª
  2. PowerProvider.tsxã®ã‚¨ãƒ©ãƒ¼ç¢ºèª  
  3. ç’°å¢ƒã®å¿…è¦ã‚³ãƒã‚¯ã‚¿ãƒ¼æœ‰åŠ¹åŒ–ç¢ºèª

---

### **AI ææ¡ˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ**

#### **Phase 1: åˆæœŸã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—**
```
âœ… ç’°å¢ƒæ§‹ç¯‰ãŒå®Œäº†ã—ã¾ã—ãŸï¼
ğŸ¯ æ¬¡ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³: PowerProviderå®Ÿè£…
ğŸ“ èª¬æ˜: Power Apps SDKã¨ã®æ¥ç¶šã‚’ç¢ºç«‹ã—ã¾ã™
â“ PowerProviderå®Ÿè£…ã‚’é–‹å§‹ã—ã¾ã™ã‹ï¼Ÿ
```

### ğŸ¨ **Code Apps ãƒ­ã‚´ãƒ»ã‚¢ã‚¤ã‚³ãƒ³çµ±åˆ**

#### **ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ­ã‚´è¨­è¨ˆ**

é–‹ç™ºãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆç”¨ã«æœ€é©åŒ–ã•ã‚ŒãŸCode Appsãƒ­ã‚´ã‚’æä¾›ï¼š

```
assets/
â”œâ”€â”€ logo.svg          # ãƒ¡ã‚¤ãƒ³ãƒ­ã‚´ (64x64)
â”œâ”€â”€ favicon.svg       # ãƒ•ã‚¡ãƒ“ã‚³ãƒ³ (32x32)
â””â”€â”€ logo-variants/    # ã‚µã‚¤ã‚ºåˆ¥ãƒãƒªã‚¨ãƒ¼ã‚·ãƒ§ãƒ³
```

**ãƒ­ã‚´ã®æ§‹æˆè¦ç´ :**
- ğŸ”µ **Microsoft ãƒ–ãƒ«ãƒ¼èƒŒæ™¯** (`#0078D4`) - Power Platform ä¸€è²«æ€§
- âš¡ **ãƒ©ã‚¤ãƒˆãƒ‹ãƒ³ã‚°ã‚¢ã‚¤ã‚³ãƒ³** - Power Apps ã®è±¡å¾´
- `< >` **ã‚³ãƒ¼ãƒ‰æ‹¬å¼§** - é–‹ç™ºãƒ»Code Apps ã‚¢ã‚¤ãƒ‡ãƒ³ãƒ†ã‚£ãƒ†ã‚£
- âš™ï¸ **ã‚®ã‚¢ã‚¢ã‚¤ã‚³ãƒ³** - ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³æ©Ÿèƒ½
- **"CA"ãƒ†ã‚­ã‚¹ãƒˆ** - Code Apps ç•¥ç§°

#### **MVPãƒ•ã‚§ãƒ¼ã‚ºã§ã®åˆ©ç”¨**

**1. pac code init ã§ã®è‡ªå‹•è¨­å®š**
```bash
# ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆåˆæœŸåŒ–æ™‚ã«ãƒ­ã‚´ã‚’æŒ‡å®š
pac code init --displayName "My Code App" -l "./assets/logo.svg"

# power.config.json ã«è‡ªå‹•ç™»éŒ²
{
  "appInfo": {
    "displayName": "My Code App",
    "logoPath": "./assets/logo.svg"
  }
}
```

**2. Vite ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ã®çµ±åˆ**
```typescript
// vite.config.ts
export default defineConfig({
  // ãƒ•ã‚¡ãƒ“ã‚³ãƒ³è¨­å®š
  publicDir: 'public',
  // ...
});
```

```html
<!-- public/index.html -->
<head>
  <link rel="icon" type="image/svg+xml" href="/assets/favicon.svg">
  <title>My Code App</title>
</head>
```

**3. React ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã§ã®åˆ©ç”¨**
```typescript
// src/components/AppHeader.tsx
import React from 'react';

export const AppHeader: React.FC = () => {
  return (
    <header className="flex items-center gap-3 p-4 bg-blue-600 text-white">
      <img 
        src="/assets/logo.svg" 
        alt="Code App Logo" 
        className="w-8 h-8"
      />
      <h1 className="text-xl font-semibold">My Code App</h1>
    </header>
  );
};
```

#### **ãƒ–ãƒ©ãƒ³ãƒ‡ã‚£ãƒ³ã‚°çµ±åˆãƒ‘ã‚¿ãƒ¼ãƒ³**

**4. TailwindCSS ãƒ†ãƒ¼ãƒé€£æº**
```javascript
// tailwind.config.js
module.exports = {
  theme: {
    extend: {
      colors: {
        'code-apps': {
          primary: '#0078D4',    // ãƒ­ã‚´ãƒ¡ã‚¤ãƒ³ã‚«ãƒ©ãƒ¼
          secondary: '#005A9E',  // ãƒ­ã‚´ãƒœãƒ¼ãƒ€ãƒ¼
          accent: '#FFD700',     // ãƒ©ã‚¤ãƒˆãƒ‹ãƒ³ã‚°
        }
      }
    }
  }
}
```

**5. Loading Spinner ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚º**
```typescript
// src/components/LoadingSpinner.tsx
import React from 'react';

export const LoadingSpinner: React.FC = () => {
  return (
    <div className="flex flex-col items-center justify-center p-8">
      <div className="relative">
        <img 
          src="/assets/logo.svg" 
          alt="Loading..." 
          className="w-16 h-16 animate-pulse"
        />
        <div className="absolute inset-0 border-4 border-code-apps-primary border-t-transparent rounded-full animate-spin"></div>
      </div>
      <p className="mt-4 text-code-apps-primary font-medium">Loading Code App...</p>
    </div>
  );
};
```

#### **Power Apps å…¬é–‹æ™‚ã®æœ€é©åŒ–**

**6. ãƒãƒ‹ãƒ•ã‚§ã‚¹ãƒˆæœ€é©åŒ–**
```json
// power.config.json (è‡ªå‹•ç”Ÿæˆãƒ»å‚è€ƒ)
{
  "appInfo": {
    "displayName": "My Code App",
    "description": "Modern Code App built with React + TailwindCSS",
    "logoPath": "./assets/logo.svg",
    "version": "1.0.0"
  },
  "branding": {
    "primaryColor": "#0078D4",
    "accentColor": "#FFD700"
  }
}
```

**7. 404ãƒ»ã‚¨ãƒ©ãƒ¼ãƒšãƒ¼ã‚¸çµ±åˆ**
```typescript
// src/pages/ErrorPage.tsx
import React from 'react';

export const ErrorPage: React.FC<{ error: string }> = ({ error }) => {
  return (
    <div className="min-h-screen flex flex-col items-center justify-center bg-gray-50">
      <img 
        src="/assets/logo.svg" 
        alt="Code App" 
        className="w-24 h-24 mb-6 opacity-50"
      />
      <h1 className="text-2xl font-bold text-gray-800 mb-2">æ¥ç¶šã‚¨ãƒ©ãƒ¼</h1>
      <p className="text-gray-600 mb-6 text-center max-w-md">
        {error}
      </p>
      <button 
        onClick={() => window.location.reload()}
        className="px-6 py-2 bg-code-apps-primary text-white rounded-lg hover:bg-code-apps-secondary transition-colors"
      >
        å†è©¦è¡Œ
      </button>
    </div>
  );
};
```

#### **é–‹ç™ºãƒ•ãƒ­ãƒ¼ã§ã®è‡ªå‹•çµ±åˆ**

MVPãƒ•ã‚§ãƒ¼ã‚ºã§æ—¢ã«åˆ©ç”¨å¯èƒ½ã«ã™ã‚‹ãŸã‚ã®è¨­å®šï¼š

```bash
# 1. ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä½œæˆæ™‚
# Microsoftå…¬å¼æ‰‹é †æº–æ‹ 
mkdir C:\CodeApps -Force
cd C:\CodeApps
npm create vite@latest AppFromScratch -- --template react-ts
cd C:\CodeApps\AppFromScratch
npm install
npm i --save-dev @types/node

# 2. ã‚¢ã‚»ãƒƒãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªä½œæˆã¨ãƒ­ã‚´é…ç½®
mkdir -p public/assets
# ãƒ­ã‚´ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚³ãƒ”ãƒ¼

# 3. Code Apps åˆæœŸåŒ–ï¼ˆãƒ­ã‚´ä»˜ãï¼‰
pac code init --displayName "My Code App" -l "./public/assets/logo.svg"

# 4. é–‹ç™ºé–‹å§‹
npm run dev
```

ã“ã‚Œã«ã‚ˆã‚Šã€MVPãƒ•ã‚§ãƒ¼ã‚ºã®é–‹å§‹æ™‚ç‚¹ã§æ—¢ã«ãƒ—ãƒ­ãƒ•ã‚§ãƒƒã‚·ãƒ§ãƒŠãƒ«ãªãƒ­ã‚´ã¨ãƒ–ãƒ©ãƒ³ãƒ‡ã‚£ãƒ³ã‚°ãŒçµ±åˆã•ã‚ŒãŸçŠ¶æ…‹ã§Code Appsã®é–‹ç™ºã‚’é–‹å§‹ã§ãã¾ã™ã€‚

#### **Phase 2: MVPé–‹ç™º**
```
âœ… PowerProviderå®Ÿè£…ãŒå®Œäº†ã—ã¾ã—ãŸï¼
ğŸ¯ æ¬¡ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³: åŸºæœ¬UIæ§‹ç¯‰
ğŸ“ èª¬æ˜: shadcn/ui + TailwindCSSã§ãƒ¢ãƒ€ãƒ³ãªUIã‚’ä½œæˆã—ã¾ã™
â“ åŸºæœ¬ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã¨ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’ä½œæˆã—ã¾ã™ã‹ï¼Ÿ
```

#### **Phase 3: å‹•ä½œæ¤œè¨¼**
```
âœ… åŸºæœ¬UIæ§‹ç¯‰ãŒå®Œäº†ã—ã¾ã—ãŸï¼
ğŸ¯ æ¬¡ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³: ãƒ­ãƒ¼ã‚«ãƒ«å®Ÿè¡Œãƒ†ã‚¹ãƒˆ
ğŸ“ èª¬æ˜: é–‹ç™ºç’°å¢ƒã§ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ãƒ†ã‚¹ãƒˆã—ã¾ã™
â“ ãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒã§ã‚¢ãƒ—ãƒªã‚’å®Ÿè¡Œã—ã¾ã™ã‹ï¼Ÿ
```

#### **Phase 4: ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆ**
```
âœ… ãƒ­ãƒ¼ã‚«ãƒ«ãƒ†ã‚¹ãƒˆãŒæˆåŠŸã—ã¾ã—ãŸï¼
ğŸ¯ æ¬¡ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³: Power Appsç’°å¢ƒã¸ãƒ‡ãƒ—ãƒ­ã‚¤
ğŸ“ èª¬æ˜: æœ¬ç•ªç’°å¢ƒã§Code Appsã¨ã—ã¦å…¬é–‹ã—ã¾ã™
â“ Power Appsç’°å¢ƒã«ãƒ‡ãƒ—ãƒ­ã‚¤ã—ã¾ã™ã‹ï¼Ÿ
```

#### **Phase 5: æ©Ÿèƒ½æ‹¡å¼µé¸æŠ**
```
ğŸ‰ MVPå®Œäº†ãŠã‚ã§ã¨ã†ã”ã–ã„ã¾ã™ï¼
ğŸ¯ æ¬¡ã®æ©Ÿèƒ½æ‹¡å¼µã‚’é¸æŠã—ã¦ãã ã•ã„:

1ï¸âƒ£ Office 365 Usersçµ±åˆ (é›£æ˜“åº¦: æ˜“ã€æ™‚é–“: 30åˆ†)
   â†’ ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ã€ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«è¡¨ç¤ºã€çµ„ç¹”éšå±¤

2ï¸âƒ£ Dataverseçµ±åˆ (é›£æ˜“åº¦: ä¸­ã€æ™‚é–“: 1-2æ™‚é–“)  
   â†’ ãƒ‡ãƒ¼ã‚¿æ°¸ç¶šåŒ–ã€CRUDæ“ä½œã€ãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³

3ï¸âƒ£ Azure SQLçµ±åˆ (é›£æ˜“åº¦: é«˜ã€æ™‚é–“: 2-4æ™‚é–“)
   â†’ æ—¢å­˜ã‚·ã‚¹ãƒ†ãƒ çµ±åˆã€é«˜æ€§èƒ½ã‚¯ã‚¨ãƒª

â“ ã©ã®æ©Ÿèƒ½ã‚’å®Ÿè£…ã—ã¾ã™ã‹ï¼Ÿ
```

#### **Phase 6: ç¶™ç¶šé–‹ç™º**
```
âœ… [é¸æŠã—ãŸæ©Ÿèƒ½]ã®çµ±åˆãŒå®Œäº†ã—ã¾ã—ãŸï¼
ğŸ¯ æ¨å¥¨ã•ã‚Œã‚‹æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—:

â€¢ ğŸ”§ è¿½åŠ æ©Ÿèƒ½é–‹ç™º (ä»–ã®ã‚³ãƒã‚¯ã‚¿ãƒ¼çµ±åˆ)
â€¢ ğŸ§ª ãƒ†ã‚¹ãƒˆè‡ªå‹•åŒ– (å“è³ªå‘ä¸Š)  
â€¢ ğŸš€ CI/CDãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ (è‡ªå‹•ãƒ‡ãƒ—ãƒ­ã‚¤)
â€¢ ğŸ“Š ç›£è¦–ãƒ»ãƒ­ã‚°å®Ÿè£… (é‹ç”¨æœ€é©åŒ–)

â“ æ¬¡ã¯ã©ã®é ˜åŸŸã‚’å¼·åŒ–ã—ã¾ã™ã‹ï¼Ÿ
```

### **ã‚¹ã‚­ãƒ«ãƒ¬ãƒ™ãƒ«åˆ¥æ¨å¥¨ãƒ‘ã‚¹**

#### **åˆå¿ƒè€…å‘ã‘ (Beginner Path)**
```
1. ç’°å¢ƒæ§‹ç¯‰ â†’ PowerProvider â†’ åŸºæœ¬UI â†’ ãƒ­ãƒ¼ã‚«ãƒ«ãƒ†ã‚¹ãƒˆ â†’ ãƒ‡ãƒ—ãƒ­ã‚¤
2. Office 365 Usersçµ±åˆ (æœ€ã‚‚ç°¡å˜)
3. åŸºæœ¬çš„ãªãƒ†ã‚¹ãƒˆè¿½åŠ 
4. æ®µéšçš„ãªæ©Ÿèƒ½æ‹¡å¼µ
```

#### **ä¸­ç´šè€…å‘ã‘ (Intermediate Path)**  
```
1. æ¨™æº–MVPé–‹ç™º
2. Dataverseçµ±åˆ + CRUDæ“ä½œ
3. TanStack Queryå®Ÿè£…
4. è‡ªå‹•ãƒ†ã‚¹ãƒˆ + CI/CD
```

#### **ä¸Šç´šè€…å‘ã‘ (Advanced Path)**
```
1. é«˜é€ŸMVPé–‹ç™º
2. è¤‡æ•°ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹çµ±åˆ (Dataverse + Azure SQL)
3. é«˜åº¦ãªã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ãƒ‘ã‚¿ãƒ¼ãƒ³
4. æœ¬æ ¼çš„ãªé‹ç”¨ç›£è¦–å®Ÿè£…
```

### **é€²æ—è¿½è·¡ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹**

é–‹ç™ºçŠ¶æ…‹ã‚’è¿½è·¡ã—ã€é©åˆ‡ãªææ¡ˆã‚’è¡Œã†ãŸã‚ã®æ§‹é€ ï¼š

```typescript
interface ProjectProgress {
  // ç¾åœ¨ã®é–‹ç™ºæ®µéš
  currentPhase: 'setup' | 'mvp' | 'integration' | 'optimization' | 'production';
  
  // å®Œäº†ã—ãŸé …ç›®
  completedSteps: {
    environmentSetup: boolean;
    powerProviderImpl: boolean;
    basicUI: boolean;
    localTesting: boolean;
    powerAppsDeployment: boolean;
    dataIntegration: DataIntegrationType[];
    testAutomation: boolean;
    cicdSetup: boolean;
  };
  
  // é–‹ç™ºè€…ã‚¹ã‚­ãƒ«ãƒ¬ãƒ™ãƒ«
  developerLevel: 'beginner' | 'intermediate' | 'advanced';
  
  // åˆ©ç”¨å¯èƒ½æ™‚é–“
  availableTime: 'quick' | 'standard' | 'extended';
  
  // æ¨å¥¨ã™ã‚‹æ¬¡ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³
  recommendedActions: NextActionSuggestion[];
}

interface NextActionSuggestion {
  id: string;
  title: string;
  description: string;
  difficulty: 'easy' | 'medium' | 'hard';
  estimatedTime: string;
  prerequisites: string[];
  benefits: string[];
  implementationGuide: string;
}
```

ã“ã‚Œã«ã‚ˆã‚Šã€AIã¯é–‹ç™ºè€…ã®ç¾åœ¨ã®çŠ¶æ³ã‚’æ­£ç¢ºã«æŠŠæ¡ã—ã€æœ€é©ãªæ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—ã‚’ææ¡ˆã§ãã¾ã™ã€‚

#### ğŸ¯ å®Ÿéš›ã®çµ±åˆæ–¹å¼ (Microsoft å…¬å¼)
1. **Power Platform SDK åˆæœŸåŒ–** (`@microsoft/power-apps/app` ã® `initialize()`)
2. **é™çš„ãƒ‡ãƒ¼ã‚¿é–‹ç™º** (UI/UX å…ˆè¡Œé–‹ç™º)
3. **ã‚³ãƒã‚¯ã‚¿çµ±åˆ** (`connector()` é–¢æ•°ã§ãƒ‡ãƒ¼ã‚¿æ¥ç¶š)
4. **ãƒ­ãƒ¼ã‚«ãƒ«é–‹ç™º** (`pac code run` ã§ãƒ†ã‚¹ãƒˆ)
5. **Power Apps ãƒ‡ãƒ—ãƒ­ã‚¤** (`pac code push` ã§å…¬é–‹)

#### ğŸ“‹ å®Ÿè£…è¦ä»¶

**1. Power Platform SDK åˆæœŸåŒ–**
- `@microsoft/power-apps` ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ä½¿ç”¨
- `initialize()` é–¢æ•°ã§ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ åˆæœŸåŒ–ã®ã¿
- **èªè¨¼ã¯ Power Platform ãŒè‡ªå‹•å‡¦ç†** (ã‚«ã‚¹ã‚¿ãƒ èªè¨¼ã‚³ãƒ¼ãƒ‰ä¸è¦)

**2. é™çš„ãƒ‡ãƒ¼ã‚¿ã«ã‚ˆã‚‹é–‹ç™º**
- ã¾ãš `src/data/` ã«é™çš„ãƒ‡ãƒ¼ã‚¿ã‚’é…ç½®
- UI/UX ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’å®Ÿè£…
- å®Ÿãƒ‡ãƒ¼ã‚¿çµ±åˆå‰ã«ãƒ¦ãƒ¼ã‚¶ãƒ“ãƒªãƒ†ã‚£æ¤œè¨¼

**3. ãƒ‡ãƒ¼ã‚¿æ¥ç¶š (æ®µéšçš„ç§»è¡Œ)**
- ç¬¬1æ®µéš: é™çš„ãƒ‡ãƒ¼ã‚¿ (`const assets`)
- ç¬¬2æ®µéš: `connector()` é–¢æ•°ã§ Power Platform ã‚³ãƒã‚¯ã‚¿çµ±åˆ
- Office 365ã€SQL Databaseã€SharePoint ç­‰ã®æ¨™æº–ã‚³ãƒã‚¯ã‚¿åˆ©ç”¨

**4. èªè¨¼ãƒ»ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£**
- **ã‚«ã‚¹ã‚¿ãƒ èªè¨¼å®Ÿè£…ã¯ä¸è¦**
- Power Platform ç’°å¢ƒãŒå…¨èªè¨¼ã‚’å‡¦ç†
- ã‚¢ãƒ—ãƒªã¯èªè¨¼æ¸ˆã¿ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¨ã—ã¦å‹•ä½œ
- ãƒ‡ãƒ¼ã‚¿ã‚¢ã‚¯ã‚»ã‚¹æ¨©é™ã¯ Power Platform ã‚³ãƒã‚¯ã‚¿ãŒåˆ¶å¾¡

**5. é–‹ç™ºãƒ»ãƒ‡ãƒ—ãƒ­ã‚¤**
- ãƒ­ãƒ¼ã‚«ãƒ«: `npm run dev` (Vite + pac code run ã®åŒæ™‚èµ·å‹•)
- æœ¬ç•ª: `pac code push` ã§ Power Apps ç’°å¢ƒã«ãƒ‡ãƒ—ãƒ­ã‚¤
- **Azure Functions ã‚„ App Service ã¯ä¸è¦**

### MVP å®Ÿè£…ã‚¬ã‚¤ãƒ‰

#### Step 1: ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆåˆæœŸåŒ–

**å®Ÿè£…é …ç›®ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ:**
- [ ] React + TypeScript ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä½œæˆ
- [ ] `@microsoft/power-apps` SDK ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
- [ ] PowerProvider ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆå®Ÿè£…
- [ ] åŸºæœ¬çš„ãª React ã‚¢ãƒ—ãƒªæ§‹é€ ä½œæˆ
- [ ] ãƒ­ãƒ¼ã‚«ãƒ«é–‹ç™ºç’°å¢ƒè¨­å®š

**PowerProvider å®Ÿè£…ä¾‹ (Microsoft å…¬å¼ãƒ‘ã‚¿ãƒ¼ãƒ³):**
```typescript
// src/PowerProvider.tsx
import { initialize } from "@microsoft/power-apps/app";
import { useEffect, type ReactNode } from "react";

interface PowerProviderProps {
    children: ReactNode;
}

export default function PowerProvider({ children }: PowerProviderProps) {
    useEffect(() => {
        const initApp = async () => {
            try {
                await initialize();
                console.log('Power Platform SDK initialized successfully');
            } catch (error) {
                console.error('Failed to initialize Power Platform SDK:', error);
            }
        };
        
        initApp();
    }, []);

    return <>{children}</>;
}
```

**é‡è¦**: ã“ã‚Œã¯ Microsoft ã®å…¬å¼ã‚µãƒ³ãƒ—ãƒ«ã§ä½¿ã‚ã‚Œã¦ã„ã‚‹æ¨™æº–ãƒ‘ã‚¿ãƒ¼ãƒ³ã§ã™ã€‚ã‚«ã‚¹ã‚¿ãƒ èªè¨¼ã‚„è¿½åŠ ã®ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã¯ä¸è¦ã§ã™ã€‚

**ãƒ¡ã‚¤ãƒ³ã‚¢ãƒ—ãƒªåˆæœŸåŒ– (Microsoft å…¬å¼ãƒ‘ã‚¿ãƒ¼ãƒ³):**
```typescript
// src/main.tsx
import { createRoot } from 'react-dom/client';
import App from './App.tsx';
import './index.css';
import { StrictMode } from 'react';
import PowerProvider from './PowerProvider.tsx';

createRoot(document.getElementById("root")!).render(
  <StrictMode>
    <PowerProvider>
      <App />
    </PowerProvider>
  </StrictMode>
);
```

**App.tsx ã®å®Ÿè£…ä¾‹:**
```typescript
// src/App.tsx  
import { Toaster } from "@/components/ui/toaster";
import { Toaster as Sonner } from "@/components/ui/sonner";
import { TooltipProvider } from "@/components/ui/tooltip";
import { QueryClient, QueryClientProvider } from "@tanstack/react-query";
import Index from "./pages/Index";

const queryClient = new QueryClient();

const App = () => (
  <QueryClientProvider client={queryClient}>
    <TooltipProvider>
      <Toaster />
      <Sonner />
      <Index />
    </TooltipProvider>
  </QueryClientProvider>
);

export default App;
```

**é‡è¦**: 
- PowerProvider ã¯æœ€å¤–å´ã§ SDK ã‚’åˆæœŸåŒ–
- App.tsx ã§ UI ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã¨ã‚¯ã‚¨ãƒªã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆè¨­å®š
- pages/Index.tsx ã§ãƒ¡ã‚¤ãƒ³æ©Ÿèƒ½å®Ÿè£…

## ğŸ“Š ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹æ¥ç¶š (æ®µéšçš„é–‹ç™ºã‚¢ãƒ—ãƒ­ãƒ¼ãƒ)

> **å‚è€ƒ**: Microsoft [FluentSample](https://github.com/microsoft/PowerAppsCodeApps/blob/main/samples/FluentSample/README.md) å…¬å¼ãƒ‘ã‚¿ãƒ¼ãƒ³

### ğŸš€ **3æ®µéšé–‹ç™ºãƒ•ãƒ­ãƒ¼**

```mermaid
graph LR
    A[1. Mockãƒ‡ãƒ¼ã‚¿é–‹ç™º] --> B[2. Power Platformæ¥ç¶šä½œæˆ]
    B --> C[3. ãƒªã‚¢ãƒ«ãƒ‡ãƒ¼ã‚¿çµ±åˆ]
    C --> D[Power Apps ãƒ‡ãƒ—ãƒ­ã‚¤]
    
    subgraph "ãƒ­ãƒ¼ã‚«ãƒ«é–‹ç™º"
        A
    end
    
    subgraph "Power Platform"
        B
        D
    end
    
    subgraph "çµ±åˆãƒ†ã‚¹ãƒˆ"
        C
    end
```

### ğŸ—ï¸ **Phase 1: Mockãƒ‡ãƒ¼ã‚¿ã§é–‹ç™ºé–‹å§‹**

#### **1.1 Mockãƒ‡ãƒ¼ã‚¿æ§‹é€ è¨­è¨ˆ**

**Office 365 Users Mock ãƒ‡ãƒ¼ã‚¿ä¾‹ (Microsoftå…¬å¼ã‚¹ã‚­ãƒ¼ãƒæº–æ‹ ):**
```typescript
// src/mockData/office365Data.ts
// Microsoft FluentSampleæº–æ‹ ã®Office 365 Userã‚¹ã‚­ãƒ¼ãƒ
export interface User {
  Id: string;
  AccountEnabled: boolean;
  BusinessPhones: string[];
  City: string;
  CompanyName: string;
  Country: string;
  Department: string;
  DisplayName: string;
  GivenName: string;
  JobTitle: string;
  Mail: string;
  MailNickname: string;
  mobilePhone?: string;
  OfficeLocation: string;
  PostalCode: string;
  Surname: string;
  TelephoneNumber: string;
  UserPrincipalName: string;
}

export const mockUsers: User[] = [
  {
    Id: "550e8400-e29b-41d4-a716-446655440001",
    AccountEnabled: true,
    BusinessPhones: ["+81-3-1234-5678"],
    City: "æ±äº¬",
    CompanyName: "ã‚³ãƒ³ãƒˆã‚½æ ªå¼ä¼šç¤¾",
    Country: "æ—¥æœ¬",
    Department: "ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ãƒªãƒ³ã‚°",
    DisplayName: "ç”°ä¸­ å¤ªéƒ",
    GivenName: "å¤ªéƒ",
    JobTitle: "ã‚·ãƒ‹ã‚¢ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢",
    Mail: "tanaka.taro@contoso.co.jp",
    MailNickname: "tarot",
    mobilePhone: "+81-90-1234-5678",
    OfficeLocation: "æ±äº¬ã‚ªãƒ•ã‚£ã‚¹ 3éš",
    PostalCode: "100-0001",
    Surname: "ç”°ä¸­",
    TelephoneNumber: "+81-3-1234-5678",
    UserPrincipalName: "tanaka.taro@contoso.co.jp"
  },
  {
    Id: "550e8400-e29b-41d4-a716-446655440002",
    AccountEnabled: true,
    BusinessPhones: ["+81-6-9876-5432"],
    City: "å¤§é˜ª",
    CompanyName: "ã‚³ãƒ³ãƒˆã‚½æ ªå¼ä¼šç¤¾",
    Country: "æ—¥æœ¬",
    Department: "ãƒ—ãƒ­ãƒ€ã‚¯ãƒˆç®¡ç†",
    DisplayName: "ä½è—¤ èŠ±å­",
    GivenName: "èŠ±å­",
    JobTitle: "ã‚·ãƒ‹ã‚¢ãƒ—ãƒ­ãƒ€ã‚¯ãƒˆãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼",
    Mail: "sato.hanako@contoso.co.jp",
    MailNickname: "hanakos",
    mobilePhone: "+81-90-9876-5432",
    OfficeLocation: "å¤§é˜ªã‚ªãƒ•ã‚£ã‚¹ 5éš",
    PostalCode: "530-0001",
    Surname: "ä½è—¤",
    TelephoneNumber: "+81-6-9876-5432",
    UserPrincipalName: "sato.hanako@contoso.co.jp"
  },
  {
    Id: "550e8400-e29b-41d4-a716-446655440003",
    AccountEnabled: true,
    BusinessPhones: ["+81-52-1111-2222"],
    City: "åå¤å±‹",
    CompanyName: "ã‚³ãƒ³ãƒˆã‚½æ ªå¼ä¼šç¤¾",
    Country: "æ—¥æœ¬",
    Department: "ãƒ‡ã‚¶ã‚¤ãƒ³",
    DisplayName: "å±±ç”° æ¬¡éƒ",
    GivenName: "æ¬¡éƒ",
    JobTitle: "ãƒ—ãƒªãƒ³ã‚·ãƒ‘ãƒ«UXãƒ‡ã‚¶ã‚¤ãƒŠãƒ¼",
    Mail: "yamada.jiro@contoso.co.jp",
    MailNickname: "jiroy",
    mobilePhone: "+81-90-1111-2222",
    OfficeLocation: "åå¤å±‹ã‚ªãƒ•ã‚£ã‚¹ 2éš",
    PostalCode: "460-0001",
    Surname: "å±±ç”°",
    TelephoneNumber: "+81-52-1111-2222",
    UserPrincipalName: "yamada.jiro@contoso.co.jp"
  },
  {
    Id: "550e8400-e29b-41d4-a716-446655440004",
    AccountEnabled: true,
    BusinessPhones: ["+81-45-3333-4444"],
    City: "æ¨ªæµœ",
    CompanyName: "ã‚³ãƒ³ãƒˆã‚½æ ªå¼ä¼šç¤¾",
    Country: "æ—¥æœ¬",
    Department: "ãƒãƒ¼ã‚±ãƒ†ã‚£ãƒ³ã‚°",
    DisplayName: "éˆ´æœ¨ ç¾å’²",
    GivenName: "ç¾å’²",
    JobTitle: "ãƒãƒ¼ã‚±ãƒ†ã‚£ãƒ³ã‚°ãƒ‡ã‚£ãƒ¬ã‚¯ã‚¿ãƒ¼",
    Mail: "suzuki.misaki@contoso.co.jp",
    MailNickname: "misakis",
    mobilePhone: "+81-90-3333-4444",
    OfficeLocation: "æ¨ªæµœã‚ªãƒ•ã‚£ã‚¹ 4éš",
    PostalCode: "220-0001",
    Surname: "éˆ´æœ¨",
    TelephoneNumber: "+81-45-3333-4444",
    UserPrincipalName: "suzuki.misaki@contoso.co.jp"
  },
  {
    Id: "550e8400-e29b-41d4-a716-446655440005",
    AccountEnabled: false, // ç„¡åŠ¹ã‚¢ã‚«ã‚¦ãƒ³ãƒˆä¾‹
    BusinessPhones: ["+81-75-5555-6666"],
    City: "äº¬éƒ½",
    CompanyName: "ã‚³ãƒ³ãƒˆã‚½æ ªå¼ä¼šç¤¾",
    Country: "æ—¥æœ¬",
    Department: "äººäº‹",
    DisplayName: "é«˜æ©‹ å¥å¤ª",
    GivenName: "å¥å¤ª",
    JobTitle: "HRãƒ“ã‚¸ãƒã‚¹ãƒ‘ãƒ¼ãƒˆãƒŠãƒ¼",
    Mail: "takahashi.kenta@contoso.co.jp",
    MailNickname: "kentat",
    mobilePhone: "+81-90-5555-6666",
    OfficeLocation: "äº¬éƒ½ã‚ªãƒ•ã‚£ã‚¹ 1éš",
    PostalCode: "600-0001",
    Surname: "é«˜æ©‹",
    TelephoneNumber: "+81-75-5555-6666",
    UserPrincipalName: "takahashi.kenta@contoso.co.jp"
  }
];

// Microsoftå…¬å¼æº–æ‹ ã®ãƒ˜ãƒ«ãƒ‘ãƒ¼é–¢æ•°
export const getUserById = (id: string): User | undefined => {
  return mockUsers.find(user => user.Id === id);
};

export const searchUsers = (query: string, top: number = 50): User[] => {
  if (!query.trim()) {
    return [];
  }
  
  const lowercaseQuery = query.toLowerCase();
  const filtered = mockUsers.filter(user => 
    user.DisplayName?.toLowerCase().includes(lowercaseQuery) ||
    user.Mail?.toLowerCase().includes(lowercaseQuery) ||
    user.Department?.toLowerCase().includes(lowercaseQuery) ||
    user.JobTitle?.toLowerCase().includes(lowercaseQuery) ||
    user.GivenName?.toLowerCase().includes(lowercaseQuery) ||
    user.Surname?.toLowerCase().includes(lowercaseQuery)
  );
  
  return filtered.slice(0, top);
};

export const getUsersByDepartment = (department: string): User[] => {
  return mockUsers.filter(user => user.Department === department);
};

// ç¾åœ¨ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ (MyProfileæ©Ÿèƒ½ç”¨)
export const mockCurrentUser: User = mockUsers[0];

// ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã‚¤ãƒ™ãƒ³ãƒˆã¨ãƒ¡ãƒ¼ãƒ«ç”¨ã®è¿½åŠ ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹
export interface CalendarEvent {
  id: string;
  subject: string;
  start: {
    dateTime: string;
    timeZone: string;
  };
  end: {
    dateTime: string;
    timeZone: string;
  };
  organizer: {
    emailAddress: {
      name: string;
      address: string;
    };
  };
  attendees?: Array<{
    emailAddress: {
      name: string;
      address: string;
    };
    type: string;
  }>;
}

export const mockCalendarEvents: CalendarEvent[] = [
  {
    id: "event-001",
    subject: "é€±æ¬¡ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä¼šè­°",
    start: { dateTime: "2025-10-16T10:00:00", timeZone: "Asia/Tokyo" },
    end: { dateTime: "2025-10-16T11:00:00", timeZone: "Asia/Tokyo" },
    organizer: { 
      emailAddress: { 
        name: "ç”°ä¸­ å¤ªéƒ", 
        address: "tanaka.taro@contoso.co.jp" 
      }
    },
    attendees: [
      {
        emailAddress: { name: "ä½è—¤ èŠ±å­", address: "sato.hanako@contoso.co.jp" },
        type: "required"
      },
      {
        emailAddress: { name: "å±±ç”° æ¬¡éƒ", address: "yamada.jiro@contoso.co.jp" },
        type: "optional"
      }
    ]
  },
  {
    id: "event-002",
    subject: "ãƒ‡ã‚¶ã‚¤ãƒ³ãƒ¬ãƒ“ãƒ¥ãƒ¼",
    start: { dateTime: "2025-10-17T14:00:00", timeZone: "Asia/Tokyo" },
    end: { dateTime: "2025-10-17T15:30:00", timeZone: "Asia/Tokyo" },
    organizer: { 
      emailAddress: { 
        name: "å±±ç”° æ¬¡éƒ", 
        address: "yamada.jiro@contoso.co.jp" 
      }
    }
  }
];

export interface Email {
  id: string;
  subject: string;
  from: {
    emailAddress: {
      name: string;
      address: string;
    };
  };
  receivedDateTime: string;
  bodyPreview: string;
  isRead: boolean;
  importance: 'low' | 'normal' | 'high';
}

export const mockEmails: Email[] = [
  {
    id: "email-001",
    subject: "ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆé€²æ—ãƒ¬ãƒãƒ¼ãƒˆ",
    from: {
      emailAddress: {
        name: "ä½è—¤ èŠ±å­",
        address: "sato.hanako@contoso.co.jp"
      }
    },
    receivedDateTime: "2025-10-16T08:30:00Z",
    bodyPreview: "ä»Šé€±ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆé€²æ—ã‚’ãŠçŸ¥ã‚‰ã›ã—ã¾ã™ã€‚ä¸»è¦ãªãƒã‚¤ãƒ«ã‚¹ãƒˆãƒ¼ãƒ³ã¯äºˆå®šé€šã‚Š...",
    isRead: false,
    importance: 'high'
  },
  {
    id: "email-002", 
    subject: "æ¥é€±ã®ä¼šè­°å®¤äºˆç´„ã«ã¤ã„ã¦",
    from: {
      emailAddress: {
        name: "éˆ´æœ¨ ç¾å’²",
        address: "suzuki.misaki@contoso.co.jp"
      }
    },
    receivedDateTime: "2025-10-16T09:15:00Z",
    bodyPreview: "æ¥é€±ã®ä¼šè­°å®¤äºˆç´„çŠ¶æ³ã‚’ã”ç¢ºèªãã ã•ã„...",
    isRead: true,
    importance: 'normal'
  }
];
```

**SQL Database Mock ãƒ‡ãƒ¼ã‚¿ä¾‹:**
```typescript
// src/mockData/sqlData.ts
export interface Project {
  Id: number;
  Name: string;
  Description?: string;
  Status: 'Planning' | 'Active' | 'On Hold' | 'Completed' | 'Cancelled';
  Priority: 'Low' | 'Medium' | 'High' | 'Critical';
  CreatedDate: string;
  DueDate?: string;
  AssignedTo?: number;
  Budget?: number;
}

export const mockProjects: Project[] = [
  {
    Id: 1,
    Name: "Webã‚µã‚¤ãƒˆãƒªãƒ‹ãƒ¥ãƒ¼ã‚¢ãƒ«",
    Description: "ä¼æ¥­ã‚µã‚¤ãƒˆã®ãƒ¢ãƒ€ãƒ³åŒ–ã¨UI/UXæ”¹å–„",
    Status: "Active",
    Priority: "High", 
    CreatedDate: "2025-10-01T09:00:00Z",
    DueDate: "2025-12-31T17:00:00Z",
    Budget: 5000000
  },
  {
    Id: 2,
    Name: "ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ç§»è¡Œ",
    Description: "ãƒ¬ã‚¬ã‚·ãƒ¼ã‚·ã‚¹ãƒ†ãƒ ã®ã‚¯ãƒ©ã‚¦ãƒ‰ç§»è¡Œ",
    Status: "Planning",
    Priority: "Critical",
    CreatedDate: "2025-10-15T14:30:00Z",
    Budget: 8000000
  }
];

export interface Task {
  Id: number;
  ProjectId: number;
  Title: string;
  Description?: string;
  Priority: 'Low' | 'Medium' | 'High';
  Status: 'Todo' | 'InProgress' | 'Review' | 'Done';
  AssignedTo?: number;
  CreatedDate: string;
}

export const mockTasks: Task[] = [
  {
    Id: 1,
    ProjectId: 1,
    Title: "è¦ä»¶å®šç¾©æ›¸ä½œæˆ",
    Description: "æ–°ã—ã„Webã‚µã‚¤ãƒˆã®è¦ä»¶ã‚’è©³ç´°ã«å®šç¾©",
    Priority: "High",
    Status: "InProgress", 
    AssignedTo: 1,
    CreatedDate: "2025-10-02T10:00:00Z"
  }
];
```

#### **1.2 Mockãƒ‡ãƒ¼ã‚¿ã‚’ä½¿ç”¨ã—ãŸã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆå®Ÿè£…**

```typescript
// src/pages/Office365Page.tsx (Mockç‰ˆ)
import React, { useState, useEffect } from 'react';
import { mockUsers, mockCalendarEvents, UserProfile } from '../mockData/office365Data';

export const Office365Page: React.FC = () => {
  const [users, setUsers] = useState<UserProfile[]>([]);
  const [loading, setLoading] = useState(true);

  useEffect(() => {
    // Mockãƒ‡ãƒ¼ã‚¿ãƒ­ãƒ¼ãƒ‰ï¼ˆå®Ÿéš›ã®APIå‘¼ã³å‡ºã—ã‚’ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ãƒˆï¼‰
    const loadMockData = async () => {
      setLoading(true);
      await new Promise(resolve => setTimeout(resolve, 500)); // é…å»¶ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ãƒˆ
      setUsers(mockUsers);
      setLoading(false);
    };

    loadMockData();
  }, []);

  if (loading) return <div>Loading users...</div>;

  return (
    <div className="p-6">
      <h1 className="text-2xl font-bold mb-4">Office 365 Users (Mock Data)</h1>
      <div className="grid gap-4">
        {users.map(user => (
          <div key={user.id} className="border rounded-lg p-4 bg-white shadow">
            <h3 className="font-semibold">{user.displayName}</h3>
            <p className="text-gray-600">{user.jobTitle}</p>
            <p className="text-sm text-gray-500">{user.mail}</p>
          </div>
        ))}
      </div>
    </div>
  );
};
```

#### **1.3 ãƒ­ãƒ¼ã‚«ãƒ«ãƒ“ãƒ«ãƒ‰ãƒ»å®Ÿè¡Œãƒ†ã‚¹ãƒˆ**

```bash
# ä¾å­˜é–¢ä¿‚ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
npm install

# ãƒ“ãƒ«ãƒ‰å®Ÿè¡Œ
npm run build

# ãƒ­ãƒ¼ã‚«ãƒ«é–‹ç™ºã‚µãƒ¼ãƒãƒ¼èµ·å‹•
npm run dev

# âœ… Mockãƒ‡ãƒ¼ã‚¿ã§ã®å‹•ä½œç¢ºèª
# - UIè¡¨ç¤ºç¢ºèª
# - ãƒ‡ãƒ¼ã‚¿æ§‹é€ æ¤œè¨¼  
# - ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ç¢ºèª
```

### ğŸ“‹ **ã‚µãƒãƒ¼ãƒˆã•ã‚Œã¦ã„ã‚‹ã‚³ãƒã‚¯ã‚¿ãƒ¼ (Microsoft å…¬å¼)**

- âœ… **Office 365 Users** - ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ãƒ»çµ„ç¹”æƒ…å ±
- âœ… **Office 365 Outlook** - ãƒ¡ãƒ¼ãƒ«ãƒ»ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ãƒ»é€£çµ¡å…ˆ
- âœ… **SQL Server / Azure SQL** - ãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒŠãƒ«ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹
- âœ… **SharePoint** - ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆãƒ»ãƒªã‚¹ãƒˆç®¡ç†  
- âœ… **Dataverse** - Power Platform ãƒã‚¤ãƒ†ã‚£ãƒ–ãƒ‡ãƒ¼ã‚¿
- âœ… **Microsoft Teams** - ãƒãƒ¼ãƒ ãƒ»ãƒãƒ£ãƒ³ãƒãƒ«æƒ…å ±
- âœ… **OneDrive for Business** - ãƒ•ã‚¡ã‚¤ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸

### ï¿½ **Phase 2: Power Platform æ¥ç¶šä½œæˆ**

> **å‰æ**: Mockãƒ‡ãƒ¼ã‚¿ã§ã®å‹•ä½œç¢ºèªãŒå®Œäº†ã—ã¦ã„ã‚‹ã“ã¨

#### **2.1 Power Apps æ¥ç¶šãƒšãƒ¼ã‚¸ã§ã®è¨­å®š**

**æ¥ç¶šä½œæˆæ‰‹é †:**
```bash
# 1. Power Apps Maker Portal ã«ã‚¢ã‚¯ã‚»ã‚¹
https://make.powerapps.com/

# 2. å·¦ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ã€Œãƒ‡ãƒ¼ã‚¿ã€â†’ã€Œæ¥ç¶šã€
# 3. ã€Œ+ æ–°ã—ã„æ¥ç¶šã€ã‚’ã‚¯ãƒªãƒƒã‚¯
```

#### **2.2 Office 365 Users æ¥ç¶šä½œæˆ**

```bash
# Power Apps UI ã§ã®æ“ä½œ:
1. ã€ŒOffice 365 Usersã€ã‚’æ¤œç´¢ãƒ»é¸æŠ
2. ã€Œä½œæˆã€ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯  
3. Microsoft ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã§ã‚µã‚¤ãƒ³ã‚¤ãƒ³
4. ã‚¢ã‚¯ã‚»ã‚¹è¨±å¯ã‚’æ‰¿èª
5. æ¥ç¶šã®ä½œæˆå®Œäº†ã‚’ç¢ºèª

# âœ… æˆåŠŸæ™‚ã®ç¢ºèªäº‹é …:
# - æ¥ç¶šä¸€è¦§ã«ã€ŒOffice 365 Usersã€ãŒè¡¨ç¤ºã•ã‚Œã‚‹
# - çŠ¶æ…‹ãŒã€Œæ¥ç¶šæ¸ˆã¿ã€ã«ãªã£ã¦ã„ã‚‹
```

#### **2.3 SQL Server æ¥ç¶šä½œæˆ (ã‚ªãƒ—ã‚·ãƒ§ãƒ³)**

**å‰ææ¡ä»¶:**
- Azure SQL Database ã¾ãŸã¯ SQL Server ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹
- ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹æ¨©é™
- ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯æ¥ç¶šæ€§ (ãƒ•ã‚¡ã‚¤ã‚¢ã‚¦ã‚©ãƒ¼ãƒ«è¨­å®š)

```bash
# Power Apps UI ã§ã®æ“ä½œ:
1. ã€ŒSQL Serverã€ã‚’æ¤œç´¢ãƒ»é¸æŠ
2. èªè¨¼æ–¹æ³•ã‚’é¸æŠ:
   âœ… Azure ADçµ±åˆèªè¨¼ (æ¨å¥¨)
   âš ï¸ SQL Serverèªè¨¼
   âš ï¸ Windowsèªè¨¼

3. æ¥ç¶šæƒ…å ±ã‚’å…¥åŠ›:
   ã‚µãƒ¼ãƒãƒ¼å: your-server.database.windows.net
   ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹å: YourAppDatabase
   
4. ã€Œä½œæˆã€ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦æ¥ç¶šãƒ†ã‚¹ãƒˆ
5. æˆåŠŸæ™‚ã¯æ¥ç¶šä¸€è¦§ã«è¡¨ç¤ºã•ã‚Œã‚‹
```

**å¿…è¦ãªSQL ã‚¹ã‚­ãƒ¼ãƒä¾‹:**
```sql
-- Projects ãƒ†ãƒ¼ãƒ–ãƒ« (å¿…é ˆ)
CREATE TABLE [dbo].[Projects](
    [Id] [int] IDENTITY(1,1) NOT NULL PRIMARY KEY,
    [Name] [nvarchar](255) NOT NULL,
    [Description] [nvarchar](max) NULL,
    [Status] [nvarchar](50) NOT NULL DEFAULT ('Planning'),
    [Priority] [nvarchar](20) NOT NULL DEFAULT ('Medium'),
    [CreatedDate] [datetime2](7) NOT NULL DEFAULT (getutcdate()),
    [DueDate] [datetime2](7) NULL,
    [Budget] [decimal](18, 2) NULL,
    [AssignedTo] [int] NULL,
    
    -- åˆ¶ç´„
    CONSTRAINT [CK_Projects_Status] CHECK ([Status] IN ('Planning', 'Active', 'On Hold', 'Completed', 'Cancelled')),
    CONSTRAINT [CK_Projects_Priority] CHECK ([Priority] IN ('Low', 'Medium', 'High', 'Critical'))
);

-- Tasks ãƒ†ãƒ¼ãƒ–ãƒ« (ã‚ªãƒ—ã‚·ãƒ§ãƒ³)
CREATE TABLE [dbo].[Tasks](
    [Id] [int] IDENTITY(1,1) NOT NULL PRIMARY KEY,
    [ProjectId] [int] NOT NULL,
    [Title] [nvarchar](255) NOT NULL,
    [Description] [nvarchar](max) NULL,
    [Priority] [nvarchar](20) NOT NULL DEFAULT ('Medium'),
    [Status] [nvarchar](50) NOT NULL DEFAULT ('Todo'),
    [AssignedTo] [int] NULL,
    [CreatedDate] [datetime2](7) NOT NULL DEFAULT (getutcdate()),
    
    FOREIGN KEY ([ProjectId]) REFERENCES [dbo].[Projects]([Id]),
    CONSTRAINT [CK_Tasks_Priority] CHECK ([Priority] IN ('Low', 'Medium', 'High')),
    CONSTRAINT [CK_Tasks_Status] CHECK ([Status] IN ('Todo', 'InProgress', 'Review', 'Done'))
);

-- ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿æŒ¿å…¥
INSERT INTO [dbo].[Projects] ([Name], [Description], [Status], [Priority], [Budget]) VALUES
('Webã‚µã‚¤ãƒˆãƒªãƒ‹ãƒ¥ãƒ¼ã‚¢ãƒ«', 'ä¼æ¥­ã‚µã‚¤ãƒˆã®ãƒ¢ãƒ€ãƒ³åŒ–', 'Active', 'High', 5000000),
('ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ç§»è¡Œ', 'ã‚¯ãƒ©ã‚¦ãƒ‰ç§»è¡Œãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ', 'Planning', 'Critical', 8000000);
```

#### **2.4 Dataverse æ¥ç¶šä½œæˆ (æ¨å¥¨)**

```bash
# Power Apps UI ã§ã®æ“ä½œ:
1. ã€ŒMicrosoft Dataverseã€ã‚’æ¤œç´¢ãƒ»é¸æŠ
2. ã€Œä½œæˆã€ã‚’ã‚¯ãƒªãƒƒã‚¯ (èªè¨¼ã¯è‡ªå‹•)
3. ç’°å¢ƒã®Dataverseã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã«è‡ªå‹•æ¥ç¶š

# âœ… è‡ªå‹•ã§åˆ©ç”¨å¯èƒ½: 
# - æ¨™æº–ãƒ†ãƒ¼ãƒ–ãƒ« (Account, Contact, Userç­‰)
# - ã‚«ã‚¹ã‚¿ãƒ ãƒ†ãƒ¼ãƒ–ãƒ«ä½œæˆå¯èƒ½
# - Power Platform ãƒã‚¤ãƒ†ã‚£ãƒ–çµ±åˆ
```

**æ¨å¥¨ Dataverse ãƒ†ãƒ¼ãƒ–ãƒ«æ§‹é€ :**
```bash
# Power Apps UI ã§ã‚«ã‚¹ã‚¿ãƒ ãƒ†ãƒ¼ãƒ–ãƒ«ä½œæˆ:
1. ã€Œãƒ†ãƒ¼ãƒ–ãƒ«ã€â†’ã€Œ+ æ–°ã—ã„ãƒ†ãƒ¼ãƒ–ãƒ«ã€
2. ãƒ†ãƒ¼ãƒ–ãƒ«å: "Projects" 
3. åˆ—ã®è¿½åŠ :
   - Name (å˜ä¸€è¡Œãƒ†ã‚­ã‚¹ãƒˆ, å¿…é ˆ)
   - Description (è¤‡æ•°è¡Œãƒ†ã‚­ã‚¹ãƒˆ)  
   - Status (é¸æŠè‚¢: Planning/Active/OnHold/Completed)
   - Priority (é¸æŠè‚¢: Low/Medium/High/Critical)
   - DueDate (æ—¥ä»˜ã®ã¿)
   - Budget (é€šè²¨)

4. ã€Œä¿å­˜ã€ã—ã¦ãƒ†ãƒ¼ãƒ–ãƒ«ä½œæˆå®Œäº†
```

## ğŸ”§ **Dataverseæ¥ç¶šè¨­å®šæ‰‹é †ã¨ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°**

### **ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹è¿½åŠ ã®æ­£ã—ã„æ‰‹é †**

#### **Step 1: ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹è¿½åŠ **
```powershell
# Dataverseãƒ†ãƒ¼ãƒ–ãƒ«ã‚’è¿½åŠ 
pac code add-data-source -a dataverse -t your_table_name

# ä¾‹: ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ†ãƒ¼ãƒ–ãƒ«ã‚’è¿½åŠ 
pac code add-data-source -a dataverse -t geek_projecrt
```

#### **Step 2: ç”Ÿæˆãƒ•ã‚¡ã‚¤ãƒ«ã®ç¢ºèªã¨ä¿®æ­£**

âš ï¸ **é‡è¦ãªå•é¡Œ**: `pac code add-data-source`ã§ç”Ÿæˆã•ã‚ŒãŸã‚µãƒ¼ãƒ“ã‚¹ãƒ•ã‚¡ã‚¤ãƒ«ã®`dataSourceName`ãŒ`______`ï¼ˆã‚¢ãƒ³ãƒ€ãƒ¼ã‚¹ã‚³ã‚¢ï¼‰ã«ãªã‚Šã€å®Ÿéš›ã®ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹åã«ãƒãƒƒãƒ”ãƒ³ã‚°ã•ã‚Œãªã„å•é¡ŒãŒã‚ã‚Šã¾ã™ã€‚

**å•é¡Œã®ã‚ã‚‹ã‚³ãƒ¼ãƒ‰ (è‡ªå‹•ç”Ÿæˆ):**
```typescript
// src/generated/services/Geek_projecrtsService.ts
export class Geek_projecrtsService {
  private static readonly dataSourceName = '______';  // â† å•é¡Œ
  // ...
}
```

**æ­£ã—ã„ä¿®æ­£ (æ‰‹å‹•):**
```typescript
// src/generated/services/Geek_projecrtsService.ts  
export class Geek_projecrtsService {
  private static readonly dataSourceName = 'geek_projecrts';  // â† ä¿®æ­£
  // ...
}
```

#### **Step 3: dataSourcesInfoã¨ã®æ•´åˆæ€§ç¢ºèª**

ç”Ÿæˆã•ã‚ŒãŸãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹åã¯`dataSourcesInfo`ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ã‚­ãƒ¼åã¨ä¸€è‡´ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ï¼š

```typescript
// .power/appschemas/dataSourcesInfo.ts
export const dataSourcesInfo = {
  "geek_projecrts": {              // â† ã‚µãƒ¼ãƒ“ã‚¹ãƒ•ã‚¡ã‚¤ãƒ«ã§ä½¿ç”¨ã™ã‚‹åå‰
    "tableId": "",
    "version": "",
    "primaryKey": "geek_projecrtid",
    "dataSourceType": "Dataverse",
    "apis": {}
  },
  "office365users": { ... }
}
```

### **ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã‚¬ã‚¤ãƒ‰**

#### **ã‚¨ãƒ©ãƒ¼ 1: Data source not found**
```
âŒ ã‚¨ãƒ©ãƒ¼: Dataverse API call failed: Error: Retrieve multiple records operation failed: 
Data source not found: ______
```

**åŸå› **: ã‚µãƒ¼ãƒ“ã‚¹ãƒ•ã‚¡ã‚¤ãƒ«ã®`dataSourceName`ãŒæ­£ã—ããªã„

**è§£æ±ºæ–¹æ³•**:
1. ç”Ÿæˆã•ã‚ŒãŸã‚µãƒ¼ãƒ“ã‚¹ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç¢ºèª
2. `dataSourceName`ã‚’`dataSourcesInfo`ã®ã‚­ãƒ¼åã«ä¿®æ­£
3. ãƒ“ãƒ«ãƒ‰ã¨å†ãƒ‡ãƒ—ãƒ­ã‚¤

#### **ã‚¨ãƒ©ãƒ¼ 2: SDKåˆæœŸåŒ–å‰ã®ã‚³ãƒã‚¯ã‚¿ãƒ¼ä½¿ç”¨**
```
âŒ ã‚¨ãƒ©ãƒ¼: Cannot read properties of undefined (reading 'getRecords')
```

**åŸå› **: Power Apps SDKåˆæœŸåŒ–å‰ã«Dataverseã‚³ãƒã‚¯ã‚¿ãƒ¼ã‚’ä½¿ç”¨

**è§£æ±ºæ–¹æ³•**: SDKåˆæœŸåŒ–ç¢ºèªãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’ä½¿ç”¨
```typescript
import { usePowerPlatform } from '@microsoft/power-apps';

export function DataverseComponent() {
  const { isInitialized } = usePowerPlatform();
  
  useEffect(() => {
    if (isInitialized) {
      loadDataverseData();  // âœ… åˆæœŸåŒ–å¾Œã«å®Ÿè¡Œ
    }
  }, [isInitialized]);
  
  if (!isInitialized) {
    return <div>Power PlatformåˆæœŸåŒ–ä¸­...</div>;
  }
  
  return <YourComponent />;
}
```

#### **ã‚¨ãƒ©ãƒ¼ 3: èªè¨¼ã‚¨ãƒ©ãƒ¼**
```
âŒ ã‚¨ãƒ©ãƒ¼: Unauthorized access to Dataverse
```

**è§£æ±ºæ–¹æ³•**:
1. Power Platformç’°å¢ƒã®æ¨©é™ç¢ºèª
2. Dataverseæ¥ç¶šã®å†èªè¨¼
3. ç’°å¢ƒå¤‰æ•°ã®ç¢ºèª

### **å‹•ä½œç¢ºèªæ–¹æ³•**

#### **æˆåŠŸãƒ‘ã‚¿ãƒ¼ãƒ³**
```
âœ… ãƒ–ãƒ©ã‚¦ã‚¶ã‚³ãƒ³ã‚½ãƒ¼ãƒ«å‡ºåŠ›:
ğŸ“¡ Calling Geek_projecrtsService.getAll()...
ğŸ“¦ Dataverse getAll result: { success: true, dataLength: 5 }
```

#### **ãƒ‡ãƒãƒƒã‚°æ‰‹é †**
```typescript
// ãƒ‡ãƒãƒƒã‚°ç”¨ã‚³ãƒ³ã‚½ãƒ¼ãƒ«å‡ºåŠ›
console.log('ğŸ“¡ Calling Geek_projecrtsService.getAll()...');
const result = await Geek_projecrtsService.getAll();
console.log('ğŸ“¦ Dataverse getAll result:', { 
  success: result !== null, 
  dataLength: result?.length || 0 
});
```

### **å†ç”Ÿæˆæ™‚ã®æ³¨æ„äº‹é …**

âš ï¸ **é‡è¦**: `pac code add-data-source`ã‚’å†å®Ÿè¡Œã™ã‚‹ã¨ã€æ‰‹å‹•ä¿®æ­£ãŒ**ä¸Šæ›¸ã**ã•ã‚Œã¾ã™ã€‚

**å¯¾å‡¦æ³•**:
1. å†ç”Ÿæˆå¾Œã«å¿…ãšã‚µãƒ¼ãƒ“ã‚¹ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç¢ºèª
2. `dataSourceName`ã‚’æ­£ã—ã„å€¤ã«å†ä¿®æ­£
3. ãƒãƒ¼ãƒ é–‹ç™ºæ™‚ã¯ä¿®æ­£æ‰‹é †ã‚’ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆåŒ–

**ä¿®æ­£ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ**:
- [ ] `Geek_projecrtsService.ts`ã®`dataSourceName`ä¿®æ­£
- [ ] `dataSourcesInfo.ts`ã¨ã®æ•´åˆæ€§ç¢ºèª  
- [ ] ãƒ“ãƒ«ãƒ‰ã‚¨ãƒ©ãƒ¼ãªã—
- [ ] ãƒ–ãƒ©ã‚¦ã‚¶ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã§ã®å‹•ä½œç¢ºèª

### ğŸ” **æ¥ç¶šç¢ºèªã¨ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿å–å¾—**

#### **PAC CLI ã«ã‚ˆã‚‹æ¥ç¶šä¸€è¦§ç¢ºèª:**
```bash
# èªè¨¼ç¢ºèª
pac auth list

# ç’°å¢ƒé¸æŠ  
pac env select --environment [Environment-URL]

# æ¥ç¶šä¸€è¦§è¡¨ç¤º
pac connection list

# å‡ºåŠ›ä¾‹:
# â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
# â”‚ Display Name                    â”‚ API Name              â”‚ Connection Id                    â”‚  
# â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
# â”‚ Office 365 Users               â”‚ shared_office365users â”‚ 12345678-abcd-efgh-ijkl-mnopqrst â”‚
# â”‚ Microsoft Dataverse            â”‚ shared_commondataserv â”‚ 87654321-zyxw-vuts-rqpo-nmlkjihg â”‚
# â”‚ SQL Server                     â”‚ shared_sql            â”‚ abcdef12-3456-7890-abcd-ef1234567890 â”‚
# â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### **2.2 Power Apps UIã«ã‚ˆã‚‹æ¥ç¶šIDå–å¾—ï¼ˆå¿…é ˆæ‰‹é †ï¼‰**

> **âš ï¸ é‡è¦**: `pac code add-data-source` ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã«ã¯ã€**æ¥ç¶šIDï¼ˆConnection IDï¼‰** ãŒå¿…è¦ã§ã™ã€‚ä»¥ä¸‹ã®æ‰‹é †ã§å–å¾—ã—ã¦ãã ã•ã„ã€‚

**æ‰‹é † 1: Power Apps ãƒãƒ¼ã‚¿ãƒ«ã§æ¥ç¶šã‚’æ‰‹å‹•ä½œæˆ**

```bash
# Power Apps Maker Portal (make.powerapps.com) ã«ã‚¢ã‚¯ã‚»ã‚¹
# 1. å·¦ãƒ¡ãƒ‹ãƒ¥ãƒ¼ > ã€Œãƒ‡ãƒ¼ã‚¿ã€ > ã€Œæ¥ç¶šã€ã‚’ã‚¯ãƒªãƒƒã‚¯
# 2. ã€Œ+ æ–°ã—ã„æ¥ç¶šã€ã‚’ã‚¯ãƒªãƒƒã‚¯
# 3. æ¥ç¶šã—ãŸã„ã‚³ãƒã‚¯ã‚¿ãƒ¼ã‚’é¸æŠ:
#    - Dataverse (Microsoft Dataverse)
#    - Office 365 Users
#    - SQL Server
#    ãªã©
# 4. èªè¨¼æƒ…å ±ã‚’å…¥åŠ›ã—ã¦æ¥ç¶šã‚’ä½œæˆ
# 5. ã€Œæ¥ç¶šã®ä½œæˆãŒå®Œäº†ã—ã¾ã—ãŸã€ã‚’ç¢ºèª
```

**æ‰‹é † 2: æ¥ç¶šIDã‚’URLã‹ã‚‰å–å¾—**

```bash
# Power Apps ãƒãƒ¼ã‚¿ãƒ«ã§ã®æ“ä½œ:
# 1. ã€Œãƒ‡ãƒ¼ã‚¿ã€ > ã€Œæ¥ç¶šã€ ä¸€è¦§ã§ç›®çš„ã®æ¥ç¶šã‚’ã‚¯ãƒªãƒƒã‚¯
# 2. ãƒ–ãƒ©ã‚¦ã‚¶ã®ã‚¢ãƒ‰ãƒ¬ã‚¹ãƒãƒ¼ã®URLã‚’ç¢ºèª
# 3. URLã‹ã‚‰æ¥ç¶šIDã‚’ã‚³ãƒ”ãƒ¼

# URLå½¢å¼:
https://make.powerapps.com/environments/{ç’°å¢ƒID}/connections/{APIå}/{æ¥ç¶šID}/details

# ä¾‹ (Dataverseã®å ´åˆ):
https://make.powerapps.com/environments/12345678-abcd-1234-efgh-123456789abc/connections/shared_commondataserviceforapps/a1b2c3d4e5f6g7h8i9j0k1l2m3n4o5p6/details

# ã“ã®å ´åˆã®æ¥ç¶šID:
a1b2c3d4e5f6g7h8i9j0k1l2m3n4o5p6
```

**æ‰‹é † 3: APIåã¨æ¥ç¶šIDã‚’è¨˜éŒ²**

```bash
# å–å¾—ã™ã‚‹æƒ…å ±:
# - APIå: shared_commondataserviceforapps (Dataverseã®å ´åˆ)
# - æ¥ç¶šID: a1b2c3d4e5f6g7h8i9j0k1l2m3n4o5p6 (ä¾‹)

# ã‚³ãƒã‚¯ã‚¿ãƒ¼åˆ¥ã®APIå:
# - Dataverse: shared_commondataserviceforapps
# - Office 365 Users: shared_office365users
# - SQL Server: shared_sql
# - SharePoint: shared_sharepointonline
# - Outlook: shared_office365outlook
```

**æ‰‹é † 4: ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«æ¥ç¶šæƒ…å ±ã‚’ç¢ºèª**

é–‹ç™ºæ™‚ã«ã¯ã€ä»¥ä¸‹ã‚’ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ç¢ºèªã—ã¦ãã ã•ã„:

```markdown
## æ¥ç¶šæƒ…å ±ã®ç¢ºèª

ä»¥ä¸‹ã®æƒ…å ±ã‚’æä¾›ã—ã¦ãã ã•ã„:

### Dataverse æ¥ç¶š
1. Power Apps ãƒãƒ¼ã‚¿ãƒ« (make.powerapps.com) ã«ã‚¢ã‚¯ã‚»ã‚¹
2. ã€Œãƒ‡ãƒ¼ã‚¿ã€ > ã€Œæ¥ç¶šã€ > ã€ŒMicrosoft Dataverseã€ã‚’é¸æŠ
3. ãƒ–ãƒ©ã‚¦ã‚¶ã®URLã‹ã‚‰æ¥ç¶šIDã‚’ã‚³ãƒ”ãƒ¼
4. æ¥ç¶šID: [ã“ã“ã«è²¼ã‚Šä»˜ã‘]

### æ¥ç¶šIDå–å¾—ã®ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆ
[ãƒ–ãƒ©ã‚¦ã‚¶ã®URLãƒãƒ¼ã®ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆã‚’æ·»ä»˜]
```

**æ‰‹é † 5: pac code add-data-source ã‚³ãƒãƒ³ãƒ‰å®Ÿè¡Œ**

```bash
# å–å¾—ã—ãŸæ¥ç¶šIDã‚’ä½¿ç”¨ã—ã¦ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ã‚’è¿½åŠ 

# Dataverse ã®å ´åˆ:
pac code add-data-source -a "shared_commondataserviceforapps" -c "a1b2c3d4e5f6g7h8i9j0k1l2m3n4o5p6"

# Office 365 Users ã®å ´åˆ:
pac code add-data-source -a "shared_office365users" -c "æ¥ç¶šID"

# SQL Server ã®å ´åˆ:
pac code add-data-source -a "shared_sql" -c "æ¥ç¶šID"
```

**æ‰‹é † 6: Dataverse ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’è¿½åŠ **

Dataverse ã®å ´åˆã€ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’æŒ‡å®šã—ã¦è¿½åŠ ã™ã‚‹ã“ã¨ã‚‚å¯èƒ½ã§ã™:

```bash
# SystemUsers ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’è¿½åŠ 
pac code add-data-source -a "shared_commondataserviceforapps" -c "æ¥ç¶šID" -t "systemusers"

# ã‚«ã‚¹ã‚¿ãƒ ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’è¿½åŠ 
pac code add-data-source -a "shared_commondataserviceforapps" -c "æ¥ç¶šID" -t "geek_project_task"

# Accounts (å–å¼•å…ˆä¼æ¥­) ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’è¿½åŠ 
pac code add-data-source -a "shared_commondataserviceforapps" -c "æ¥ç¶šID" -t "accounts"

# Contacts (å–å¼•å…ˆæ‹…å½“è€…) ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’è¿½åŠ 
pac code add-data-source -a "shared_commondataserviceforapps" -c "æ¥ç¶šID" -t "contacts"
```

**ç”Ÿæˆã•ã‚Œã‚‹ãƒ•ã‚¡ã‚¤ãƒ«:**

```bash
# ã‚³ãƒãƒ³ãƒ‰å®Ÿè¡Œå¾Œã€ä»¥ä¸‹ã®ãƒ•ã‚¡ã‚¤ãƒ«ãŒè‡ªå‹•ç”Ÿæˆã•ã‚Œã¾ã™:

# SystemUsers ãƒ†ãƒ¼ãƒ–ãƒ«ã®å ´åˆ:
src/generated/services/SystemusersService.ts
src/generated/models/SystemusersModel.ts

# ã‚«ã‚¹ã‚¿ãƒ ãƒ†ãƒ¼ãƒ–ãƒ«ã®å ´åˆ:
src/generated/services/Geek_project_tasksService.ts
src/generated/models/Geek_project_tasksModel.ts
```

**âš ï¸ ã‚ˆãã‚ã‚‹ã‚¨ãƒ©ãƒ¼ã¨å¯¾å‡¦æ³•:**

```bash
# ã‚¨ãƒ©ãƒ¼ 1: æ¥ç¶šIDãŒè¦‹ã¤ã‹ã‚‰ãªã„
Error: Connection with id 'xxx' not found

å¯¾å‡¦æ³•:
1. Power Apps ãƒãƒ¼ã‚¿ãƒ«ã§æ¥ç¶šãŒæ­£ã—ãä½œæˆã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª
2. URLã‹ã‚‰æ¥ç¶šIDã‚’æ­£ç¢ºã«ã‚³ãƒ”ãƒ¼
3. ç’°å¢ƒãŒæ­£ã—ãé¸æŠã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª (pac env select)

# ã‚¨ãƒ©ãƒ¼ 2: èªè¨¼ã‚¨ãƒ©ãƒ¼
Error: Unauthorized

å¯¾å‡¦æ³•:
1. pac auth list ã§èªè¨¼çŠ¶æ…‹ã‚’ç¢ºèª
2. pac auth create ã§å†èªè¨¼
3. Power Apps ãƒãƒ¼ã‚¿ãƒ«ã§ãƒ­ã‚°ã‚¤ãƒ³çŠ¶æ…‹ã‚’ç¢ºèª

# ã‚¨ãƒ©ãƒ¼ 3: ãƒ†ãƒ¼ãƒ–ãƒ«ãŒè¦‹ã¤ã‹ã‚‰ãªã„
Error: Table 'tablename' not found

å¯¾å‡¦æ³•:
1. ãƒ†ãƒ¼ãƒ–ãƒ«ã®è«–ç†åã‚’ç¢ºèªï¼ˆå°æ–‡å­—ã€ã‚¢ãƒ³ãƒ€ãƒ¼ã‚¹ã‚³ã‚¢ï¼‰
2. customizations.xml ã§ãƒ†ãƒ¼ãƒ–ãƒ«åã‚’ç¢ºèª
3. Dataverse ã§ãƒ†ãƒ¼ãƒ–ãƒ«ãŒå…¬é–‹ã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª
```

**ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ:**

- [ ] Power Apps ãƒãƒ¼ã‚¿ãƒ«ã§æ¥ç¶šã‚’æ‰‹å‹•ä½œæˆ
- [ ] ãƒ–ãƒ©ã‚¦ã‚¶ã®URLã‹ã‚‰æ¥ç¶šIDã‚’å–å¾—
- [ ] APIåã‚’ç¢ºèªï¼ˆshared_commondataserviceforapps ç­‰ï¼‰
- [ ] `pac auth list` ã§èªè¨¼çŠ¶æ…‹ã‚’ç¢ºèª
- [ ] `pac env select` ã§ç’°å¢ƒã‚’é¸æŠ
- [ ] `pac code add-data-source` ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œ
- [ ] ç”Ÿæˆã•ã‚ŒãŸã‚µãƒ¼ãƒ“ã‚¹ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç¢ºèª
- [ ] `npm run build` ã§ãƒ“ãƒ«ãƒ‰æˆåŠŸã‚’ç¢ºèª

### âš¡ **Phase 3: Mockãƒ‡ãƒ¼ã‚¿ã‹ã‚‰ãƒªã‚¢ãƒ«ãƒ‡ãƒ¼ã‚¿ã¸ã®ç§»è¡Œ**

> **ğŸ“– è©³ç´°ãªãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹æ¥ç¶šæ‰‹é †ã¯ Phase 5 ã‚’å‚ç…§ã—ã¦ãã ã•ã„**

#### **3.1 Power Apps SDK ã«ã‚ˆã‚‹çµ±ä¸€æ¥ç¶šãƒ‘ã‚¿ãƒ¼ãƒ³**

> **âš ï¸ é‡è¦åŸå‰‡**: Power Apps Code Apps ã§ã¯ã€**å¿…ãš Power Apps SDKçµŒç”±ã§è‡ªå‹•ç”Ÿæˆã•ã‚ŒãŸã‚µãƒ¼ãƒ“ã‚¹ã‚¯ãƒ©ã‚¹**ã‚’ä½¿ç”¨ã—ã¦ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ã«æ¥ç¶šã—ã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€Power Apps ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼èªè¨¼ã¨ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãŒä¿è¨¼ã•ã‚Œã¾ã™ã€‚

**âœ… å”¯ä¸€ã®æ­£ã—ã„ã‚¢ãƒ—ãƒ­ãƒ¼ãƒï¼ˆPower Apps SDKä½¿ç”¨ï¼‰:**

```typescript
// âŒ ä»–ã®æ¥ç¶šæ–¹æ³•ã¯ä½¿ç”¨ã—ãªã„:
// - Dataverse Web API (fetch) - CORSåˆ¶é™ã€èªè¨¼å•é¡Œ
// - Xrm.WebApi - Model-driven Appså°‚ç”¨
// - Power Fxè©•ä¾¡ - Canvas Appsç’°å¢ƒå°‚ç”¨
// - ç›´æ¥REST API - èªè¨¼ã¨ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã®å•é¡Œ

// âœ… Power Apps SDKçµŒç”±ã®ã‚µãƒ¼ãƒ“ã‚¹ã‚¯ãƒ©ã‚¹ã®ã¿ä½¿ç”¨:
import { SystemUsersService } from '../generated/services/SystemUsersService';
import { Office365UsersService } from '../generated/services/Office365UsersService';

// Power Apps SDK ãŒãƒ¦ãƒ¼ã‚¶ãƒ¼èªè¨¼ã‚’è‡ªå‹•å‡¦ç†
const result = await SystemUsersService.getAll({
  select: ['systemuserid', 'fullname', 'internalemailaddress'],
  filter: 'isdisabled eq false',
  top: 50
});
```

#### **3.2 åŸºæœ¬çš„ãªãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹è¿½åŠ ãƒ•ãƒ­ãƒ¼**

**Step 1: æ¥ç¶šä½œæˆã¨ã‚µãƒ¼ãƒ“ã‚¹ã‚¯ãƒ©ã‚¹ç”Ÿæˆ**
```bash
# 1. Power Apps ãƒãƒ¼ã‚¿ãƒ«ã§æ¥ç¶šã‚’æ‰‹å‹•ä½œæˆ
# 2. ãƒ–ãƒ©ã‚¦ã‚¶ã®URLã‹ã‚‰æ¥ç¶šIDã‚’å–å¾—
# 3. pac code ã‚³ãƒãƒ³ãƒ‰ã§ã‚µãƒ¼ãƒ“ã‚¹ã‚¯ãƒ©ã‚¹ã‚’è‡ªå‹•ç”Ÿæˆ

# Dataverse (SystemUsers ãƒ†ãƒ¼ãƒ–ãƒ«)
pac code add-data-source -a "shared_commondataserviceforapps" -c "{æ¥ç¶šID}" -t "systemusers"

# Office 365 Users
pac code add-data-source -a "shared_office365users" -c "{æ¥ç¶šID}"
```

**Step 2: SDKåˆæœŸåŒ–ç¢ºèªã¨ä½¿ç”¨**
```typescript
import { usePowerPlatform } from '@microsoft/power-apps';
import { SystemUsersService } from '../generated/services/SystemUsersService';

export function DataversePage() {
  const { isInitialized } = usePowerPlatform();

  useEffect(() => {
    if (!isInitialized) return; // SDKåˆæœŸåŒ–å¾…æ©Ÿ
    
    // âœ… SDKåˆæœŸåŒ–å¾Œã«ã‚µãƒ¼ãƒ“ã‚¹ã‚¯ãƒ©ã‚¹ä½¿ç”¨
    const loadData = async () => {
      const result = await SystemUsersService.getAll();
      if (result.isSuccess && result.value) {
        setUsers(result.value);
      }
    };
    loadData();
  }, [isInitialized]);

  if (!isInitialized) {
    return <div>Power Apps SDK åˆæœŸåŒ–ä¸­...</div>;
  }
  
  return <div>{/* ãƒ‡ãƒ¼ã‚¿è¡¨ç¤º */}</div>;
}
```

**ä¸»è¦ãªãƒã‚¤ãƒ³ãƒˆ:**
- âœ… **Power Apps SDKçµŒç”±ã®ã¿ä½¿ç”¨** - ãƒ¦ãƒ¼ã‚¶ãƒ¼èªè¨¼ãŒè‡ªå‹•å‡¦ç†ã•ã‚Œã‚‹
- âœ… **è‡ªå‹•ç”Ÿæˆã‚µãƒ¼ãƒ“ã‚¹ã‚¯ãƒ©ã‚¹** - `pac code add-data-source` ã§ç”Ÿæˆ
- âœ… **SDKåˆæœŸåŒ–ãƒã‚§ãƒƒã‚¯** - `usePowerPlatform().isInitialized` ã§ç¢ºèª
- âœ… **TypeScriptå‹å®‰å…¨æ€§** - è‡ªå‹•ç”Ÿæˆã•ã‚ŒãŸå‹å®šç¾©ã‚’ä½¿ç”¨
- âŒ **ä»–ã®æ¥ç¶šæ–¹æ³•ã¯ä½¿ç”¨ç¦æ­¢** - èªè¨¼ãƒ»ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å•é¡Œã®ãŸã‚

#### **3.3 å®Œå…¨ãªãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹æ¥ç¶šã‚¬ã‚¤ãƒ‰**

**è©³ç´°ãªæ‰‹é †ã¯ Phase 5 ã‚’å‚ç…§:**
- æ¥ç¶šID ã®å–å¾—æ–¹æ³•ï¼ˆPower Apps ãƒãƒ¼ã‚¿ãƒ«ã®URLï¼‰
- ã‚³ãƒã‚¯ã‚¿ãƒ¼åˆ¥ã®è¿½åŠ æ‰‹é †ï¼ˆDataverse, Office 365, SQL Serverï¼‰
- Dataverse ãƒ†ãƒ¼ãƒ–ãƒ«ã®è¿½åŠ ï¼ˆSystemUsers, Accounts, Contactsç­‰ï¼‰
- ã‚«ã‚¹ã‚¿ãƒ ãƒ†ãƒ¼ãƒ–ãƒ«ã®è¿½åŠ ï¼ˆcustomizations.xml ä½¿ç”¨ï¼‰
- ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ï¼ˆæ¥ç¶šã‚¨ãƒ©ãƒ¼ã€SDKåˆæœŸåŒ–ã‚¨ãƒ©ãƒ¼ï¼‰

> **â†’ [Phase 5: ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹çµ±åˆã®è©³ç´°](#phase-5-æ©Ÿèƒ½æ‹¡å¼µ) ã‚’å‚ç…§**

---

## ğŸ—ƒï¸ **Dataverse æ¥ç¶šçµ±åˆ (Microsoft å…¬å¼ä»•æ§˜)**

> **å‚è€ƒãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ**: [Connect your code app to Dataverse](https://learn.microsoft.com/en-us/power-apps/developer/code-apps/how-to/connect-to-dataverse)

### âš ï¸ **é‡è¦: PowerDataRuntime åˆæœŸåŒ–ã®å¿…é ˆè¦ä»¶**

Dataverse ãƒ†ãƒ¼ãƒ–ãƒ«ï¼ˆä¾‹: SystemUsers, Accounts, Contacts ãªã©ï¼‰ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹éš›ã¯ã€**å¿…ãš Power Apps SDK ã®åˆæœŸåŒ–ãŒå®Œäº†ã—ã¦ã‹ã‚‰**ãƒ‡ãƒ¼ã‚¿æ“ä½œã‚’è¡Œã†å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

> **è©³ç´°ãªå®Ÿè£…ãƒ‘ã‚¿ãƒ¼ãƒ³ã¨åˆæœŸåŒ–æ–¹æ³•ã¯ Phase 5 ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚**

---

## ğŸ”§ **Dataverseæ¥ç¶šè¨­å®šæ‰‹é †ã¨ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°**
    searchTerm?: string, 
    top?: number, 
    isSearchTermRequired?: boolean, 
    skipToken?: string
  ): Promise<IOperationResult<EntityListResponse_IReadOnlyList_User>> {
    const params = { searchTerm, top, isSearchTermRequired, skipToken };
    const result = await Office365UsersService.client.executeAsync(
      {
        connectorOperation: {
          tableName: Office365UsersService.dataSourceName,
          operationName: 'SearchUserV2',
          parameters: params
        },
      });
    return result;
  }

  /**
   * Get manager (V2)
   * Retrieves the profile of the specified user's manager.
   */
  public static async Manager_V2(id: string, $select?: string): Promise<IOperationResult<GraphUser_V1>> {
    const params: { id: string, $select?: string } = { id, $select };
    const result = await Office365UsersService.client.executeAsync<{ id: string, $select?: string }, GraphUser_V1>(
      {
        connectorOperation: {
          tableName: Office365UsersService.dataSourceName,
          operationName: 'Manager_V2',
          parameters: params
        },
      });
    return result;
  }

  /**
   * Get direct reports (V2)
   * Retrieves the user profiles of the specified user's direct reports.
   */
  public static async DirectReports_V2(
    id: string, 
    $select?: string, 
    $top?: number
  ): Promise<IOperationResult<{ value: GraphUser_V1[] }>> {
    const params: { id: string, $select?: string, $top?: number } = { id, $select, $top };
    const result = await Office365UsersService.client.executeAsync(
      {
        connectorOperation: {
          tableName: Office365UsersService.dataSourceName,
          operationName: 'DirectReports_V2',
          parameters: params
        },
      });
    return result;
  }
}
```

**ä¸»è¦ãªãƒã‚¤ãƒ³ãƒˆ:**
- âœ… ã™ã¹ã¦ã®ãƒ¡ã‚½ãƒƒãƒ‰ãŒ `static` ã§å®šç¾©ã•ã‚Œã‚‹
- âœ… `dataSourceName` ã¯è‡ªå‹•çš„ã«è¨­å®šã•ã‚Œã‚‹
- âœ… `getClient(dataSourcesInfo)` ã§ Power Platform ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚’å–å¾—
- âœ… `executeAsync()` ã§éåŒæœŸã«ã‚³ãƒã‚¯ã‚¿ãƒ¼æ“ä½œã‚’å®Ÿè¡Œ
- âœ… TypeScriptå‹å®šç¾©ãŒè‡ªå‹•ç”Ÿæˆã•ã‚Œã‚‹

#### **3.3 ã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯ã§ã‚µãƒ¼ãƒ“ã‚¹ã‚¯ãƒ©ã‚¹ã‚’ãƒ©ãƒƒãƒ—**

**Step 1: Office 365 Users ã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯ä½œæˆ**
```typescript
// src/hooks/useOffice365.ts
import { useState, useEffect, useCallback } from 'react';
import { Office365UsersService } from '../generated/services/Office365UsersService';
import type { GraphUser_V1 } from '../generated/models/Office365UsersModel';

export const useOffice365Users = () => {
  const [users, setUsers] = useState<GraphUser_V1[]>([]);
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState<string | null>(null);

  // ç¾åœ¨ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«å–å¾—
  const getMyProfile = useCallback(async () => {
    try {
      setLoading(true);
      setError(null);
      const result = await Office365UsersService.MyProfile_V2();
      
      if (result.isSuccess && result.value) {
        return result.value;
      } else {
        throw new Error('ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«å–å¾—ã«å¤±æ•—ã—ã¾ã—ãŸ');
      }
    } catch (err) {
      const errorMessage = err instanceof Error ? err.message : 'Unknown error';
      setError(errorMessage);
      throw err;
    } finally {
      setLoading(false);
    }
  }, []);

  // ãƒ¦ãƒ¼ã‚¶ãƒ¼æ¤œç´¢
  const searchUsers = useCallback(async (searchTerm: string, top: number = 10) => {
    try {
      setLoading(true);
      setError(null);
      const result = await Office365UsersService.SearchUserV2(searchTerm, top, false);
      
      if (result.isSuccess && result.value) {
        setUsers(result.value.value || []);
        return result.value.value;
      } else {
        throw new Error('ãƒ¦ãƒ¼ã‚¶ãƒ¼æ¤œç´¢ã«å¤±æ•—ã—ã¾ã—ãŸ');
      }
    } catch (err) {
      const errorMessage = err instanceof Error ? err.message : 'Unknown error';
      setError(errorMessage);
      throw err;
    } finally {
      setLoading(false);
    }
  }, []);

  // ç‰¹å®šãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«å–å¾—
  const getUserProfile = useCallback(async (userId: string) => {
    try {
      setLoading(true);
      setError(null);
      const result = await Office365UsersService.UserProfile_V2(userId);
      
      if (result.isSuccess && result.value) {
        return result.value;
      } else {
        throw new Error('ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ã®å–å¾—ã«å¤±æ•—ã—ã¾ã—ãŸ');
      }
    } catch (err) {
      const errorMessage = err instanceof Error ? err.message : 'Unknown error';
      setError(errorMessage);
      throw err;
    } finally {
      setLoading(false);
    }
  }, []);

  // ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼æƒ…å ±å–å¾—
  const getManager = useCallback(async (userId: string) => {
    try {
      setLoading(true);
      setError(null);
      const result = await Office365UsersService.Manager_V2(userId);
      
      if (result.isSuccess && result.value) {
        return result.value;
      } else {
        throw new Error('ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼æƒ…å ±ã®å–å¾—ã«å¤±æ•—ã—ã¾ã—ãŸ');
      }
    } catch (err) {
      const errorMessage = err instanceof Error ? err.message : 'Unknown error';
      setError(errorMessage);
      throw err;
    } finally {
      setLoading(false);
    }
  }, []);

  // ç›´å±ã®éƒ¨ä¸‹å–å¾—
  const getDirectReports = useCallback(async (userId: string, top: number = 50) => {
    try {
      setLoading(true);
      setError(null);
      const result = await Office365UsersService.DirectReports_V2(userId, undefined, top);
      
      if (result.isSuccess && result.value) {
        return result.value.value || [];
      } else {
        throw new Error('éƒ¨ä¸‹æƒ…å ±ã®å–å¾—ã«å¤±æ•—ã—ã¾ã—ãŸ');
      }
    } catch (err) {
      const errorMessage = err instanceof Error ? err.message : 'Unknown error';
      setError(errorMessage);
      throw err;
    } finally {
      setLoading(false);
    }
  }, []);

  return { 
    users,
    loading, 
    error,
    getMyProfile,
    searchUsers,
    getUserProfile,
    getManager,
    getDirectReports
  };
};
```

**Step 2: Reactã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã§ã®ä½¿ç”¨ä¾‹**
```typescript
// src/pages/Office365Page.tsx
import React, { useState, useEffect } from 'react';
import { useOffice365Users } from '../hooks/useOffice365';
import type { GraphUser_V1 } from '../generated/models/Office365UsersModel';

export const Office365Page: React.FC = () => {
  const { 
    users, 
    loading, 
    error, 
    getMyProfile, 
    searchUsers, 
    getUserProfile,
    getManager,
    getDirectReports
  } = useOffice365Users();

  const [myProfile, setMyProfile] = useState<GraphUser_V1 | null>(null);
  const [searchTerm, setSearchTerm] = useState('');
  const [selectedUser, setSelectedUser] = useState<GraphUser_V1 | null>(null);
  const [manager, setManager] = useState<GraphUser_V1 | null>(null);
  const [directReports, setDirectReports] = useState<GraphUser_V1[]>([]);

  // åˆæœŸåŒ–æ™‚ã«è‡ªåˆ†ã®ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å–å¾—
  useEffect(() => {
    const loadProfile = async () => {
      try {
        const profile = await getMyProfile();
        setMyProfile(profile);
      } catch (err) {
        console.error('ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«å–å¾—ã‚¨ãƒ©ãƒ¼:', err);
      }
    };
    loadProfile();
  }, [getMyProfile]);

  // ãƒ¦ãƒ¼ã‚¶ãƒ¼æ¤œç´¢å‡¦ç†
  const handleSearch = async () => {
    if (!searchTerm.trim()) return;
    try {
      await searchUsers(searchTerm, 20);
    } catch (err) {
      console.error('æ¤œç´¢ã‚¨ãƒ©ãƒ¼:', err);
    }
  };

  // ãƒ¦ãƒ¼ã‚¶ãƒ¼é¸æŠæ™‚ã®è©³ç´°å–å¾—
  const handleUserSelect = async (userId: string) => {
    try {
      const [userProfile, userManager, reports] = await Promise.all([
        getUserProfile(userId),
        getManager(userId).catch(() => null), // ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼ãŒã„ãªã„å ´åˆã‚‚ã‚ã‚‹
        getDirectReports(userId).catch(() => []) // éƒ¨ä¸‹ãŒã„ãªã„å ´åˆã‚‚ã‚ã‚‹
      ]);

      setSelectedUser(userProfile);
      setManager(userManager);
      setDirectReports(reports);
    } catch (err) {
      console.error('ãƒ¦ãƒ¼ã‚¶ãƒ¼è©³ç´°å–å¾—ã‚¨ãƒ©ãƒ¼:', err);
    }
  };

  if (loading && !myProfile) {
    return (
      <div className="flex items-center justify-center p-8">
        <div className="animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"></div>
        <span className="ml-2">Loading...</span>
      </div>
    );
  }

  return (
    <div className="container mx-auto p-6">
      <h1 className="text-3xl font-bold mb-6">Office 365 Users</h1>

      {error && (
        <div className="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4">
          {error}
        </div>
      )}

      {/* è‡ªåˆ†ã®ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«è¡¨ç¤º */}
      {myProfile && (
        <div className="bg-white shadow rounded-lg p-6 mb-6">
          <h2 className="text-xl font-semibold mb-4">My Profile</h2>
          <div className="grid grid-cols-2 gap-4">
            <div>
              <p className="text-sm text-gray-600">Display Name</p>
              <p className="font-medium">{myProfile.displayName}</p>
            </div>
            <div>
              <p className="text-sm text-gray-600">Email</p>
              <p className="font-medium">{myProfile.mail || myProfile.userPrincipalName}</p>
            </div>
            <div>
              <p className="text-sm text-gray-600">Job Title</p>
              <p className="font-medium">{myProfile.jobTitle || 'N/A'}</p>
            </div>
            <div>
              <p className="text-sm text-gray-600">Department</p>
              <p className="font-medium">{myProfile.department || 'N/A'}</p>
            </div>
          </div>
        </div>
      )}

      {/* ãƒ¦ãƒ¼ã‚¶ãƒ¼æ¤œç´¢ */}
      <div className="bg-white shadow rounded-lg p-6 mb-6">
        <h2 className="text-xl font-semibold mb-4">Search Users</h2>
        <div className="flex gap-2">
          <input
            type="text"
            value={searchTerm}
            onChange={(e) => setSearchTerm(e.target.value)}
            onKeyPress={(e) => e.key === 'Enter' && handleSearch()}
            placeholder="Enter name or email..."
            className="flex-1 px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
          />
          <button
            onClick={handleSearch}
            disabled={loading}
            className="px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50"
          >
            {loading ? 'Searching...' : 'Search'}
          </button>
        </div>

        {/* æ¤œç´¢çµæœ */}
        {users.length > 0 && (
          <div className="mt-4 space-y-2">
            <h3 className="font-semibold">Search Results ({users.length})</h3>
            {users.map((user) => (
              <div
                key={user.id}
                onClick={() => handleUserSelect(user.id!)}
                className="p-4 border rounded-lg hover:bg-gray-50 cursor-pointer"
              >
                <p className="font-medium">{user.displayName}</p>
                <p className="text-sm text-gray-600">{user.mail || user.userPrincipalName}</p>
                {user.jobTitle && (
                  <p className="text-sm text-gray-500">{user.jobTitle}</p>
                )}
              </div>
            ))}
          </div>
        )}
      </div>

      {/* é¸æŠã—ãŸãƒ¦ãƒ¼ã‚¶ãƒ¼ã®è©³ç´° */}
      {selectedUser && (
        <div className="bg-white shadow rounded-lg p-6">
          <h2 className="text-xl font-semibold mb-4">User Details</h2>
          
          {/* åŸºæœ¬æƒ…å ± */}
          <div className="mb-6">
            <h3 className="font-semibold mb-2">Basic Information</h3>
            <div className="grid grid-cols-2 gap-4">
              <div>
                <p className="text-sm text-gray-600">Display Name</p>
                <p className="font-medium">{selectedUser.displayName}</p>
              </div>
              <div>
                <p className="text-sm text-gray-600">Email</p>
                <p className="font-medium">{selectedUser.mail || selectedUser.userPrincipalName}</p>
              </div>
              <div>
                <p className="text-sm text-gray-600">Job Title</p>
                <p className="font-medium">{selectedUser.jobTitle || 'N/A'}</p>
              </div>
              <div>
                <p className="text-sm text-gray-600">Department</p>
                <p className="font-medium">{selectedUser.department || 'N/A'}</p>
              </div>
              <div>
                <p className="text-sm text-gray-600">Office Location</p>
                <p className="font-medium">{selectedUser.officeLocation || 'N/A'}</p>
              </div>
              <div>
                <p className="text-sm text-gray-600">Mobile Phone</p>
                <p className="font-medium">{selectedUser.mobilePhone || 'N/A'}</p>
              </div>
            </div>
          </div>

          {/* ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼æƒ…å ± */}
          {manager && (
            <div className="mb-6">
              <h3 className="font-semibold mb-2">Manager</h3>
              <div className="p-4 border rounded-lg bg-gray-50">
                <p className="font-medium">{manager.displayName}</p>
                <p className="text-sm text-gray-600">{manager.mail || manager.userPrincipalName}</p>
                {manager.jobTitle && (
                  <p className="text-sm text-gray-500">{manager.jobTitle}</p>
                )}
              </div>
            </div>
          )}

          {/* ç›´å±ã®éƒ¨ä¸‹ */}
          {directReports.length > 0 && (
            <div>
              <h3 className="font-semibold mb-2">Direct Reports ({directReports.length})</h3>
              <div className="space-y-2">
                {directReports.map((report) => (
                  <div key={report.id} className="p-4 border rounded-lg bg-gray-50">
                    <p className="font-medium">{report.displayName}</p>
                    <p className="text-sm text-gray-600">{report.mail || report.userPrincipalName}</p>
                    {report.jobTitle && (
                      <p className="text-sm text-gray-500">{report.jobTitle}</p>
                    )}
                  </div>
                ))}
              </div>
            </div>
          )}
        </div>
      )}
    </div>
  );
};
```

**ä¸»è¦ãªãƒã‚¤ãƒ³ãƒˆ:**
- âœ… **è‡ªå‹•ç”Ÿæˆã‚µãƒ¼ãƒ“ã‚¹ã‚¯ãƒ©ã‚¹** ã‚’ç›´æ¥ä½¿ç”¨
- âœ… **ã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯** ã§ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ã‚’ã‚«ãƒ—ã‚»ãƒ«åŒ–
- âœ… **TypeScriptå‹å®šç¾©** ã§å‹å®‰å…¨æ€§ã‚’ç¢ºä¿
- âœ… **ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°** ã‚’å„æ“ä½œã§å®Ÿè£…
- âœ… **ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°çŠ¶æ…‹** ã‚’é©åˆ‡ã«ç®¡ç†

#### **3.4 SQL Server ã‚³ãƒã‚¯ã‚¿ãƒ¼ã®çµ±åˆãƒ‘ã‚¿ãƒ¼ãƒ³**
```typescript
// src/hooks/useSqlProjects.ts  
import { useConnector } from '@microsoft/power-apps';
import { useState, useCallback } from 'react';

export const useSqlProjects = () => {
  const [projects, setProjects] = useState([]);
  const [loading, setLoading] = useState(false);
  const [error, setError] = useState<string | null>(null);
  
  const sqlConnector = useConnector('sql');

  const loadProjects = useCallback(async (options = {}) => {
    try {
      setLoading(true);
      setError(null);
      
      // âœ… æ­£ã—ã„SQL APIãƒ¡ã‚½ãƒƒãƒ‰ (FluentSampleãƒ‘ã‚¿ãƒ¼ãƒ³)
      const result = await sqlConnector.getTable('Projects', {
        skip: 0,
        take: 50,
        orderBy: 'CreatedDate desc',
        ...options
      });
      
      setProjects(result.data || []);
    } catch (err) {
      console.error('SQL Error:', err);
      setError(`Database Error: ${err.message}`);
    } finally {
      setLoading(false);
    }
  }, [sqlConnector]);

  const createProject = useCallback(async (projectData) => {
    try {
      await sqlConnector.insertTable('Projects', projectData);
      await loadProjects(); // å†èª­ã¿è¾¼ã¿
    } catch (err) {
      setError(`Create Error: ${err.message}`);
      throw err;
    }
  }, [sqlConnector, loadProjects]);

  const updateProject = useCallback(async (id, data) => {
    try {
      await sqlConnector.updateTable('Projects', id, data);
      await loadProjects(); // å†èª­ã¿è¾¼ã¿
    } catch (err) {
      setError(`Update Error: ${err.message}`);
      throw err;
    }
  }, [sqlConnector, loadProjects]);

  const deleteProject = useCallback(async (id) => {
    try {
      await sqlConnector.deleteTable('Projects', id);
      await loadProjects(); // å†èª­ã¿è¾¼ã¿  
    } catch (err) {
      setError(`Delete Error: ${err.message}`);
      throw err;
    }
  }, [sqlConnector, loadProjects]);

  return { 
    projects, 
    loading, 
    error, 
    loadProjects,
    createProject,
    updateProject,
    deleteProject
  };
};
```

#### **3.5 Mockãƒ‡ãƒ¼ã‚¿ã‹ã‚‰ã‚³ãƒã‚¯ã‚¿ãƒ¼å‘¼ã³å‡ºã—ã¸ã®ç½®æ›**

**Office 365 Users ã®å¤‰æ›´ä¾‹:**
```typescript
// src/pages/Office365Page.tsx (ãƒªã‚¢ãƒ«ãƒ‡ãƒ¼ã‚¿ç‰ˆ)
import React, { useState, useEffect } from 'react';
import { useOffice365Users } from '../hooks/useOffice365';
import type { GraphUser_V1 } from '../generated/models/Office365UsersModel';

export const Office365Page: React.FC = () => {
  const { getMyProfile, searchUsers, loading, error } = useOffice365Users();
  const [myProfile, setMyProfile] = useState<GraphUser_V1 | null>(null);

  useEffect(() => {
    const loadProfile = async () => {
      try {
        const profile = await getMyProfile();
        setMyProfile(profile);
      } catch (err) {
        console.error('ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«å–å¾—ã‚¨ãƒ©ãƒ¼:', err);
      }
    };
    loadProfile();
  }, [getMyProfile]);

  if (loading && !myProfile) {
    return (
      <div className="flex items-center justify-center p-8">
        <div className="animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"></div>
        <span className="ml-2">Loading Office 365 profile...</span>
      </div>
    );
  }

  if (error) {
    return (
      <div className="p-6">
        <div className="bg-red-50 border border-red-200 rounded-lg p-4">
          <h3 className="text-red-800 font-semibold">Connection Error</h3>
          <p className="text-red-600">{error}</p>
        </div>
      </div>
    );
  }

  return (
    <div className="p-6">
      <h1 className="text-2xl font-bold mb-4">Office 365 User Profile</h1>
      {myProfile && (
        <div className="border rounded-lg p-4 bg-white shadow">
          <h3 className="font-semibold text-lg">{myProfile.displayName}</h3>
          <p className="text-gray-600">{myProfile.jobTitle || 'è·ä½æœªè¨­å®š'}</p>
          <p className="text-sm text-blue-600">{myProfile.mail || myProfile.userPrincipalName}</p>
          <p className="text-xs text-gray-400">{myProfile.department || 'éƒ¨ç½²æœªè¨­å®š'}</p>
        </div>
      )}
    </div>
  );
};
```
    } catch (err) {
      console.error('SQL Server API Error:', err);
      setError(`ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶šã‚¨ãƒ©ãƒ¼: ${err.message || 'Unknown error'}`);
    } finally {
      setLoading(false);
    }
  };

  useEffect(() => {
    loadRealProjects();
  }, [sqlConnector]);

  const handleCreateProject = async (projectData: any) => {
    try {
      // âœ… æ­£ã—ã„SQLä½œæˆAPI
      const result = await sqlConnector.insertTable('Projects', projectData);
      
      if (result) {
        // ãƒ‡ãƒ¼ã‚¿å†èª­ã¿è¾¼ã¿
        await loadRealProjects();
      }
    } catch (err) {
      console.error('Project creation failed:', err);
      setError(`ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä½œæˆã‚¨ãƒ©ãƒ¼: ${err.message}`);
    }
  };

  const handleUpdateProject = async (projectId: number, updatedData: any) => {
    try {
      // âœ… æ­£ã—ã„SQLæ›´æ–°API
      await sqlConnector.updateTable('Projects', projectId, updatedData);
      await loadRealProjects();
    } catch (err) {
      console.error('Project update failed:', err);
      setError(`ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ›´æ–°ã‚¨ãƒ©ãƒ¼: ${err.message}`);
    }
  };

  const handleDeleteProject = async (projectId: number) => {
    try {
      // âœ… æ­£ã—ã„SQLå‰Šé™¤API
      await sqlConnector.deleteTable('Projects', projectId);
      await loadRealProjects();
    } catch (err) {
      console.error('Project deletion failed:', err);
      setError(`ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå‰Šé™¤ã‚¨ãƒ©ãƒ¼: ${err.message}`);
    }
  };

  if (loading) return (
    <div className="flex items-center justify-center p-8">
      <div className="animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"></div>
      <span className="ml-2">Loading projects from database...</span>
    </div>
  );

  return (
    <div className="p-6">
      <div className="flex justify-between items-center mb-6">
        <h1 className="text-2xl font-bold">Projects (SQL Database)</h1>
        <span className="text-sm text-gray-600">{totalCount} total projects</span>
      </div>
      
      {error && (
        <div className="bg-red-50 border border-red-200 rounded-lg p-4 mb-4">
          <h3 className="text-red-800 font-semibold">Database Error</h3>
          <p className="text-red-600">{error}</p>
        </div>
      )}
      
      <div className="grid gap-4">
        {projects.map((project: any) => (
          <div key={project.Id} className="border rounded-lg p-4 bg-white shadow">
            <div className="flex justify-between items-start">
              <div>
                <h3 className="font-semibold text-lg">{project.Name}</h3>
                <p className="text-gray-600 mt-1">{project.Description}</p>
                <div className="flex gap-4 mt-2">
                  <span className={`px-2 py-1 rounded text-sm ${
                    project.Status === 'Active' ? 'bg-green-100 text-green-800' :
                    project.Status === 'Planning' ? 'bg-blue-100 text-blue-800' :
                    project.Status === 'On Hold' ? 'bg-yellow-100 text-yellow-800' :
                    project.Status === 'Completed' ? 'bg-purple-100 text-purple-800' :
                    'bg-gray-100 text-gray-800'
                  }`}>
                    {project.Status}
                  </span>
                  <span className={`px-2 py-1 rounded text-sm ${
                    project.Priority === 'Critical' ? 'bg-red-100 text-red-800' :
                    project.Priority === 'High' ? 'bg-orange-100 text-orange-800' :
                    project.Priority === 'Medium' ? 'bg-yellow-100 text-yellow-800' :
                    'bg-green-100 text-green-800'
                  }`}>
                    {project.Priority}
                  </span>
                </div>
              </div>
              <div className="flex gap-2">
                <button 
                  onClick={() => handleUpdateProject(project.Id, {...project, Status: 'Active'})}
                  className="px-3 py-1 bg-blue-600 text-white rounded text-sm hover:bg-blue-700"
                >
                  Edit
                </button>
                <button 
                  onClick={() => handleDeleteProject(project.Id)}
                  className="px-3 py-1 bg-red-600 text-white rounded text-sm hover:bg-red-700"
                >
                  Delete
                </button>
              </div>
            </div>
            {project.Budget && (
              <p className="text-sm text-gray-500 mt-2">
                Budget: Â¥{project.Budget.toLocaleString()}
              </p>
            )}
          </div>
        ))}
      </div>
    </div>
  );
};
```

#### **3.3 ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã¨ãƒ‡ãƒãƒƒã‚°**

```typescript
// src/utils/errorHandler.ts - å…±é€šã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°
export const handleConnectorError = (error: any, connectorName: string) => {
  console.error(`${connectorName} Error:`, error);
  
  // ã‚ˆãã‚ã‚‹ã‚¨ãƒ©ãƒ¼ãƒ‘ã‚¿ãƒ¼ãƒ³ã®å‡¦ç†
  if (error?.message?.includes('Unauthorized')) {
    return 'ã‚³ãƒã‚¯ã‚¿ãƒ¼ã¸ã®èªè¨¼ãŒå¿…è¦ã§ã™ã€‚Power Apps ã§æ¥ç¶šã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚';
  }
  
  if (error?.message?.includes('Network')) {
    return 'ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯æ¥ç¶šã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚';
  }
  
  if (error?.message?.includes('Not Found')) {
    return 'ãƒ‡ãƒ¼ã‚¿ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã€‚';
  }
  
  return `${connectorName}ã¸ã®æ¥ç¶šã§ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ: ${error?.message || 'Unknown error'}`;
};
```

#### **3.8 çµ±åˆãƒ†ã‚¹ãƒˆæ‰‹é †**

**ãƒ­ãƒ¼ã‚«ãƒ«ãƒ†ã‚¹ãƒˆ (Mock â†’ Real ãƒ‡ãƒ¼ã‚¿åˆ‡ã‚Šæ›¿ãˆ)**
```bash
# 1. Mockãƒ‡ãƒ¼ã‚¿ã§ã®å‹•ä½œç¢ºèª
npm install
npm run build
npm run dev
# â†’ Mockãƒ‡ãƒ¼ã‚¿ç‰ˆã§å…¨æ©Ÿèƒ½ãƒ†ã‚¹ãƒˆ

# 2. Power Platformæ¥ç¶šä½œæˆ
# Power Apps Maker Portal ã§:
# - Office 365 Users æ¥ç¶šä½œæˆ
# - Dataverse æ¥ç¶šä½œæˆ
# - SQL Server æ¥ç¶šä½œæˆ (å¿…è¦ã«å¿œã˜ã¦)

# 3. ã‚µãƒ¼ãƒ“ã‚¹ã‚¯ãƒ©ã‚¹ç”Ÿæˆ
pac code add-data-source -a "shared_office365users" -c "æ¥ç¶šID"
pac code add-data-source -a "shared_commondataserviceforapps" -c "æ¥ç¶šID"

# 4. è‡ªå‹•ç”Ÿæˆã•ã‚ŒãŸã‚µãƒ¼ãƒ“ã‚¹ã‚¯ãƒ©ã‚¹ã‚’ä½¿ç”¨
# src/hooks/ ã«ã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯ã‚’å®Ÿè£…
# src/pages/ ã§ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‹ã‚‰å‘¼ã³å‡ºã—

# 5. Power Platformç’°å¢ƒãƒ†ã‚¹ãƒˆ  
pac code init  # åˆå›ã®ã¿
pac code run   # ãƒ­ãƒ¼ã‚«ãƒ« + Power Platformçµ±åˆ
# â†’ èªè¨¼ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ç¢ºèª
# â†’ ãƒªã‚¢ãƒ«ãƒ‡ãƒ¼ã‚¿å–å¾—ç¢ºèª
```

**âš ï¸ é‡è¦ãªãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°:**
```bash
# æ¨å¥¨ã•ã‚Œã‚‹ç¢ºèªé …ç›®:
# 1. npm run build ãŒæˆåŠŸã—ã¦ã„ã‚‹ã“ã¨
# 2. PowerProvider.tsx ã«ã‚¨ãƒ©ãƒ¼ãŒãªã„ã“ã¨  
# 3. ç’°å¢ƒã§å¿…è¦ãªã‚³ãƒã‚¯ã‚¿ãƒ¼ãŒæœ‰åŠ¹ã«ãªã£ã¦ã„ã‚‹ã“ã¨
# 4. dataSourcesInfo.ts ã«ã‚³ãƒã‚¯ã‚¿ãƒ¼æƒ…å ±ãŒå«ã¾ã‚Œã¦ã„ã‚‹ã“ã¨
# 5. ã‚µãƒ¼ãƒ“ã‚¹ã‚¯ãƒ©ã‚¹ã® dataSourceName ãŒæ­£ã—ã„ã“ã¨

# ã‚ˆãã‚ã‚‹å•é¡Œã¨è§£æ±ºæ–¹æ³•:
# - App timed out â†’ PowerProviderå®Ÿè£…ç¢ºèª
# - Connection failed â†’ Power Appsæ¥ç¶šç¢ºèª
# - Data source not found â†’ dataSourceName ã®å€¤ã‚’ç¢ºèª
# - Data not loading â†’ IOperationResult.isSuccess ã‚’ç¢ºèª
```

#### **3.9 æœ¬ç•ªãƒ‡ãƒ—ãƒ­ã‚¤æ‰‹é †**

```bash
# æœ€çµ‚ãƒ“ãƒ«ãƒ‰ & ãƒ‡ãƒ—ãƒ­ã‚¤
npm run build
pac code push

# âœ… ãƒ‡ãƒ—ãƒ­ã‚¤æˆåŠŸç¢ºèª:
# 1. Power Apps URL ã®å–å¾—
# 2. make.powerapps.com ã§ã‚¢ãƒ—ãƒªç¢ºèª
# 3. ã‚¨ãƒ³ãƒ‰ãƒ¦ãƒ¼ã‚¶ãƒ¼ã§ã®å‹•ä½œãƒ†ã‚¹ãƒˆ
# 4. ã™ã¹ã¦ã®ã‚³ãƒã‚¯ã‚¿ãƒ¼æ“ä½œãŒæ­£å¸¸å‹•ä½œã™ã‚‹ã“ã¨ã‚’ç¢ºèª
```

**ãƒ‡ãƒ—ãƒ­ã‚¤å¾Œã®ç¢ºèªé …ç›®:**
- [ ] ã‚¢ãƒ—ãƒªãŒæ­£å¸¸ã«èµ·å‹•ã™ã‚‹
- [ ] Office 365 Users ãƒ‡ãƒ¼ã‚¿ãŒå–å¾—ã§ãã‚‹
- [ ] Dataverse ãƒ‡ãƒ¼ã‚¿ã® CRUD æ“ä½œãŒæ­£å¸¸å‹•ä½œ
- [ ] ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ãŒé©åˆ‡ã«å‹•ä½œ
- [ ] Loading çŠ¶æ…‹ãŒé©åˆ‡ã«è¡¨ç¤ºã•ã‚Œã‚‹
- [ ] ã™ã¹ã¦ã®ç”»é¢ã§èªè¨¼ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ãªã„

#### **3.6 ã‚³ãƒã‚¯ã‚¿ãƒ¼çµ±åˆã®ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹**

**âœ… Microsoftæ¨å¥¨ã®ã‚³ãƒã‚¯ã‚¿ãƒ¼çµ±åˆãƒ‘ã‚¿ãƒ¼ãƒ³:**

**ã‚³ãƒ¼ãƒ‰å“è³ª:**
- [ ] **è‡ªå‹•ç”Ÿæˆã‚µãƒ¼ãƒ“ã‚¹ã‚¯ãƒ©ã‚¹** ã‚’ä½¿ç”¨ (Office365UsersService, DataverseServiceç­‰)
- [ ] **ã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯** ã§ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ã‚’ã‚«ãƒ—ã‚»ãƒ«åŒ–
- [ ] é©åˆ‡ãª **TypeScriptå‹å®šç¾©** ã‚’æ´»ç”¨
- [ ] **ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°** ã‚’å„æ“ä½œã§å®Ÿè£…
- [ ] **LoadingçŠ¶æ…‹** ã®é©åˆ‡ãªè¡¨ç¤º
- [ ] **IOperationResult** ã® `isSuccess` ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã§ã‚¨ãƒ©ãƒ¼ãƒã‚§ãƒƒã‚¯

**çµ±åˆç¢ºèªé …ç›®:**
- [ ] `pac code add-data-source` ã§æ­£ã—ãã‚µãƒ¼ãƒ“ã‚¹ã‚¯ãƒ©ã‚¹ã‚’ç”Ÿæˆ
- [ ] `dataSourcesInfo.ts` ã«ã‚³ãƒã‚¯ã‚¿ãƒ¼æƒ…å ±ãŒå«ã¾ã‚Œã¦ã„ã‚‹
- [ ] `getClient(dataSourcesInfo)` ã§ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚’å–å¾—
- [ ] Power Appsç’°å¢ƒã§æ¥ç¶šãŒæ­£å¸¸ã«ä½œæˆã•ã‚Œã¦ã„ã‚‹
- [ ] ãƒ­ãƒ¼ã‚«ãƒ«é–‹ç™ºã§ `pac code run` ãŒæ­£å¸¸å‹•ä½œ

**ãƒ‡ãƒ—ãƒ­ã‚¤å‰ãƒã‚§ãƒƒã‚¯:**
- [ ] ã™ã¹ã¦ã®ã‚³ãƒã‚¯ã‚¿ãƒ¼æ“ä½œã§ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°å®Ÿè£…
- [ ] Loading/ErrorçŠ¶æ…‹ã®UIè¡¨ç¤ºã‚’å®Ÿè£…
- [ ] `npm run build` ãŒæˆåŠŸ
- [ ] `pac code push` ã§ãƒ‡ãƒ—ãƒ­ã‚¤æˆåŠŸ
- [ ] Power Appsç’°å¢ƒã§ã‚¢ãƒ—ãƒªãŒæ­£å¸¸èµ·å‹•

#### **3.7 ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã®ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹**

```typescript
// src/utils/connectorErrorHandler.ts
import type { IOperationResult } from '@microsoft/power-apps/data';

/**
 * ã‚³ãƒã‚¯ã‚¿ãƒ¼æ“ä½œçµæœã®ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°
 */
export const handleOperationResult = <T>(
  result: IOperationResult<T>,
  connectorName: string
): T => {
  if (!result.isSuccess) {
    const errorMessage = result.error?.message || 'Unknown error';
    console.error(`${connectorName} Error:`, result.error);
    
    // ã‚ˆãã‚ã‚‹ã‚¨ãƒ©ãƒ¼ãƒ‘ã‚¿ãƒ¼ãƒ³ã®å‡¦ç†
    if (errorMessage.includes('Unauthorized')) {
      throw new Error(`${connectorName}ã¸ã®èªè¨¼ãŒå¿…è¦ã§ã™ã€‚Power Apps ã§æ¥ç¶šã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚`);
    }
    
    if (errorMessage.includes('Network')) {
      throw new Error('ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯æ¥ç¶šã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚');
    }
    
    if (errorMessage.includes('Not Found')) {
      throw new Error('ãƒ‡ãƒ¼ã‚¿ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã€‚');
    }
    
    throw new Error(`${connectorName}ã¸ã®æ¥ç¶šã§ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ: ${errorMessage}`);
  }
  
  return result.value!;
};

/**
 * ã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯ã§ã®ä½¿ç”¨ä¾‹
 */
export const useOffice365WithErrorHandling = () => {
  const [loading, setLoading] = useState(false);
  const [error, setError] = useState<string | null>(null);

  const getMyProfile = useCallback(async () => {
    try {
      setLoading(true);
      setError(null);
      const result = await Office365UsersService.MyProfile_V2();
      return handleOperationResult(result, 'Office 365 Users');
    } catch (err) {
      const errorMessage = err instanceof Error ? err.message : 'Unknown error';
      setError(errorMessage);
      throw err;
    } finally {
      setLoading(false);
    }
  }, []);

  return { getMyProfile, loading, error };
};
```
- [ ] TypeScriptå‹å®‰å…¨æ€§ã®ç¢ºä¿

**ãƒ‡ãƒ¼ã‚¿æ¥ç¶š:**
- [ ] Office 365 Users: `getUserProfiles()` ãƒ¡ã‚½ãƒƒãƒ‰ä½¿ç”¨
- [ ] SQL Server: `getTable()`, `insertTable()`, `updateTable()`, `deleteTable()` ä½¿ç”¨
- [ ] Outlook: `getCalendarEvents()`, `getEmails()` ä½¿ç”¨
- [ ] é©åˆ‡ãªèªè¨¼ãƒ•ãƒ­ãƒ¼ç¢ºèª

**UI/UX:**
- [ ] Fluent UI v9 ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆä½¿ç”¨
- [ ] ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–ãƒ‡ã‚¶ã‚¤ãƒ³å¯¾å¿œ  
- [ ] ã‚¢ã‚¯ã‚»ã‚·ãƒ“ãƒªãƒ†ã‚£è€ƒæ…®
- [ ] é©åˆ‡ãªãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°/ã‚¨ãƒ©ãƒ¼è¡¨ç¤º

**ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹:**
- [ ] React.memo ã«ã‚ˆã‚‹æœ€é©åŒ–
- [ ] é©åˆ‡ãªuseCallback/useMemoä½¿ç”¨
- [ ] ãƒ‡ãƒ¼ã‚¿ãƒšãƒ¼ã‚¸ãƒ³ã‚°å®Ÿè£…
- [ ] ã‚¨ãƒ©ãƒ¼ãƒã‚¦ãƒ³ãƒ€ãƒªè¨­å®š

**ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£:**
- [ ] æ©Ÿå¯†ãƒ‡ãƒ¼ã‚¿ã®é©åˆ‡ãªå–ã‚Šæ‰±ã„
- [ ] æ¨©é™ãƒã‚§ãƒƒã‚¯å®Ÿè£…
- [ ] ãƒ­ã‚°å‡ºåŠ›ã®æœ€é©åŒ–
- [ ] XSS/CSRFå¯¾ç­–ç¢ºèª

**ãƒ‡ãƒ—ãƒ­ã‚¤:**
- [ ] ãƒ­ãƒ¼ã‚«ãƒ«ãƒ“ãƒ«ãƒ‰æˆåŠŸ
- [ ] Power Platformçµ±åˆãƒ†ã‚¹ãƒˆå®Œäº†
- [ ] ã‚¨ãƒ³ãƒ‰ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ†ã‚¹ãƒˆå®Œäº†
- [ ] ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ç¢ºèªå®Œäº†

## ğŸ§ª **ãƒ¢ãƒƒã‚¯ãƒ‡ãƒ¼ã‚¿ã‹ã‚‰ãƒªã‚¢ãƒ«ãƒ‡ãƒ¼ã‚¿ç§»è¡Œãƒ†ã‚¹ãƒˆï¼ˆé‡è¦ï¼‰**

### **ğŸ“‹ ç§»è¡Œãƒ†ã‚¹ãƒˆãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ**

ãƒ¢ãƒƒã‚¯ãƒ‡ãƒ¼ã‚¿ã‹ã‚‰ãƒªã‚¢ãƒ«ãƒ‡ãƒ¼ã‚¿ã«å¤‰æ›´ã—ãŸéš›ã«ã¯ã€ä»¥ä¸‹ã®é …ç›®ã‚’å¿…ãšãƒ†ã‚¹ãƒˆã—ã¦ãã ã•ã„ï¼š

#### **ğŸ” ãƒ‡ãƒ¼ã‚¿ã‚¹ã‚­ãƒ¼ãƒæ¤œè¨¼**

**Office 365 ã‚³ãƒã‚¯ã‚¿ãƒ¼:**
- [ ] **ã‚¹ã‚­ãƒ¼ãƒæ•´åˆæ€§**: ãƒ¢ãƒƒã‚¯ãƒ‡ãƒ¼ã‚¿ã¨Office 365 APIã®ã‚¹ã‚­ãƒ¼ãƒãŒä¸€è‡´ã—ã¦ã„ã‚‹ã‹
  ```typescript
  // âœ… ç¢ºèªé …ç›®: å®Ÿéš›ã®APIå¿œç­”ãŒãƒ¢ãƒƒã‚¯ã¨åŒã˜æ§‹é€ ã‹
  console.log('Office 365 API Response:', JSON.stringify(realUser, null, 2));
  console.log('Mock Data Structure:', JSON.stringify(mockUser, null, 2));
  ```

- [ ] **ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£åã®ä¸€è‡´**: `displayName`, `mail`, `jobTitle`, `department` ç­‰
- [ ] **ãƒ‡ãƒ¼ã‚¿å‹ã®ç¢ºèª**: æ–‡å­—åˆ—ã€é…åˆ—ã€booleanã€æ—¥ä»˜å‹ãŒæ­£ã—ã„ã‹
- [ ] **null/undefinedå‡¦ç†**: å®Ÿéš›ã®APIã§ç©ºå€¤ãŒè¿”ã•ã‚Œã‚‹å ´åˆã®å‡¦ç†

**Dataverse ã‚³ãƒã‚¯ã‚¿ãƒ¼:**
- [ ] **ãƒ†ãƒ¼ãƒ–ãƒ«ã‚¹ã‚­ãƒ¼ãƒ**: Dataverseãƒ†ãƒ¼ãƒ–ãƒ«ã®ã‚«ãƒ©ãƒ åãƒ»å‹ãŒãƒ¢ãƒƒã‚¯ã¨ä¸€è‡´
  ```typescript
  // âœ… ç¢ºèª: Dataverseå®Ÿãƒ‡ãƒ¼ã‚¿ã®ã‚¹ã‚­ãƒ¼ãƒ
  console.log('Dataverse Entity:', JSON.stringify(realProject, null, 2));
  ```

- [ ] **ä¸»ã‚­ãƒ¼ã®æ­£ç¢ºæ€§**: `Id`ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®å½¢å¼ï¼ˆGUID vs æ•°å€¤ï¼‰
- [ ] **é¸æŠè‚¢ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰**: Statusã‚„Priorityã®å€¤ãŒãƒ¢ãƒƒã‚¯ã¨ä¸€è‡´
- [ ] **é–¢é€£ãƒ¬ã‚³ãƒ¼ãƒ‰**: Lookup/é–¢é€£ãƒ†ãƒ¼ãƒ–ãƒ«ã®ãƒ‡ãƒ¼ã‚¿æ§‹é€ 

**SQL Server ã‚³ãƒã‚¯ã‚¿ãƒ¼:**
- [ ] **ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¹ã‚­ãƒ¼ãƒ**: ãƒ†ãƒ¼ãƒ–ãƒ«æ§‹é€ ãŒãƒ¢ãƒƒã‚¯å®šç¾©ã¨ä¸€è‡´
  ```sql
  -- âœ… ç¢ºèª: å®Ÿéš›ã®ãƒ†ãƒ¼ãƒ–ãƒ«æ§‹é€ 
  SELECT COLUMN_NAME, DATA_TYPE, IS_NULLABLE 
  FROM INFORMATION_SCHEMA.COLUMNS 
  WHERE TABLE_NAME = 'Projects';
  ```

- [ ] **ã‚«ãƒ©ãƒ åã®ä¸€è‡´**: å¤§æ–‡å­—å°æ–‡å­—ã€ã‚¢ãƒ³ãƒ€ãƒ¼ã‚¹ã‚³ã‚¢ã€ã‚­ãƒ£ãƒ¡ãƒ«ã‚±ãƒ¼ã‚¹
- [ ] **ãƒ‡ãƒ¼ã‚¿å‹äº’æ›æ€§**: VARCHAR, INT, DATETIME, DECIMALç­‰
- [ ] **NULLåˆ¶ç´„**: NOT NULLåˆ¶ç´„ãŒãƒ¢ãƒƒã‚¯ä»•æ§˜ã¨ä¸€è‡´

#### **ğŸ¨ UIè¡¨ç¤ºæ¤œè¨¼**

**ãƒ‡ãƒ¼ã‚¿è¡¨ç¤ºã®æ­£ç¢ºæ€§:**
- [ ] **å…¨ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰è¡¨ç¤º**: ãƒ¢ãƒƒã‚¯ã§è¡¨ç¤ºã—ã¦ã„ãŸå…¨é …ç›®ãŒãƒªã‚¢ãƒ«ãƒ‡ãƒ¼ã‚¿ã§ã‚‚è¡¨ç¤º
- [ ] **æ—¥æœ¬èªæ–‡å­—åŒ–ã‘**: æ—¥æœ¬èªãƒ‡ãƒ¼ã‚¿ãŒæ­£ã—ãè¡¨ç¤ºã•ã‚Œã‚‹ã‹
- [ ] **æ•°å€¤ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ**: é€šè²¨ã€æ—¥ä»˜ã€ãƒ‘ãƒ¼ã‚»ãƒ³ãƒ†ãƒ¼ã‚¸ã®è¡¨ç¤ºå½¢å¼
- [ ] **ç”»åƒãƒ»ãƒ•ã‚¡ã‚¤ãƒ«**: ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ç”»åƒã‚„ã‚¢ã‚¤ã‚³ãƒ³ãŒæ­£ã—ãè¡¨ç¤º

**ãƒªã‚¹ãƒˆãƒ“ãƒ¥ãƒ¼æ¤œè¨¼:**
- [ ] **ã‚½ãƒ¼ãƒˆæ©Ÿèƒ½**: åå‰ã€æ—¥ä»˜ã€ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ç­‰ã®ã‚½ãƒ¼ãƒˆãŒå‹•ä½œ
- [ ] **ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼æ©Ÿèƒ½**: æ¤œç´¢ãƒ»çµã‚Šè¾¼ã¿ãŒãƒªã‚¢ãƒ«ãƒ‡ãƒ¼ã‚¿ã§å‹•ä½œ
- [ ] **ãƒšãƒ¼ã‚¸ãƒ³ã‚°**: å¤§é‡ãƒ‡ãƒ¼ã‚¿ã§ã®ãƒšãƒ¼ã‚¸ãƒ³ã‚°å‹•ä½œ
- [ ] **ç©ºãƒ‡ãƒ¼ã‚¿å‡¦ç†**: ãƒ‡ãƒ¼ã‚¿ãŒ0ä»¶ã®å ´åˆã®è¡¨ç¤º

**è©³ç´°ãƒ“ãƒ¥ãƒ¼æ¤œè¨¼:**
- [ ] **è©³ç´°ç”»é¢**: å€‹åˆ¥ãƒ¬ã‚³ãƒ¼ãƒ‰ã®è©³ç´°è¡¨ç¤ºãŒæ­£å¸¸
- [ ] **ç·¨é›†ãƒ•ã‚©ãƒ¼ãƒ **: ãƒ•ã‚©ãƒ¼ãƒ é …ç›®ãŒãƒªã‚¢ãƒ«ãƒ‡ãƒ¼ã‚¿æ§‹é€ ã«å¯¾å¿œ
- [ ] **ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³**: å¿…é ˆé …ç›®ã€æ–‡å­—æ•°åˆ¶é™ç­‰ãŒæ­£ã—ãå‹•ä½œ

#### **ğŸ“ ãƒ•ã‚©ãƒ¼ãƒ é–¢é€£ãƒ†ã‚¹ãƒˆï¼ˆé‡è¦ï¼‰**

**æ–°è¦ä½œæˆãƒ•ã‚©ãƒ¼ãƒ ãƒ†ã‚¹ãƒˆ:**
- [ ] **ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰æ§‹é€ **: ãƒ¢ãƒƒã‚¯ãƒ‡ãƒ¼ã‚¿å®šç¾©ã¨ãƒªã‚¢ãƒ«APIã‚¹ã‚­ãƒ¼ãƒãŒä¸€è‡´
  ```typescript
  // âœ… ç¢ºèªé …ç›®: æ–°è¦ä½œæˆãƒ•ã‚©ãƒ¼ãƒ ã®å…¨ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰
  const createFormFields = [
    'displayName', 'jobTitle', 'department', 'mail', 
    'businessPhones', 'officeLocation', 'city', 'country'
  ];
  // ãƒªã‚¢ãƒ«APIã§ä½œæˆå¯èƒ½ãªå…¨ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ãŒãƒ•ã‚©ãƒ¼ãƒ ã«å«ã¾ã‚Œã¦ã„ã‚‹ã‹
  ```

- [ ] **å¿…é ˆãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰**: ãƒªã‚¢ãƒ«ç’°å¢ƒã§ã®å¿…é ˆé …ç›®ãŒãƒ•ã‚©ãƒ¼ãƒ ã§é©åˆ‡ã«è¨­å®š
- [ ] **ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤**: æ–°è¦ä½œæˆæ™‚ã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ãŒãƒªã‚¢ãƒ«ç’°å¢ƒã«é©åˆ
- [ ] **é¸æŠè‚¢ãƒ‡ãƒ¼ã‚¿**: ãƒ‰ãƒ­ãƒƒãƒ—ãƒ€ã‚¦ãƒ³ç­‰ã®é¸æŠè‚¢ãŒãƒªã‚¢ãƒ«ãƒ‡ãƒ¼ã‚¿ã‹ã‚‰å–å¾—
- [ ] **Auto-Complete**: ãƒ¦ãƒ¼ã‚¶ãƒ¼å…¥åŠ›æ™‚ã®å€™è£œè¡¨ç¤ºãŒãƒªã‚¢ãƒ«ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹
- [ ] **é–¢é€£ãƒ‡ãƒ¼ã‚¿å–å¾—**: éƒ¨ç½²ä¸€è¦§ã€å½¹è·ä¸€è¦§ç­‰ãŒãƒªã‚¢ãƒ«ã‚½ãƒ¼ã‚¹ã‹ã‚‰å–å¾—

**ç·¨é›†ãƒ•ã‚©ãƒ¼ãƒ ãƒ†ã‚¹ãƒˆ:**
- [ ] **æ—¢å­˜ãƒ‡ãƒ¼ã‚¿è¡¨ç¤º**: ãƒªã‚¢ãƒ«ãƒ‡ãƒ¼ã‚¿ãŒãƒ•ã‚©ãƒ¼ãƒ ã«æ­£ç¢ºã«èª­ã¿è¾¼ã¾ã‚Œã‚‹
  ```typescript
  // âœ… ç¢ºèªé …ç›®: ç·¨é›†ãƒ•ã‚©ãƒ¼ãƒ ã§ã®ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿
  console.log('Original Data:', originalRecord);
  console.log('Form Initial Values:', formInitialValues);
  // å…¨ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ãŒæ­£ç¢ºã«ãƒ•ã‚©ãƒ¼ãƒ ã«åæ˜ ã•ã‚Œã¦ã„ã‚‹ã‹
  ```

- [ ] **éƒ¨åˆ†æ›´æ–°**: å¤‰æ›´ã—ãŸé …ç›®ã®ã¿ãŒãƒªã‚¢ãƒ«ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«ä¿å­˜ã•ã‚Œã‚‹
- [ ] **ç«¶åˆåˆ¶å¾¡**: åŒæ™‚ç·¨é›†æ™‚ã®é©åˆ‡ãªç«¶åˆå‡¦ç†
- [ ] **å¤‰æ›´æ¤œçŸ¥**: æœªä¿å­˜å¤‰æ›´ã®è­¦å‘Šè¡¨ç¤º
- [ ] **ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ¤œè¨¼**: å…¥åŠ›ä¸­ã®ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³
- [ ] **é–¢é€£ãƒ‡ãƒ¼ã‚¿æ›´æ–°**: é–¢é€£ãƒ¬ã‚³ãƒ¼ãƒ‰ã®è‡ªå‹•æ›´æ–°

**ãƒ•ã‚©ãƒ¼ãƒ å…±é€šãƒ†ã‚¹ãƒˆ:**
- [ ] **ãƒ‡ãƒ¼ã‚¿å‹å¤‰æ›**: æ–‡å­—åˆ—â‡”æ•°å€¤â‡”æ—¥ä»˜ã®é©åˆ‡ãªå¤‰æ›
  ```typescript
  // âœ… ãƒ‡ãƒ¼ã‚¿å‹ãƒãƒƒãƒ”ãƒ³ã‚°ç¢ºèª
  const typeMapping = {
    'budget': 'number',      // äºˆç®—: æ•°å€¤å‹
    'dueDate': 'Date',       // æœŸé™: æ—¥ä»˜å‹  
    'priority': 'string',    // å„ªå…ˆåº¦: æ–‡å­—åˆ—å‹
    'isActive': 'boolean'    // æœ‰åŠ¹: çœŸå½å€¤å‹
  };
  ```

- [ ] **æ–‡å­—ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°**: æ—¥æœ¬èªæ–‡å­—ã®æ­£ç¢ºãªä¿å­˜ãƒ»è¡¨ç¤º
- [ ] **ç‰¹æ®Šæ–‡å­—å‡¦ç†**: è¨˜å·ã€çµµæ–‡å­—ã€æ”¹è¡Œç­‰ã®é©åˆ‡ãªå‡¦ç†
- [ ] **ãƒ•ã‚¡ã‚¤ãƒ«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰**: ç”»åƒã‚„ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰æ©Ÿèƒ½
- [ ] **è¤‡æ•°å€¤ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰**: é…åˆ—ãƒ‡ãƒ¼ã‚¿ï¼ˆé›»è©±ç•ªå·ã€ã‚¿ã‚°ç­‰ï¼‰ã®å‡¦ç†

#### **ğŸ¯ ã‚³ãƒã‚¯ã‚¿ãƒ¼åˆ¥ãƒ•ã‚©ãƒ¼ãƒ ãƒ†ã‚¹ãƒˆ**

**Office 365 ãƒ•ã‚©ãƒ¼ãƒ ãƒ†ã‚¹ãƒˆ:**
- [ ] **ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ä½œæˆ**: Office 365ç’°å¢ƒã§ã®æ–°è¦ãƒ¦ãƒ¼ã‚¶ãƒ¼ä½œæˆ
- [ ] **ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«æ›´æ–°**: æ—¢å­˜ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®æƒ…å ±æ›´æ–°
- [ ] **çµ„ç¹”æƒ…å ±é€£æº**: éƒ¨ç½²ã€ç®¡ç†è€…æƒ…å ±ã®è‡ªå‹•å–å¾—ãƒ»è¨­å®š
- [ ] **ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ç®¡ç†**: ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã®å‰²ã‚Šå½“ã¦ãƒ»å¤‰æ›´
- [ ] **ã‚°ãƒ«ãƒ¼ãƒ—æ‰€å±**: ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚°ãƒ«ãƒ¼ãƒ—ã€é…å¸ƒãƒªã‚¹ãƒˆã®ç®¡ç†

**Dataverse ãƒ•ã‚©ãƒ¼ãƒ ãƒ†ã‚¹ãƒˆ:**
- [ ] **ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ä½œæˆ**: ã‚«ã‚¹ã‚¿ãƒ ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã§ã®æ–°è¦ãƒ¬ã‚³ãƒ¼ãƒ‰ä½œæˆ
  ```typescript
  // âœ… Dataverseä½œæˆãƒ†ã‚¹ãƒˆ
  const projectData = {
    name: 'ãƒ†ã‚¹ãƒˆãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ',
    description: 'ç§»è¡Œãƒ†ã‚¹ãƒˆç”¨ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ',
    statuscode: 1,           // ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹é¸æŠè‚¢
    prioritycode: 100000002, // å„ªå…ˆåº¦é¸æŠè‚¢
    estimatedbudget: 5000000 // é€šè²¨ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰
  };
  ```

- [ ] **ãƒ«ãƒƒã‚¯ã‚¢ãƒƒãƒ—ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰**: é–¢é€£ãƒ¬ã‚³ãƒ¼ãƒ‰ã®é¸æŠãƒ»è¡¨ç¤º
- [ ] **é¸æŠè‚¢ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰**: OptionSetã®å€¤ãŒæ­£ç¢ºã«ä¿å­˜
- [ ] **è¨ˆç®—ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰**: è¨ˆç®—å¼ãŒé©åˆ‡ã«å‹•ä½œ
- [ ] **ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼é€£æº**: ãƒ•ã‚©ãƒ¼ãƒ é€ä¿¡æ™‚ã®ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼å®Ÿè¡Œ

**SQL Server ãƒ•ã‚©ãƒ¼ãƒ ãƒ†ã‚¹ãƒˆ:**
- [ ] **ãƒ†ãƒ¼ãƒ–ãƒ«ä½œæˆ**: SQL Serverã§ã®æ–°è¦ãƒ¬ã‚³ãƒ¼ãƒ‰æŒ¿å…¥
  ```sql
  -- âœ… SQL Serverä½œæˆãƒ†ã‚¹ãƒˆ
  INSERT INTO Projects (Name, Description, Status, Priority, Budget, CreatedDate)
  VALUES ('ç§»è¡Œãƒ†ã‚¹ãƒˆãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ', 'ãƒ•ã‚©ãƒ¼ãƒ ã‹ã‚‰ã®ãƒ†ã‚¹ãƒˆä½œæˆ', 'Planning', 'High', 3000000, GETDATE());
  ```

- [ ] **åˆ¶ç´„ãƒã‚§ãƒƒã‚¯**: NOT NULLã€UNIQUEã€CHECKåˆ¶ç´„ã®å‹•ä½œ
- [ ] **å¤–éƒ¨ã‚­ãƒ¼**: é–¢é€£ãƒ†ãƒ¼ãƒ–ãƒ«ã¨ã®æ•´åˆæ€§
- [ ] **ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³**: è¤‡æ•°ãƒ†ãƒ¼ãƒ–ãƒ«æ›´æ–°ã®åŸå­æ€§
- [ ] **ã‚¹ãƒˆã‚¢ãƒ‰ãƒ—ãƒ­ã‚·ãƒ¼ã‚¸ãƒ£**: è¤‡é›‘ãªæ¥­å‹™ãƒ­ã‚¸ãƒƒã‚¯ã®å®Ÿè¡Œ

#### **ğŸ”§ ãƒ•ã‚©ãƒ¼ãƒ ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ†ã‚¹ãƒˆ**

**ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚µã‚¤ãƒ‰ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³:**
- [ ] **å¿…é ˆãƒã‚§ãƒƒã‚¯**: å¿…é ˆãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®ç©ºç™½ãƒã‚§ãƒƒã‚¯
- [ ] **å½¢å¼ãƒã‚§ãƒƒã‚¯**: ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã€é›»è©±ç•ªå·ã®å½¢å¼æ¤œè¨¼
- [ ] **æ–‡å­—æ•°ãƒã‚§ãƒƒã‚¯**: æœ€å°ãƒ»æœ€å¤§æ–‡å­—æ•°ã®åˆ¶é™
- [ ] **æ•°å€¤ç¯„å›²**: äºˆç®—ã€å¹´é½¢ç­‰ã®æ•°å€¤ç¯„å›²ãƒã‚§ãƒƒã‚¯
- [ ] **æ—¥ä»˜å¦¥å½“æ€§**: é–‹å§‹æ—¥â‰¤çµ‚äº†æ—¥ç­‰ã®æ—¥ä»˜ãƒ­ã‚¸ãƒƒã‚¯

**ã‚µãƒ¼ãƒãƒ¼ã‚µã‚¤ãƒ‰ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³:**
- [ ] **é‡è¤‡ãƒã‚§ãƒƒã‚¯**: ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã€IDç­‰ã®ä¸€æ„æ€§ç¢ºèª
- [ ] **æ¨©é™ãƒã‚§ãƒƒã‚¯**: ä½œæˆãƒ»ç·¨é›†æ¨©é™ã®ç¢ºèª
- [ ] **ãƒ“ã‚¸ãƒã‚¹ãƒ«ãƒ¼ãƒ«**: æ¥­å‹™å›ºæœ‰ã®åˆ¶ç´„äº‹é …
- [ ] **æ•´åˆæ€§ãƒã‚§ãƒƒã‚¯**: é–¢é€£ãƒ‡ãƒ¼ã‚¿ã¨ã®æ•´åˆæ€§ç¢ºèª

#### **ğŸ“± ãƒ•ã‚©ãƒ¼ãƒ UI/UXãƒ†ã‚¹ãƒˆ**

**å¿œç­”æ€§ãƒ†ã‚¹ãƒˆ:**
- [ ] **ä¿å­˜é€Ÿåº¦**: ãƒ•ã‚©ãƒ¼ãƒ é€ä¿¡å¾Œ3ç§’ä»¥å†…ã§ã®å¿œç­”
- [ ] **ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³é€Ÿåº¦**: ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ¤œè¨¼ã®å¿œç­”æ€§
- [ ] **ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿**: ç·¨é›†ãƒ•ã‚©ãƒ¼ãƒ è¡¨ç¤ºæ™‚é–“
- [ ] **å¤§é‡ãƒ‡ãƒ¼ã‚¿**: é¸æŠè‚¢ãŒ1000ä»¶ä»¥ä¸Šã®å ´åˆã®æ€§èƒ½

**ãƒ¦ãƒ¼ã‚¶ãƒ“ãƒªãƒ†ã‚£ãƒ†ã‚¹ãƒˆ:**
- [ ] **ã‚¨ãƒ©ãƒ¼è¡¨ç¤º**: ã‚ã‹ã‚Šã‚„ã™ã„ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
- [ ] **æˆåŠŸé€šçŸ¥**: ä¿å­˜å®Œäº†ã®æ˜ç¢ºãªé€šçŸ¥
- [ ] **é€²è¡ŒçŠ¶æ³**: é•·æ™‚é–“å‡¦ç†ã§ã®é€²æ—è¡¨ç¤º
- [ ] **è‡ªå‹•ä¿å­˜**: ä¸€å®šé–“éš”ã§ã®ä¸‹æ›¸ãä¿å­˜
- [ ] **å¾©å…ƒæ©Ÿèƒ½**: ãƒ–ãƒ©ã‚¦ã‚¶ã‚¯ãƒ©ãƒƒã‚·ãƒ¥æ™‚ã®å…¥åŠ›å†…å®¹å¾©å…ƒ

#### **ğŸ§ª ãƒ•ã‚©ãƒ¼ãƒ ç§»è¡Œãƒ†ã‚¹ãƒˆå®Ÿè¡Œæ‰‹é †**

**Step 1: ãƒ•ã‚©ãƒ¼ãƒ æ©Ÿèƒ½ã®æ£šå¸ã—**
```typescript
// src/tests/formMigration.test.ts
describe('Form Migration Tests', () => {
  // æ–°è¦ä½œæˆãƒ•ã‚©ãƒ¼ãƒ ãƒ†ã‚¹ãƒˆ
  test('Create Form - All fields work with real data', async () => {
    const formData = {
      // ãƒ¢ãƒƒã‚¯ãƒ‡ãƒ¼ã‚¿æ§‹é€ ã¨åŒã˜ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰
      displayName: 'ãƒ†ã‚¹ãƒˆãƒ¦ãƒ¼ã‚¶ãƒ¼',
      jobTitle: 'ãƒ†ã‚¹ãƒˆã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢',
      department: 'ITéƒ¨é–€',
      mail: 'test@company.com'
    };
    
    const result = await createUser(formData);
    expect(result.success).toBe(true);
    expect(result.data.id).toBeDefined();
  });
  
  // ç·¨é›†ãƒ•ã‚©ãƒ¼ãƒ ãƒ†ã‚¹ãƒˆ  
  test('Edit Form - Loads and saves real data correctly', async () => {
    const existingUser = await getUser('test-user-id');
    const updatedData = { ...existingUser, jobTitle: 'æ›´æ–°ã•ã‚ŒãŸè·ç¨®' };
    
    const result = await updateUser(existingUser.id, updatedData);
    expect(result.success).toBe(true);
    expect(result.data.jobTitle).toBe('æ›´æ–°ã•ã‚ŒãŸè·ç¨®');
  });
});
```

**Step 2: ãƒ•ã‚©ãƒ¼ãƒ åˆ¥å‹•ä½œç¢ºèª**
```bash
# å„ãƒ•ã‚©ãƒ¼ãƒ ã§ã®å®Ÿå‹•ä½œãƒ†ã‚¹ãƒˆ
npm run test:forms:create   # æ–°è¦ä½œæˆãƒ•ã‚©ãƒ¼ãƒ 
npm run test:forms:edit     # ç·¨é›†ãƒ•ã‚©ãƒ¼ãƒ   
npm run test:forms:bulk     # ä¸€æ‹¬æ“ä½œãƒ•ã‚©ãƒ¼ãƒ 
npm run test:forms:import   # ãƒ‡ãƒ¼ã‚¿ã‚¤ãƒ³ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒ¼ãƒ 
```

**Step 3: ã‚¨ãƒ³ãƒ‰ãƒ„ãƒ¼ã‚¨ãƒ³ãƒ‰ãƒ†ã‚¹ãƒˆ**
```typescript
// e2e/formWorkflow.test.ts  
test('Complete form workflow with real data', async () => {
  // 1. æ–°è¦ä½œæˆ
  await page.click('[data-testid="create-button"]');
  await page.fill('[name="displayName"]', 'E2Eãƒ†ã‚¹ãƒˆãƒ¦ãƒ¼ã‚¶ãƒ¼');
  await page.click('[type="submit"]');
  
  // 2. ä½œæˆç¢ºèª
  await expect(page.locator('.success-message')).toBeVisible();
  
  // 3. ç·¨é›†
  await page.click('[data-testid="edit-button"]');
  await page.fill('[name="jobTitle"]', 'æ›´æ–°ã•ã‚ŒãŸè·ç¨®');
  await page.click('[type="submit"]');
  
  // 4. æ›´æ–°ç¢ºèª  
  await expect(page.locator('.success-message')).toBeVisible();
});
```

ã“ã®è©³ç´°ãªãƒ•ã‚©ãƒ¼ãƒ ãƒ†ã‚¹ãƒˆã«ã‚ˆã‚Šã€ãƒ¢ãƒƒã‚¯ãƒ‡ãƒ¼ã‚¿ã‹ã‚‰ãƒªã‚¢ãƒ«ãƒ‡ãƒ¼ã‚¿ã¸ã®ç§»è¡Œæ™‚ã«ã€å…¨ã¦ã®ãƒ•ã‚©ãƒ¼ãƒ æ©Ÿèƒ½ãŒæ­£å¸¸ã«å‹•ä½œã™ã‚‹ã“ã¨ã‚’ç¢ºå®Ÿã«æ¤œè¨¼ã§ãã¾ã™ã€‚

#### **âš¡ æ©Ÿèƒ½å‹•ä½œãƒ†ã‚¹ãƒˆ**

**CRUDæ“ä½œãƒ†ã‚¹ãƒˆ:**
- [ ] **ä½œæˆï¼ˆCreateï¼‰**: æ–°è¦ãƒ‡ãƒ¼ã‚¿ä½œæˆãŒãƒªã‚¢ãƒ«ç’°å¢ƒã§å‹•ä½œ
- [ ] **èª­ã¿å–ã‚Šï¼ˆReadï¼‰**: ãƒ‡ãƒ¼ã‚¿å–å¾—ãƒ»è¡¨ç¤ºãŒæ­£å¸¸
- [ ] **æ›´æ–°ï¼ˆUpdateï¼‰**: ãƒ‡ãƒ¼ã‚¿ç·¨é›†ãƒ»ä¿å­˜ãŒæ­£å¸¸
- [ ] **å‰Šé™¤ï¼ˆDeleteï¼‰**: ãƒ‡ãƒ¼ã‚¿å‰Šé™¤ãŒæ­£å¸¸ï¼ˆâ€»è¦æ³¨æ„ï¼‰

**æ¤œç´¢ãƒ»ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼æ©Ÿèƒ½:**
- [ ] **ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰æ¤œç´¢**: å®Ÿéš›ã®ãƒ‡ãƒ¼ã‚¿ã§æ¤œç´¢æ©Ÿèƒ½ãŒå‹•ä½œ
- [ ] **é«˜åº¦ãªæ¤œç´¢**: è¤‡æ•°æ¡ä»¶ã§ã®çµã‚Šè¾¼ã¿
- [ ] **ã‚ªãƒ¼ãƒˆã‚³ãƒ³ãƒ—ãƒªãƒ¼ãƒˆ**: å€™è£œè¡¨ç¤ºæ©Ÿèƒ½

**çµ±åˆæ©Ÿèƒ½ãƒ†ã‚¹ãƒˆ:**
- [ ] **ã‚¯ãƒ­ã‚¹ã‚³ãƒã‚¯ã‚¿ãƒ¼**: Office 365 + SQLç­‰ã®è¤‡åˆå‡¦ç†
- [ ] **ãƒ‡ãƒ¼ã‚¿åŒæœŸ**: è¤‡æ•°ã‚½ãƒ¼ã‚¹é–“ã®ãƒ‡ãƒ¼ã‚¿æ•´åˆæ€§
- [ ] **ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ›´æ–°**: ãƒ‡ãƒ¼ã‚¿å¤‰æ›´ã®å³åº§åæ˜ 

#### **ğŸš¨ ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°æ¤œè¨¼**

**æ¥ç¶šã‚¨ãƒ©ãƒ¼å¯¾å¿œ:**
- [ ] **èªè¨¼ã‚¨ãƒ©ãƒ¼**: æ¨©é™ä¸è¶³æ™‚ã®é©åˆ‡ãªã‚¨ãƒ©ãƒ¼è¡¨ç¤º
- [ ] **ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¨ãƒ©ãƒ¼**: æ¥ç¶šæ–­æ™‚ã®å‡¦ç†
- [ ] **ãƒ‡ãƒ¼ã‚¿ä¸æ•´åˆ**: æƒ³å®šå¤–ã®ãƒ‡ãƒ¼ã‚¿å½¢å¼ã¸ã®å¯¾å¿œ

**ãƒ¦ãƒ¼ã‚¶ãƒ“ãƒªãƒ†ã‚£:**
- [ ] **ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¡¨ç¤º**: ãƒ‡ãƒ¼ã‚¿å–å¾—ä¸­ã®é©åˆ‡ãªè¡¨ç¤º
- [ ] **ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸**: ã‚ã‹ã‚Šã‚„ã™ã„ã‚¨ãƒ©ãƒ¼é€šçŸ¥
- [ ] **ãƒªãƒˆãƒ©ã‚¤æ©Ÿèƒ½**: å¤±æ•—æ™‚ã®å†è©¦è¡Œã‚ªãƒ—ã‚·ãƒ§ãƒ³

#### **ğŸ“Š ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆ**

**ãƒ¬ã‚¹ãƒãƒ³ã‚¹æ™‚é–“:**
- [ ] **åˆæœŸè¡¨ç¤º**: 5ç§’ä»¥å†…ã§ã®ãƒ‡ãƒ¼ã‚¿è¡¨ç¤º
- [ ] **æ¤œç´¢å¿œç­”**: 3ç§’ä»¥å†…ã§ã®æ¤œç´¢çµæœè¡¨ç¤º
- [ ] **ãƒšãƒ¼ã‚¸ãƒ³ã‚°**: ã‚¹ãƒ ãƒ¼ã‚ºãªãƒšãƒ¼ã‚¸åˆ‡ã‚Šæ›¿ãˆ

**å¤§é‡ãƒ‡ãƒ¼ã‚¿å¯¾å¿œ:**
- [ ] **100ä»¶ä»¥ä¸Š**: å¤§é‡ãƒ‡ãƒ¼ã‚¿ã§ã®è¡¨ç¤ºæ€§èƒ½
- [ ] **1000ä»¶ä»¥ä¸Š**: æ¤œç´¢ãƒ»ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼æ€§èƒ½
- [ ] **ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡**: ãƒ–ãƒ©ã‚¦ã‚¶ã§ã®ãƒ¡ãƒ¢ãƒªãƒªãƒ¼ã‚¯ç¢ºèª

### **ğŸ”§ ç§»è¡Œãƒ†ã‚¹ãƒˆå®Ÿè¡Œæ‰‹é †**

#### **Step 1: æ®µéšçš„åˆ‡ã‚Šæ›¿ãˆãƒ†ã‚¹ãƒˆ**
```typescript
// src/config/dataSource.ts - åˆ‡ã‚Šæ›¿ãˆç”¨è¨­å®š
export const DATA_SOURCE_CONFIG = {
  useRealData: process.env.NODE_ENV === 'production', // ç’°å¢ƒã«ã‚ˆã‚‹è‡ªå‹•åˆ‡ã‚Šæ›¿ãˆ
  office365: {
    useMock: false, // ãƒªã‚¢ãƒ«ãƒ‡ãƒ¼ã‚¿ä½¿ç”¨
    mockFallback: true // ã‚¨ãƒ©ãƒ¼æ™‚ã¯ãƒ¢ãƒƒã‚¯ä½¿ç”¨
  },
  dataverse: {
    useMock: false,
    mockFallback: true
  },
  sql: {
    useMock: false,
    mockFallback: true
  }
};
```

#### **Step 2: A/Bãƒ†ã‚¹ãƒˆæ¯”è¼ƒ**
```typescript
// åŒã˜ç”»é¢ã§ãƒ¢ãƒƒã‚¯ã¨ãƒªã‚¢ãƒ«ãƒ‡ãƒ¼ã‚¿ã‚’æ¯”è¼ƒè¡¨ç¤º
const ComparisonTest = () => {
  const [showMock, setShowMock] = useState(true);
  
  return (
    <div className="flex gap-4">
      <div className="w-1/2">
        <h3>Mock Data</h3>
        <UserListMock />
      </div>
      <div className="w-1/2">
        <h3>Real Data</h3>
        <UserListReal />
      </div>
    </div>
  );
};
```

#### **Step 3: è‡ªå‹•ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ**
```bash
# ç§»è¡Œãƒ†ã‚¹ãƒˆç”¨ã®ãƒ†ã‚¹ãƒˆã‚¹ã‚¤ãƒ¼ãƒˆå®Ÿè¡Œ
npm run test:migration

# å„ã‚³ãƒã‚¯ã‚¿ãƒ¼åˆ¥ãƒ†ã‚¹ãƒˆ
npm run test:office365
npm run test:dataverse  
npm run test:sql

# çµ±åˆãƒ†ã‚¹ãƒˆ
npm run test:integration
```

### **âš ï¸ ç§»è¡Œæ™‚ã®é‡è¦ãªæ³¨æ„äº‹é …**

1. **ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—**: æœ¬ç•ªãƒ‡ãƒ¼ã‚¿ã‚’æ‰±ã†å ´åˆã¯å¿…ãšãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‚’å–å¾—
2. **æ®µéšçš„ç§»è¡Œ**: ä¸€åº¦ã«å…¨ã‚³ãƒã‚¯ã‚¿ãƒ¼ã‚’åˆ‡ã‚Šæ›¿ãˆãšã€æ®µéšçš„ã«å®Ÿæ–½
3. **ãƒ¢ãƒ‹ã‚¿ãƒªãƒ³ã‚°**: ç§»è¡Œå¾Œã—ã°ã‚‰ãã¯ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°ã‚’æ³¨æ„æ·±ãç›£è¦–
4. **ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯è¨ˆç”»**: å•é¡Œç™ºç”Ÿæ™‚ã®å…ƒã«æˆ»ã™æ‰‹é †ã‚’æº–å‚™
5. **ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ†ã‚¹ãƒˆ**: æŠ€è¡“çš„ãƒ†ã‚¹ãƒˆã ã‘ã§ãªãã€å®Ÿéš›ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã§ã®å‹•ä½œç¢ºèª

ã“ã®ç§»è¡Œãƒ†ã‚¹ãƒˆã‚’å®Œäº†ã™ã‚‹ã“ã¨ã§ã€ãƒ¢ãƒƒã‚¯ãƒ‡ãƒ¼ã‚¿ã¨ãƒªã‚¢ãƒ«ãƒ‡ãƒ¼ã‚¿é–“ã§ã®ã‚®ãƒ£ãƒƒãƒ—ã‚’æœ€å°åŒ–ã—ã€æœ¬ç•ªç’°å¢ƒã§ã®å®‰å®šå‹•ä½œã‚’ç¢ºä¿ã§ãã¾ã™ã€‚

### ğŸ—‘ï¸ **ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹å‰Šé™¤ (å¿…è¦æ™‚)**

```bash
# ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹å‰Šé™¤
pac code delete-data-source -a "shared_office365users" -ds "Office365Users"

# é‡è¦: æ¥ç¶šã®ã‚¹ã‚­ãƒ¼ãƒãŒå¤‰æ›´ã•ã‚ŒãŸå ´åˆã€
#       ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ã‚’å‰Šé™¤ã—ã¦ã‹ã‚‰å†è¿½åŠ ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™
```

### ğŸš€ **Step 4: ã‚¢ãƒ—ãƒªã§ã®æ¥ç¶šå‘¼ã³å‡ºã—å®Ÿè£…**

#### **4.1 Office 365 Users å®Ÿè£…ãƒ‘ã‚¿ãƒ¼ãƒ³ (Microsoft å…¬å¼)**

**React Hook ã§ã®å®Ÿè£…**:

```typescript
// src/hooks/useCurrentUser.ts
import { useState, useEffect } from 'react';
import { Office365UsersService } from '../generated/services/Office365UsersService';

export interface UserProfile {
  id?: string;
  displayName?: string;
  jobTitle?: string;
  userPrincipalName?: string;
  photo?: string;
}

export const useCurrentUser = () => {
  const [user, setUser] = useState<UserProfile | null>(null);
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState<string | null>(null);

  useEffect(() => {
    const fetchProfile = async () => {
      try {
        setLoading(true);
        
        // Microsoft å…¬å¼ API ãƒ‘ã‚¿ãƒ¼ãƒ³ - ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«å–å¾—
        const profile = (await Office365UsersService.MyProfile_V2(
          "id,displayName,jobTitle,userPrincipalName"
        )).data;
        
        setUser(profile);
        
            if (profile.userPrincipalName) {
              try {
                photoData = (await Office365UsersService.UserPhoto_V2(
                  profile.userPrincipalName
                )).data;
              } catch {
                console.log('ãƒ¦ãƒ¼ã‚¶ãƒ¼å†™çœŸãŒåˆ©ç”¨ã§ãã¾ã›ã‚“');
              }
            }
          }
          
          if (photoData) {
            setUser(prev => ({ 
              ...prev, 
              ...profile, 
              photo: `data:image/jpeg;base64,${photoData}` 
            }));
          }
        }
      } catch (err) {
        console.error('Failed to fetch user profile:', err);
        setError('ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ã®å–å¾—ã«å¤±æ•—ã—ã¾ã—ãŸ');
      } finally {
        setLoading(false);
      }
    };

    fetchProfile();
  }, []);

  return { user, loading, error };
};
```

**ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã§ã®ä½¿ç”¨ä¾‹**:

```typescript
// src/components/UserProfile.tsx  
import React from 'react';
import { useCurrentUser } from '../hooks/useCurrentUser';

export const UserProfile: React.FC = () => {
  const { user, loading, error } = useCurrentUser();

  if (loading) return <div>ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«èª­ã¿è¾¼ã¿ä¸­...</div>;
  if (error) return <div>ã‚¨ãƒ©ãƒ¼: {error}</div>;
  if (!user) return <div>ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“</div>;

  return (
    <div className="user-profile">
      {user.photo && (
        <img 
          src={user.photo} 
          alt="User Avatar" 
          className="w-12 h-12 rounded-full"
        />
      )}
      <div>
        <h3>{user.displayName}</h3>
        <p>{user.jobTitle}</p>
        <p>{user.userPrincipalName}</p>
      </div>
    </div>
  );
};
```

#### **4.2 è¡¨å½¢å¼ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹å®Ÿè£…ãƒ‘ã‚¿ãƒ¼ãƒ³ (SQL Server)**

```typescript
// src/hooks/useProjects.ts - SQL Server ãƒ†ãƒ¼ãƒ–ãƒ«æ“ä½œ
import { useState, useEffect } from 'react';
import { MobileDeviceInventoryService } from '../generated/services/MobileDeviceInventoryService';

export const useDeviceInventory = () => {
  const [devices, setDevices] = useState([]);
  const [loading, setLoading] = useState(true);

  // å…¨ä»¶å–å¾—
  const fetchDevices = async () => {
    try {
      const result = await MobileDeviceInventoryService.getall();
      setDevices(result.data);
    } catch (error) {
      console.error('ãƒ‡ãƒã‚¤ã‚¹ä¸€è¦§å–å¾—ã‚¨ãƒ©ãƒ¼:', error);
    } finally {
      setLoading(false);
    }
  };

  // æ–°è¦ä½œæˆ
  const createDevice = async (deviceData: any) => {
    try {
      await MobileDeviceInventoryService.create(deviceData);
      await fetchDevices(); // å†èª­ã¿è¾¼ã¿
    } catch (error) {
      console.error('ãƒ‡ãƒã‚¤ã‚¹ä½œæˆã‚¨ãƒ©ãƒ¼:', error);
    }
  };

  // æ›´æ–°
  const updateDevice = async (id: string, changes: any) => {
    try {
      await MobileDeviceInventoryService.update(id, changes);
      setDevices(prevDevices => 
        prevDevices.map(device => 
          device.id === id ? { ...device, ...changes } : device
        )
      );
    } catch (error) {
      console.error('ãƒ‡ãƒã‚¤ã‚¹æ›´æ–°ã‚¨ãƒ©ãƒ¼:', error);
    }
  };

  // å‰Šé™¤
  const deleteDevice = async (id: string) => {
    try {
      await MobileDeviceInventoryService.delete(id);
      setDevices(prev => prev.filter(device => device.id !== id));
    } catch (error) {
      console.error('ãƒ‡ãƒã‚¤ã‚¹å‰Šé™¤ã‚¨ãƒ©ãƒ¼:', error);
    }
  };

  useEffect(() => {
    fetchDevices();
  }, []);

  return {
    devices,
    loading,
    createDevice,
    updateDevice,
    deleteDevice,
    refresh: fetchDevices
  };
};
```

### ğŸ§ª **Step 5: ãƒ­ãƒ¼ã‚«ãƒ«ãƒ†ã‚¹ãƒˆã¨å®Ÿè¡Œ**

```bash
# ãƒ­ãƒ¼ã‚«ãƒ«é–‹ç™ºã‚µãƒ¼ãƒãƒ¼èµ·å‹•
npm run dev

# ãƒ–ãƒ©ã‚¦ã‚¶ã§ç¢ºèª: http://localhost:3000
# ã‚³ãƒã‚¯ã‚¿ãƒ¼ãŒæ­£å¸¸ã«å‹•ä½œã™ã‚‹ã“ã¨ã‚’ç¢ºèª
```

### ğŸš€ **Step 6: Power Apps ã¸ã®ãƒ‡ãƒ—ãƒ­ã‚¤**

```bash
# ã‚¢ãƒ—ãƒªã‚’ãƒ“ãƒ«ãƒ‰ã—ã¦Power Appsã«ãƒ—ãƒƒã‚·ãƒ¥
npm run build
pac code push

# ãƒ‡ãƒ—ãƒ­ã‚¤å®Œäº†å¾Œ:
# 1. Power Apps ãƒãƒ¼ã‚¿ãƒ«ã§ã‚¢ãƒ—ãƒªã‚’ç¢ºèª
# 2. å®Ÿéš›ã®ç’°å¢ƒã§ã‚³ãƒã‚¯ã‚¿ãƒ¼æ¥ç¶šã‚’ãƒ†ã‚¹ãƒˆ
# 3. ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ã‚¢ã‚¯ã‚»ã‚¹æ¨©é™ã‚’ä»˜ä¸
```

### âš ï¸ **é‡è¦ãªæ³¨æ„äº‹é …**

- **åˆå›ãƒªãƒªãƒ¼ã‚¹ã§ã¯æ—¢å­˜æ¥ç¶šã®ã¿åˆ©ç”¨å¯èƒ½**: PAC CLIã«ã‚ˆã‚‹æ–°ã—ã„æ¥ç¶šä½œæˆã¯ä»Šå¾Œã®ãƒªãƒªãƒ¼ã‚¹ã§å¯¾å¿œäºˆå®š
- **ã‚¹ã‚­ãƒ¼ãƒå¤‰æ›´æ™‚**: æ¥ç¶šã®ã‚¹ã‚­ãƒ¼ãƒãŒå¤‰æ›´ã•ã‚ŒãŸå ´åˆã¯ã€ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ã‚’å‰Šé™¤ã—ã¦ã‹ã‚‰å†è¿½åŠ ãŒå¿…è¦
- **è¡¨å½¢å¼ãƒ‡ãƒ¼ã‚¿ã®å–å¾—**: ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆåã¨ãƒ†ãƒ¼ãƒ–ãƒ«IDãŒä¸æ˜ãªå ´åˆã¯ã€ã‚­ãƒ£ãƒ³ãƒã‚¹ã‚¢ãƒ—ãƒªçµŒç”±ã§ãƒ–ãƒ©ã‚¦ã‚¶ãƒ¼ã®ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¤ãƒ³ã‚¹ãƒšã‚¯ã‚¿ãƒ¼ã‹ã‚‰å–å¾—å¯èƒ½

## ğŸ—ƒï¸ **Dataverse æ¥ç¶šçµ±åˆ (Microsoft å…¬å¼ä»•æ§˜)**

> **å‚è€ƒãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ**: [Connect your code app to Dataverse](https://learn.microsoft.com/en-us/power-apps/developer/code-apps/how-to/connect-to-dataverse)

### âš ï¸ **é‡è¦: PowerDataRuntime åˆæœŸåŒ–ã®å¿…é ˆè¦ä»¶**

Dataverse ãƒ†ãƒ¼ãƒ–ãƒ«ï¼ˆä¾‹: SystemUsers, Accounts, Contacts ãªã©ï¼‰ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹éš›ã¯ã€**å¿…ãš Power Apps SDK ã®åˆæœŸåŒ–ãŒå®Œäº†ã—ã¦ã‹ã‚‰**ãƒ‡ãƒ¼ã‚¿æ“ä½œã‚’è¡Œã†å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

**âŒ ã‚ˆãã‚ã‚‹ã‚¨ãƒ©ãƒ¼:**
```
Error fetching SystemUsers: PowerDataRuntimeError: An unknown error occurred: 
PowerDataRuntime is not initialized. Please call initializeRuntime() first.
```

**åŸå› :**
- Power Apps SDKï¼ˆPowerDataRuntimeï¼‰ãŒåˆæœŸåŒ–ã•ã‚Œã‚‹å‰ã« Dataverse ã‚µãƒ¼ãƒ“ã‚¹ã‚¯ãƒ©ã‚¹ã®ãƒ¡ã‚½ãƒƒãƒ‰ã‚’å‘¼ã³å‡ºã—ãŸ
- `usePowerPlatform().isInitialized` ã®çŠ¶æ…‹ç¢ºèªã‚’ã›ãšã«ãƒ‡ãƒ¼ã‚¿å–å¾—ã‚’è©¦ã¿ãŸ
- ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®ãƒã‚¦ãƒ³ãƒˆæ™‚ã«å³åº§ã«ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚§ãƒƒãƒã‚’å®Ÿè¡Œã—ãŸ

**âœ… æ­£ã—ã„å®Ÿè£…ãƒ‘ã‚¿ãƒ¼ãƒ³:**
```typescript
import { usePowerPlatform } from '@microsoft/power-apps';
import { useEffect, useState } from 'react';
import { SystemUsersService } from '../generated/services/SystemUsersService';

export function DataversePage() {
  const { isInitialized } = usePowerPlatform();
  const [users, setUsers] = useState([]);
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState<string | null>(null);

  useEffect(() => {
    // âŒ åˆæœŸåŒ–å‰ã¯ä½•ã‚‚ã—ãªã„
    if (!isInitialized) {
      console.log('Waiting for Power Apps SDK initialization...');
      return;
    }

    // âœ… åˆæœŸåŒ–å®Œäº†å¾Œã«ãƒ‡ãƒ¼ã‚¿å–å¾—
    const loadData = async () => {
      try {
        setLoading(true);
        const result = await SystemUsersService.getAll({
          select: ['systemuserid', 'fullname', 'internalemailaddress'],
          filter: 'isdisabled eq false',
          top: 50
        });

        if (result.isSuccess && result.value) {
          setUsers(result.value);
        } else {
          throw new Error('SystemUsers ã®å–å¾—ã«å¤±æ•—ã—ã¾ã—ãŸ');
        }
      } catch (err) {
        console.error('Error fetching SystemUsers:', err);
        setError(err.message);
      } finally {
        setLoading(false);
      }
    };

    loadData();
  }, [isInitialized]); // ä¾å­˜é…åˆ—ã« isInitialized ã‚’å«ã‚ã‚‹

  // SDK åˆæœŸåŒ–ä¸­
  if (!isInitialized) {
    return (
      <div className="flex items-center justify-center h-screen">
        <div className="text-center">
          <div className="animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"></div>
          <p className="mt-4 text-gray-600">Power Apps SDK åˆæœŸåŒ–ä¸­...</p>
        </div>
      </div>
    );
  }

  // ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿ä¸­
  if (loading) {
    return <div>ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿ä¸­...</div>;
  }

  // ã‚¨ãƒ©ãƒ¼ç™ºç”Ÿ
  if (error) {
    return (
      <div className="bg-red-50 border border-red-200 rounded-lg p-4">
        <h3 className="text-red-800 font-semibold">ã‚¨ãƒ©ãƒ¼</h3>
        <p className="text-red-600">{error}</p>
      </div>
    );
  }

  // ãƒ‡ãƒ¼ã‚¿è¡¨ç¤º
  return (
    <div>
      <h1>ã‚·ã‚¹ãƒ†ãƒ ãƒ¦ãƒ¼ã‚¶ãƒ¼ ({users.length})</h1>
      {users.map(user => (
        <div key={user.systemuserid}>
          {user.fullname} - {user.internalemailaddress}
        </div>
      ))}
    </div>
  );
}
```

**ã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯ã§ã®å®Ÿè£…ï¼ˆæ¨å¥¨ãƒ‘ã‚¿ãƒ¼ãƒ³ï¼‰:**
```typescript
// src/hooks/useDataverseTable.ts
import { useState, useEffect, useCallback } from 'react';
import { usePowerPlatform } from '@microsoft/power-apps';

export const useDataverseTable = <T,>(
  serviceClass: any,
  options?: { select?: string[]; filter?: string; orderBy?: string; top?: number }
) => {
  const { isInitialized } = usePowerPlatform();
  const [data, setData] = useState<T[]>([]);
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState<string | null>(null);

  const fetchData = useCallback(async () => {
    // âŒ SDKæœªåˆæœŸåŒ–æ™‚ã¯å®Ÿè¡Œã—ãªã„
    if (!isInitialized) {
      console.warn('SDK not initialized, skipping fetch');
      return;
    }

    try {
      setLoading(true);
      setError(null);

      const result = await serviceClass.getAll(options);

      if (result.isSuccess && result.value) {
        setData(result.value);
      } else {
        throw new Error('ãƒ‡ãƒ¼ã‚¿ã®å–å¾—ã«å¤±æ•—ã—ã¾ã—ãŸ');
      }
    } catch (err) {
      const errorMessage = err instanceof Error ? err.message : 'Unknown error';
      console.error('Dataverse fetch error:', err);
      setError(errorMessage);
    } finally {
      setLoading(false);
    }
  }, [isInitialized, serviceClass, options]);

  useEffect(() => {
    if (isInitialized) {
      fetchData();
    }
  }, [isInitialized, fetchData]);

  return { data, loading, error, refetch: fetchData, isInitialized };
};

// ä½¿ç”¨ä¾‹
import { SystemUsersService } from '../generated/services/SystemUsersService';

export function UsersPage() {
  const { data: users, loading, error, isInitialized } = useDataverseTable(
    SystemUsersService,
    {
      select: ['systemuserid', 'fullname', 'internalemailaddress'],
      filter: 'isdisabled eq false',
      top: 100
    }
  );

  if (!isInitialized) return <div>åˆæœŸåŒ–ä¸­...</div>;
  if (loading) return <div>èª­ã¿è¾¼ã¿ä¸­...</div>;
  if (error) return <div>ã‚¨ãƒ©ãƒ¼: {error}</div>;

  return <div>{/* ãƒ¦ãƒ¼ã‚¶ãƒ¼è¡¨ç¤º */}</div>;
}
```

**ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ:**
- [ ] `usePowerPlatform()` ã§ `isInitialized` çŠ¶æ…‹ã‚’å–å¾—
- [ ] `isInitialized === false` ã®é–“ã¯ Loading è¡¨ç¤º
- [ ] `useEffect` ã®ä¾å­˜é…åˆ—ã« `isInitialized` ã‚’å«ã‚ã‚‹
- [ ] Dataverse ã‚µãƒ¼ãƒ“ã‚¹ã‚¯ãƒ©ã‚¹ã®å‘¼ã³å‡ºã—ã¯ `isInitialized === true` å¾Œã®ã¿
- [ ] ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã‚’é©åˆ‡ã«å®Ÿè£…

### ğŸ“‹ **å‰ææ¡ä»¶**

- **Power Apps Code Apps SDK**: `@microsoft/power-apps` (npm package)
- **PAC CLI**: ãƒãƒ¼ã‚¸ãƒ§ãƒ³ 1.46 ä»¥ä¸Š
- **Dataverse æœ‰åŠ¹åŒ–ç’°å¢ƒ**: Power Platformç’°å¢ƒã«DataverseãŒæœ‰åŠ¹åŒ–ã•ã‚Œã¦ã„ã‚‹
- **PAC CLI èªè¨¼**: ç’°å¢ƒã«æ­£ã—ãæ¥ç¶šã•ã‚Œã¦ã„ã‚‹
- **PowerProvider å®Ÿè£…**: ã‚¢ãƒ—ãƒªã®ãƒ«ãƒ¼ãƒˆã« PowerProvider ãŒãƒ©ãƒƒãƒ—ã•ã‚Œã¦ã„ã‚‹

### âš¡ **Dataverse ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹è¿½åŠ ï¼ˆå®Œå…¨ã‚¬ã‚¤ãƒ‰ï¼‰**

#### **æ–¹æ³•1: æ¥ç¶šIDã‚’ä½¿ç”¨ã—ãŸè¿½åŠ ï¼ˆæ¨å¥¨ï¼‰**

> **âš ï¸ é‡è¦**: Dataverse ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ã¨ã—ã¦è¿½åŠ ã™ã‚‹ã«ã¯ã€**Power Apps ãƒãƒ¼ã‚¿ãƒ«ã§æ¥ç¶šã‚’æ‰‹å‹•ä½œæˆã—ã€æ¥ç¶šIDã‚’å–å¾—**ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

**Step 1: Power Apps ãƒãƒ¼ã‚¿ãƒ«ã§Dataverseæ¥ç¶šã‚’ä½œæˆ**

```bash
# 1. Power Apps Maker Portal (make.powerapps.com) ã«ã‚¢ã‚¯ã‚»ã‚¹
# 2. å·¦ãƒ¡ãƒ‹ãƒ¥ãƒ¼ > ã€Œãƒ‡ãƒ¼ã‚¿ã€ > ã€Œæ¥ç¶šã€
# 3. ã€Œ+ æ–°ã—ã„æ¥ç¶šã€ã‚’ã‚¯ãƒªãƒƒã‚¯
# 4. ã€ŒMicrosoft Dataverseã€ã‚’æ¤œç´¢ã—ã¦é¸æŠ
# 5. ã€Œä½œæˆã€ã‚’ã‚¯ãƒªãƒƒã‚¯ï¼ˆèªè¨¼ã¯è‡ªå‹•ã§å®Œäº†ï¼‰
# 6. æ¥ç¶šãŒæ­£å¸¸ã«ä½œæˆã•ã‚ŒãŸã“ã¨ã‚’ç¢ºèª
```

**Step 2: æ¥ç¶šIDã‚’å–å¾—**

```bash
# Power Apps ãƒãƒ¼ã‚¿ãƒ«ã§:
# 1. ã€Œãƒ‡ãƒ¼ã‚¿ã€ > ã€Œæ¥ç¶šã€ > ã€ŒMicrosoft Dataverseã€ã‚’ã‚¯ãƒªãƒƒã‚¯
# 2. ãƒ–ãƒ©ã‚¦ã‚¶ã®ã‚¢ãƒ‰ãƒ¬ã‚¹ãƒãƒ¼ã®URLã‚’ç¢ºèª
# 3. URLã‹ã‚‰æ¥ç¶šIDã‚’ã‚³ãƒ”ãƒ¼

# URLå½¢å¼:
https://make.powerapps.com/environments/{ç’°å¢ƒID}/connections/shared_commondataserviceforapps/{æ¥ç¶šID}/details

# ä¾‹:
https://make.powerapps.com/environments/12345678-abcd-1234-efgh-123456789abc/connections/shared_commondataserviceforapps/a1b2c3d4-e5f6-7890-1234-567890abcdef/details

# æ¥ç¶šID: a1b2c3d4-e5f6-7890-1234-567890abcdef
```

**Step 3: pac code add-data-source ã‚³ãƒãƒ³ãƒ‰å®Ÿè¡Œ**

```bash
# ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«æ¥ç¶šIDã‚’ç¢ºèªã—ãŸå¾Œã€ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œ

# SystemUsers ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’è¿½åŠ 
pac code add-data-source -a "shared_commondataserviceforapps" -c "a1b2c3d4-e5f6-7890-1234-567890abcdef" -t "systemusers"

# Accounts (å–å¼•å…ˆä¼æ¥­) ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’è¿½åŠ 
pac code add-data-source -a "shared_commondataserviceforapps" -c "æ¥ç¶šID" -t "accounts"

# Contacts (å–å¼•å…ˆæ‹…å½“è€…) ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’è¿½åŠ 
pac code add-data-source -a "shared_commondataserviceforapps" -c "æ¥ç¶šID" -t "contacts"

# ã‚«ã‚¹ã‚¿ãƒ ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’è¿½åŠ ï¼ˆä¾‹: geek_project_taskï¼‰
pac code add-data-source -a "shared_commondataserviceforapps" -c "æ¥ç¶šID" -t "geek_project_task"
```

**ã‚³ãƒãƒ³ãƒ‰ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿:**
- `-a`: APIåï¼ˆDataverseã®å ´åˆã¯ `shared_commondataserviceforapps`ï¼‰
- `-c`: æ¥ç¶šIDï¼ˆPower Apps ãƒãƒ¼ã‚¿ãƒ«ã®URLã‹ã‚‰å–å¾—ï¼‰
- `-t`: ãƒ†ãƒ¼ãƒ–ãƒ«ã®è«–ç†åï¼ˆå°æ–‡å­—ã€ã‚¢ãƒ³ãƒ€ãƒ¼ã‚¹ã‚³ã‚¢åŒºåˆ‡ã‚Šï¼‰

**Step 4: ç”Ÿæˆã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç¢ºèª**

```bash
# ã‚³ãƒãƒ³ãƒ‰å®Ÿè¡Œå¾Œã€ä»¥ä¸‹ã®ãƒ•ã‚¡ã‚¤ãƒ«ãŒè‡ªå‹•ç”Ÿæˆã•ã‚Œã¾ã™:

# SystemUsers ãƒ†ãƒ¼ãƒ–ãƒ«ã®å ´åˆ:
src/generated/services/SystemusersService.ts
src/generated/models/SystemusersModel.ts

# Accounts ãƒ†ãƒ¼ãƒ–ãƒ«ã®å ´åˆ:
src/generated/services/AccountsService.ts
src/generated/models/AccountsModel.ts

# ã‚«ã‚¹ã‚¿ãƒ ãƒ†ãƒ¼ãƒ–ãƒ«ï¼ˆgeek_project_taskï¼‰ã®å ´åˆ:
src/generated/services/Geek_project_tasksService.ts
src/generated/models/Geek_project_tasksModel.ts
```

#### **æ–¹æ³•2: ç°¡æ˜“è¿½åŠ ï¼ˆæ¥ç¶šãŒæ—¢ã«å­˜åœ¨ã™ã‚‹å ´åˆï¼‰**

```bash
# Dataverseæ¥ç¶šãŒæ—¢ã«ä½œæˆã•ã‚Œã¦ã„ã‚‹å ´åˆã€ãƒ†ãƒ¼ãƒ–ãƒ«åã®ã¿ã§è¿½åŠ å¯èƒ½
pac code add-data-source -a dataverse -t <table-logical-name>

# ä¾‹: Accountsãƒ†ãƒ¼ãƒ–ãƒ«ã®è¿½åŠ 
pac code add-data-source -a dataverse -t accounts

# ä¾‹: Contactsãƒ†ãƒ¼ãƒ–ãƒ«ã®è¿½åŠ 
pac code add-data-source -a dataverse -t contacts

# âš ï¸ æ³¨æ„: ã“ã®æ–¹æ³•ã¯ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®Dataverseæ¥ç¶šã‚’ä½¿ç”¨ã—ã¾ã™
# æ¥ç¶šãŒè¦‹ã¤ã‹ã‚‰ãªã„å ´åˆã¯ã‚¨ãƒ©ãƒ¼ã«ãªã‚‹ãŸã‚ã€æ–¹æ³•1ã‚’æ¨å¥¨ã—ã¾ã™
```

#### **ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¸ã®ä¾é ¼ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ**

é–‹ç™ºæ™‚ã«ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«æ¥ç¶šIDã‚’ç¢ºèªã™ã‚‹éš›ã¯ã€ä»¥ä¸‹ã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’ä½¿ç”¨ã—ã¦ãã ã•ã„:

```markdown
## Dataverse æ¥ç¶šID ã®å–å¾—æ–¹æ³•

ä»¥ä¸‹ã®æ‰‹é †ã§æ¥ç¶šIDã‚’å–å¾—ã—ã€æä¾›ã—ã¦ãã ã•ã„:

### æ‰‹é †
1. Power Apps ãƒãƒ¼ã‚¿ãƒ« (https://make.powerapps.com) ã«ã‚¢ã‚¯ã‚»ã‚¹
2. å·¦ãƒ¡ãƒ‹ãƒ¥ãƒ¼ > ã€Œãƒ‡ãƒ¼ã‚¿ã€ > ã€Œæ¥ç¶šã€ã‚’ã‚¯ãƒªãƒƒã‚¯
3. ã€ŒMicrosoft Dataverseã€æ¥ç¶šã‚’ã‚¯ãƒªãƒƒã‚¯
4. ãƒ–ãƒ©ã‚¦ã‚¶ã®ã‚¢ãƒ‰ãƒ¬ã‚¹ãƒãƒ¼ã®URLã‚’ã‚³ãƒ”ãƒ¼
5. URLã‹ã‚‰æ¥ç¶šIDï¼ˆGUIDå½¢å¼ï¼‰ã‚’æŠ½å‡º

### URLä¾‹
https://make.powerapps.com/environments/xxx/connections/shared_commondataserviceforapps/**[ã“ã“ãŒæ¥ç¶šID]**/details

### æ¥ç¶šID
[ã“ã“ã«è²¼ã‚Šä»˜ã‘ã¦ãã ã•ã„]

### ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆ
[URLãƒãƒ¼ã®ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆã‚’æ·»ä»˜ã—ã¦ãã ã•ã„]
```

#### **âš ï¸ ã‚ˆãã‚ã‚‹ã‚¨ãƒ©ãƒ¼ã¨å¯¾å‡¦æ³•**

**ã‚¨ãƒ©ãƒ¼ 1: æ¥ç¶šãŒè¦‹ã¤ã‹ã‚‰ãªã„**
```bash
Error: Connection with id 'xxx' not found

å¯¾å‡¦æ³•:
1. Power Apps ãƒãƒ¼ã‚¿ãƒ«ã§Dataverseæ¥ç¶šãŒä½œæˆã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª
2. URLã‹ã‚‰æ¥ç¶šIDã‚’æ­£ç¢ºã«ã‚³ãƒ”ãƒ¼ï¼ˆãƒã‚¤ãƒ•ãƒ³ã‚’å«ã‚€GUIDå½¢å¼ï¼‰
3. pac env select ã§æ­£ã—ã„ç’°å¢ƒã‚’é¸æŠã—ã¦ã„ã‚‹ã‹ç¢ºèª
```

**ã‚¨ãƒ©ãƒ¼ 2: ãƒ†ãƒ¼ãƒ–ãƒ«ãŒè¦‹ã¤ã‹ã‚‰ãªã„**
```bash
Error: Table 'tablename' not found

å¯¾å‡¦æ³•:
1. ãƒ†ãƒ¼ãƒ–ãƒ«ã®è«–ç†åã‚’ç¢ºèªï¼ˆå°æ–‡å­—ã€ã‚¢ãƒ³ãƒ€ãƒ¼ã‚¹ã‚³ã‚¢ï¼‰
   - æ­£: systemusers, accounts, contacts
   - èª¤: SystemUsers, Account, Contact
2. customizations.xml ã§ãƒ†ãƒ¼ãƒ–ãƒ«åã‚’ç¢ºèª
3. Dataverse ã§ãƒ†ãƒ¼ãƒ–ãƒ«ãŒå…¬é–‹ã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª
```

**ã‚¨ãƒ©ãƒ¼ 3: ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ãŒè¦‹ã¤ã‹ã‚‰ãªã„ï¼ˆå®Ÿè¡Œæ™‚ã‚¨ãƒ©ãƒ¼ï¼‰**
```bash
Error: Data source 'systemusers' not found
PowerDataRuntimeError: PowerDataRuntime is not initialized

å¯¾å‡¦æ³•:
1. pac code add-data-source ã‚³ãƒãƒ³ãƒ‰ãŒæ­£å¸¸ã«å®Œäº†ã—ãŸã‹ç¢ºèª
2. src/generated/services ã«ã‚µãƒ¼ãƒ“ã‚¹ãƒ•ã‚¡ã‚¤ãƒ«ãŒç”Ÿæˆã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª
3. npm run build ã§ãƒ“ãƒ«ãƒ‰æˆåŠŸã‚’ç¢ºèª
4. usePowerPlatform().isInitialized ã®ç¢ºèªã‚’å®Ÿè£…
```

#### **ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ**

- [ ] Power Apps ãƒãƒ¼ã‚¿ãƒ«ã§Dataverseæ¥ç¶šã‚’æ‰‹å‹•ä½œæˆ
- [ ] ãƒ–ãƒ©ã‚¦ã‚¶ã®URLã‹ã‚‰æ¥ç¶šIDï¼ˆGUIDï¼‰ã‚’å–å¾—
- [ ] ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«æ¥ç¶šIDã‚’ç¢ºèªï¼ˆå¿…è¦ã«å¿œã˜ã¦ï¼‰
- [ ] `pac auth list` ã§èªè¨¼çŠ¶æ…‹ã‚’ç¢ºèª
- [ ] `pac env select` ã§æ­£ã—ã„ç’°å¢ƒã‚’é¸æŠ
- [ ] `pac code add-data-source -a "shared_commondataserviceforapps" -c "æ¥ç¶šID" -t "ãƒ†ãƒ¼ãƒ–ãƒ«å"` ã‚’å®Ÿè¡Œ
- [ ] src/generated ãƒ•ã‚©ãƒ«ãƒ€ã«ã‚µãƒ¼ãƒ“ã‚¹ãƒ•ã‚¡ã‚¤ãƒ«ãŒç”Ÿæˆã•ã‚ŒãŸã“ã¨ã‚’ç¢ºèª
- [ ] `npm run build` ã§ãƒ“ãƒ«ãƒ‰æˆåŠŸã‚’ç¢ºèª
- [ ] ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã§ `usePowerPlatform().isInitialized` ã‚’ãƒã‚§ãƒƒã‚¯
- [ ] `pac code push` ã§ãƒ‡ãƒ—ãƒ­ã‚¤ã—ã¦å‹•ä½œç¢ºèª

## ğŸ“‹ **Dataverseæ¥ç¶šå‰ã®å¿…é ˆæ‰‹é †: ã‚¹ã‚­ãƒ¼ãƒç¢ºèªã¨ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆåŒ–**

> **âš ï¸ é‡è¦**: ãƒ¢ãƒƒã‚¯ãƒ‡ãƒ¼ã‚¿ã‹ã‚‰Dataverseãƒªã‚¢ãƒ«ãƒ‡ãƒ¼ã‚¿ã«ç§»è¡Œã™ã‚‹éš›ã¯ã€ä»¥ä¸‹ã®æ‰‹é †ã‚’**å¿…ãš**å®Ÿè¡Œã—ã¦ãã ã•ã„ã€‚ã‚¹ã‚­ãƒ¼ãƒã®ä¸ä¸€è‡´ã«ã‚ˆã‚Šã€ãƒ‡ãƒ¼ã‚¿ã®èª­ã¿æ›¸ãã‚¨ãƒ©ãƒ¼ã‚„é¸æŠè‚¢å€¤ã®ä¸æ•´åˆãŒç™ºç”Ÿã™ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚

### **Step 1: customizations.xmlãƒ•ã‚¡ã‚¤ãƒ«ã®å–å¾—**

#### **Power Apps ãƒãƒ¼ã‚¿ãƒ«ã‹ã‚‰ã®ã‚½ãƒªãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ**
```bash
# 1. Power Apps Maker Portal (make.powerapps.com) ã«ã‚¢ã‚¯ã‚»ã‚¹
# 2. ã‚½ãƒªãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³ â†’ å¯¾è±¡ã‚½ãƒªãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³ã‚’é¸æŠ
# 3. ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ â†’ ã€Œã‚¢ãƒ³ãƒãƒãƒ¼ã‚¸ãƒ‰ã€ã‚’é¸æŠ
# 4. ZIPãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ãƒ»å±•é–‹
# 5. customizations.xml ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å–å¾—
# 6. ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ¯ãƒ¼ã‚¯ã‚¹ãƒšãƒ¼ã‚¹ã®ãƒ«ãƒ¼ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«é…ç½®
```

**å–å¾—ã™ã‚‹ãƒ•ã‚¡ã‚¤ãƒ«:**
- `customizations.xml` - Dataverseãƒ†ãƒ¼ãƒ–ãƒ«å®šç¾©ã¨ã‚¹ã‚­ãƒ¼ãƒæƒ…å ±
- é…ç½®å ´æ‰€: **ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ãƒ¯ãƒ¼ã‚¯ã‚¹ãƒšãƒ¼ã‚¹ãƒ«ãƒ¼ãƒˆ** (ä¾‹: `C:\CodeApps\YourProject\customizations.xml`)

### **Step 2: Dataverseã‚¹ã‚­ãƒ¼ãƒæŠ½å‡ºãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ã®å®Ÿè¡Œ**

#### **PowerShellã‚¹ã‚¯ãƒªãƒ—ãƒˆã«ã‚ˆã‚‹è‡ªå‹•æŠ½å‡º**

**Extract-DataverseChoices.ps1 ã®ä½œæˆ:**
```powershell
# ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ«ãƒ¼ãƒˆã«ä¿å­˜
param(
    [Parameter(Mandatory=$true)]
    [string]$XmlPath,
    
    [Parameter(Mandatory=$false)]
    [string]$EntityName = "your_table_name"  # å®Ÿéš›ã®ãƒ†ãƒ¼ãƒ–ãƒ«åã«å¤‰æ›´
)

# XMLã‚’èª­ã¿è¾¼ã¿ï¼ˆUTF-8ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ï¼‰
Write-Host "Reading XML file..." -ForegroundColor Cyan
$xmlContent = Get-Content -Path $XmlPath -Encoding UTF8 -Raw

# XMLã‚’ãƒ‘ãƒ¼ã‚¹
[xml]$xml = $xmlContent

# ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã‚’æ¤œç´¢
$entities = $xml.ImportExportXml.Entities.Entity

Write-Host "`nSearching for entity: $EntityName" -ForegroundColor Yellow

foreach ($entity in $entities) {
    $entityLogicalName = $entity.EntityInfo.entity.Name
    
    if ($entityLogicalName -eq $EntityName) {
        Write-Host "`nFound entity: $entityLogicalName" -ForegroundColor Green
        
        # å±æ€§ã‚’å–å¾—
        $attributes = $entity.EntityInfo.entity.attributes.attribute
        
        # å…¨å±æ€§ã®è¡¨ç¤º
        Write-Host "`nAll Attributes:" -ForegroundColor Cyan
        foreach ($attr in $attributes) {
            $attrName = $attr.Name
            $attrType = $attr.Type
            $displayName = $attr.displaynames.displayname | Where-Object { $_.languagecode -eq '1041' } | Select-Object -ExpandProperty description
            Write-Host "  $attrName ($attrType) - $displayName" -ForegroundColor White
        }
        
        # Picklistå±æ€§ã®ã¿ã‚’ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼
        $picklistAttributes = $attributes | Where-Object { $_.Type -eq 'picklist' }
        
        Write-Host "`nChoice (Picklist) Attributes Found: $($picklistAttributes.Count)" -ForegroundColor Cyan
        
        foreach ($attr in $picklistAttributes) {
            $attrName = $attr.Name
            $attrDisplayName = $attr.displaynames.displayname | Where-Object { $_.languagecode -eq '1041' } | Select-Object -ExpandProperty description
            
            Write-Host "`n=== $attrName ($attrDisplayName) ===" -ForegroundColor Yellow
            
            # optionsetè¦ç´ ã‚’å–å¾—
            if ($attr.optionset) {
                $options = $attr.optionset.options.option
                
                if ($options) {
                    Write-Host "Choice Values:" -ForegroundColor Cyan
                    foreach ($option in $options) {
                        $value = $option.value
                        $label = $option.labels.label | Where-Object { $_.languagecode -eq '1041' } | Select-Object -ExpandProperty description
                        Write-Host "  $value : $label" -ForegroundColor White
                    }
                } else {
                    Write-Host "  No options defined (global optionset?)" -ForegroundColor Gray
                }
            } else {
                Write-Host "  No optionset element found" -ForegroundColor Gray
            }
        }
    }
}

Write-Host "`nDone!" -ForegroundColor Green
```

#### **ã‚¹ã‚¯ãƒªãƒ—ãƒˆå®Ÿè¡Œä¾‹**
```powershell
# ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’å®Ÿè¡Œã—ã¦ã‚¹ã‚­ãƒ¼ãƒæƒ…å ±ã‚’æŠ½å‡ºï¼ˆãƒ¯ãƒ¼ã‚¯ã‚¹ãƒšãƒ¼ã‚¹ãƒ«ãƒ¼ãƒˆã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½¿ç”¨ï¼‰
.\Extract-DataverseChoices.ps1 -XmlPath ".\customizations.xml" -EntityName "geek_project_task"

# å®Ÿè¡Œçµæœä¾‹:
# Reading XML file...
# 
# Searching for entity: geek_project_task
# 
# Found entity: geek_project_task
# 
# All Attributes:
#   geek_project_taskid (uniqueidentifier) - ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ ã‚¿ã‚¹ã‚¯
#   geek_name (string) - åå‰
#   geek_priority (picklist) - å„ªå…ˆåº¦
#   geek_status (picklist) - çŠ¶æ…‹
#   geek_category (picklist) - ã‚«ãƒ†ã‚´ãƒª
# 
# Choice (Picklist) Attributes Found: 3
# 
# === geek_priority (å„ªå…ˆåº¦) ===
# Choice Values:
#   0 : Critical
#   1 : High
#   2 : Medium
#   3 : Low
# 
# === geek_status (çŠ¶æ…‹) ===
# Choice Values:
#   0 : Completed
#   1 : InProgress
#   2 : NotStarted
# 
# === geek_category (ã‚«ãƒ†ã‚´ãƒª) ===
# Choice Values:
#   0 : Planning
#   1 : Development
#   2 : Testing
#   3 : Deployment
```

### **Step 3: TypeScriptã‚¹ã‚­ãƒ¼ãƒå®šç¾©ã®ä½œæˆ**

#### **æŠ½å‡ºæƒ…å ±ã«åŸºã¥ãTypeScriptå‹å®šç¾©**

**src/types/dataverse.ts ã®ä½œæˆ:**
```typescript
/**
 * Dataverse ã‚¹ã‚­ãƒ¼ãƒå®šç¾©
 * 
 * ç”Ÿæˆå…ƒ: customizations.xml (geek_project_task ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£)
 * ç”Ÿæˆæ—¥æ™‚: 2025-01-17
 * ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£å: geek_project_task
 */

// ãƒ¡ã‚¤ãƒ³ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹
export interface ProjectTask {
  // ä¸»ã‚­ãƒ¼ (GUID)
  geek_project_taskid: string;
  
  // åŸºæœ¬ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰
  geek_name: string;                    // åå‰ (å¿…é ˆ)
  geek_description?: string;            // èª¬æ˜ (ä»»æ„)
  
  // Choice (é¸æŠè‚¢) ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰
  geek_priority: TaskPriority;          // å„ªå…ˆåº¦
  geek_status: TaskStatus;              // çŠ¶æ…‹  
  geek_category: TaskCategory;          // ã‚«ãƒ†ã‚´ãƒª
  
  // æ—¥ä»˜ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰
  geek_duedate?: Date;                  // æœŸé™æ—¥
  createdon: Date;                      // ä½œæˆæ—¥æ™‚ (ã‚·ã‚¹ãƒ†ãƒ )
  modifiedon: Date;                     // æ›´æ–°æ—¥æ™‚ (ã‚·ã‚¹ãƒ†ãƒ )
  
  // ãƒ«ãƒƒã‚¯ã‚¢ãƒƒãƒ—ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ (ä»–ãƒ†ãƒ¼ãƒ–ãƒ«ã¨ã®é–¢é€£)
  geek_projectid?: string;              // ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¸ã®å‚ç…§
  ownerid: string;                      // æ‰€æœ‰è€… (å¿…é ˆ)
}

// Choiceå€¤ã®å‹å®šç¾© (customizations.xmlã‹ã‚‰æŠ½å‡º)
export type TaskPriority = 0 | 1 | 2 | 3;  // Critical | High | Medium | Low
export type TaskStatus = 0 | 1 | 2;        // Completed | InProgress | NotStarted  
export type TaskCategory = 0 | 1 | 2 | 3;  // Planning | Development | Testing | Deployment

// Choiceå€¤ã®ãƒãƒƒãƒ”ãƒ³ã‚° (è¡¨ç¤ºç”¨)
export const TaskPriorityLabels: Record<TaskPriority, string> = {
  0: 'Critical',
  1: 'High', 
  2: 'Medium',
  3: 'Low'
};

export const TaskStatusLabels: Record<TaskStatus, string> = {
  0: 'Completed',
  1: 'InProgress', 
  2: 'NotStarted'
};

export const TaskCategoryLabels: Record<TaskCategory, string> = {
  0: 'Planning',
  1: 'Development',
  2: 'Testing', 
  3: 'Deployment'
};

// é€†å¼•ããƒãƒƒãƒ”ãƒ³ã‚° (ãƒ•ã‚©ãƒ¼ãƒ ç”¨)
export const TaskPriorityReverseMap: Record<string, TaskPriority> = {
  'Critical': 0,
  'High': 1,
  'Medium': 2,
  'Low': 3
};

export const TaskStatusReverseMap: Record<string, TaskStatus> = {
  'Completed': 0,
  'InProgress': 1,
  'NotStarted': 2
};

export const TaskCategoryReverseMap: Record<string, TaskCategory> = {
  'Planning': 0,
  'Development': 1,
  'Testing': 2,
  'Deployment': 3
};

// æ–°è¦ä½œæˆç”¨ã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ (ã‚·ã‚¹ãƒ†ãƒ ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰é™¤å¤–)
export interface CreateProjectTaskRequest {
  geek_name: string;
  geek_description?: string;
  geek_priority: TaskPriority;
  geek_status: TaskStatus;
  geek_category: TaskCategory;
  geek_duedate?: Date;
  geek_projectid?: string;
  ownerid: string;
}

// æ›´æ–°ç”¨ã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ (éƒ¨åˆ†æ›´æ–°å¯¾å¿œ)
export interface UpdateProjectTaskRequest {
  geek_name?: string;
  geek_description?: string;
  geek_priority?: TaskPriority;
  geek_status?: TaskStatus;
  geek_category?: TaskCategory;
  geek_duedate?: Date;
}
```

### **Step 4: Dataverse ã‚µãƒ¼ãƒ“ã‚¹ã‚¯ãƒ©ã‚¹ã®ç”Ÿæˆã¨æ¥ç¶š**

#### **4.1 pac code ã‚³ãƒãƒ³ãƒ‰ã§ã‚µãƒ¼ãƒ“ã‚¹ã‚¯ãƒ©ã‚¹ã‚’ç”Ÿæˆ**

```bash
# Power Apps ã§ Dataverse æ¥ç¶šã‚’ä½œæˆå¾Œã€ã‚µãƒ¼ãƒ“ã‚¹ã‚¯ãƒ©ã‚¹ã‚’ç”Ÿæˆ
pac code add-data-source -a "shared_commondataserviceforapps" -c "æ¥ç¶šID"

# ä»¥ä¸‹ã®ãƒ•ã‚¡ã‚¤ãƒ«ãŒè‡ªå‹•ç”Ÿæˆã•ã‚Œã¾ã™:
# - src/generated/services/{ãƒ†ãƒ¼ãƒ–ãƒ«å}Service.ts
# - src/generated/models/{ãƒ†ãƒ¼ãƒ–ãƒ«å}Model.ts
```

#### **4.2 è‡ªå‹•ç”Ÿæˆã•ã‚Œã‚‹ Dataverse ã‚µãƒ¼ãƒ“ã‚¹ã‚¯ãƒ©ã‚¹ã®æ§‹é€ **

**ä¾‹: Geek_project_tasksService.ts (è‡ªå‹•ç”Ÿæˆ)**
```typescript
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 * This file is autogenerated. Do not edit this file directly.
 */

import { dataSourcesInfo } from '../../../.power/appschemas/dataSourcesInfo';
import type { IOperationResult } from '@microsoft/power-apps/data';
import { getClient } from '@microsoft/power-apps/data';
import type { IGetOptions, IGetAllOptions } from '../models/CommonModels';
import type { Geek_project_tasks } from '../models/Geek_project_tasksModel';

export class Geek_project_tasksService {
  // âš ï¸ é‡è¦: dataSourceName ã¯ãƒ†ãƒ¼ãƒ–ãƒ«ã®è«–ç†åï¼ˆå°æ–‡å­—ãƒ»ã‚¢ãƒ³ãƒ€ãƒ¼ã‚¹ã‚³ã‚¢ï¼‰
  private static readonly dataSourceName = 'geek_project_tasks';

  private static readonly client = getClient(dataSourcesInfo);

  /**
   * ãƒ¬ã‚³ãƒ¼ãƒ‰ä½œæˆ
   * @param record æ–°è¦ãƒ¬ã‚³ãƒ¼ãƒ‰ãƒ‡ãƒ¼ã‚¿ï¼ˆIDä»¥å¤–ï¼‰
   * @returns ä½œæˆã•ã‚ŒãŸãƒ¬ã‚³ãƒ¼ãƒ‰
   */
  public static async create(
    record: Omit<Geek_project_tasks, 'geek_project_taskid'>
  ): Promise<IOperationResult<Geek_project_tasks>> {
    const result = await Geek_project_tasksService.client.createRecordAsync<
      Omit<Geek_project_tasks, 'geek_project_taskid'>, 
      Geek_project_tasks
    >(
      Geek_project_tasksService.dataSourceName,
      record
    );
    return result;
  }

  /**
   * ãƒ¬ã‚³ãƒ¼ãƒ‰æ›´æ–°
   * @param id ãƒ¬ã‚³ãƒ¼ãƒ‰ID
   * @param changedFields å¤‰æ›´ã™ã‚‹ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ï¼ˆéƒ¨åˆ†æ›´æ–°ï¼‰
   * @returns æ›´æ–°ã•ã‚ŒãŸãƒ¬ã‚³ãƒ¼ãƒ‰
   */
  public static async update(
    id: string, 
    changedFields: Partial<Omit<Geek_project_tasks, 'geek_project_taskid'>>
  ): Promise<IOperationResult<Geek_project_tasks>> {
    const result = await Geek_project_tasksService.client.updateRecordAsync<
      Partial<Omit<Geek_project_tasks, 'geek_project_taskid'>>, 
      Geek_project_tasks
    >(
      Geek_project_tasksService.dataSourceName,
      id.toString(),
      changedFields
    );
    return result;
  }

  /**
   * ãƒ¬ã‚³ãƒ¼ãƒ‰å‰Šé™¤
   * @param id ãƒ¬ã‚³ãƒ¼ãƒ‰ID
   */
  public static async delete(id: string): Promise<void> {
    await Geek_project_tasksService.client.deleteRecordAsync(
      Geek_project_tasksService.dataSourceName,
      id.toString()
    );
  }

  /**
   * å˜ä¸€ãƒ¬ã‚³ãƒ¼ãƒ‰å–å¾—
   * @param id ãƒ¬ã‚³ãƒ¼ãƒ‰ID
   * @param options å–å¾—ã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼ˆselect, expandç­‰ï¼‰
   * @returns ãƒ¬ã‚³ãƒ¼ãƒ‰ãƒ‡ãƒ¼ã‚¿
   */
  public static async get(
    id: string, 
    options?: IGetOptions
  ): Promise<IOperationResult<Geek_project_tasks>> {
    const result = await Geek_project_tasksService.client.retrieveRecordAsync<Geek_project_tasks>(
      Geek_project_tasksService.dataSourceName,
      id.toString(),
      options
    );
    return result;
  }

  /**
   * è¤‡æ•°ãƒ¬ã‚³ãƒ¼ãƒ‰å–å¾—
   * @param options å–å¾—ã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼ˆfilter, select, orderBy, topç­‰ï¼‰
   * @returns ãƒ¬ã‚³ãƒ¼ãƒ‰é…åˆ—
   */
  public static async getAll(
    options?: IGetAllOptions
  ): Promise<IOperationResult<Geek_project_tasks[]>> {
    const result = await Geek_project_tasksService.client.retrieveMultipleRecordsAsync<Geek_project_tasks>(
      Geek_project_tasksService.dataSourceName,
      options
    );
    return result;
  }
}
```

**é‡è¦ãªãƒã‚¤ãƒ³ãƒˆ:**
- âœ… ã‚¯ãƒ©ã‚¹å: `{ã‚¹ã‚­ãƒ¼ãƒåãƒ—ãƒ¬ãƒ•ã‚£ãƒƒã‚¯ã‚¹}_{ãƒ†ãƒ¼ãƒ–ãƒ«å}Service` (ä¾‹: `Geek_project_tasksService`)
- âœ… dataSourceName: ãƒ†ãƒ¼ãƒ–ãƒ«ã®è«–ç†åï¼ˆå°æ–‡å­—ãƒ»ã‚¢ãƒ³ãƒ€ãƒ¼ã‚¹ã‚³ã‚¢ï¼‰
- âœ… ã™ã¹ã¦ã®ãƒ¡ã‚½ãƒƒãƒ‰ãŒ `static` ã§å®šç¾©ã•ã‚Œã‚‹
- âœ… TypeScriptå‹å®šç¾©ãŒè‡ªå‹•ç”Ÿæˆã•ã‚Œã‚‹
- âœ… CRUDæ“ä½œãŒå®Œå‚™: `create`, `update`, `delete`, `get`, `getAll`

#### **4.3 ãƒ†ãƒ¼ãƒ–ãƒ«ã‚¹ã‚­ãƒ¼ãƒåã®ç¢ºèªæ–¹æ³•**

**customizations.xml ã‹ã‚‰ã‚¹ã‚­ãƒ¼ãƒåã‚’å–å¾—:**
```powershell
# PowerShell ã‚¹ã‚¯ãƒªãƒ—ãƒˆã§ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£æƒ…å ±ã‚’ç¢ºèª
.\Extract-DataverseChoices.ps1 -XmlPath ".\customizations.xml" -EntityName "geek_project_task"

# å‡ºåŠ›ä¾‹:
# Found entity: geek_project_task
# Schema name (prefix_logicalname): geek_project_task
# Primary ID field: geek_project_taskid
```

**ã‚¹ã‚­ãƒ¼ãƒåã®ãƒ«ãƒ¼ãƒ«:**
- ãƒ‘ãƒ–ãƒªãƒƒã‚·ãƒ£ãƒ¼ãƒ—ãƒ¬ãƒ•ã‚£ãƒƒã‚¯ã‚¹ + ã‚¢ãƒ³ãƒ€ãƒ¼ã‚¹ã‚³ã‚¢ + ãƒ†ãƒ¼ãƒ–ãƒ«å
- ä¾‹: `geek_project_task` â†’ ãƒ—ãƒ¬ãƒ•ã‚£ãƒƒã‚¯ã‚¹ `geek`, ãƒ†ãƒ¼ãƒ–ãƒ«å `project_task`
- ã‚µãƒ¼ãƒ“ã‚¹ã‚¯ãƒ©ã‚¹å: `Geek_project_tasksService` (è¤‡æ•°å½¢)
- dataSourceName: `geek_project_tasks` (å°æ–‡å­—ãƒ»è¤‡æ•°å½¢)

#### **4.4 ã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯ã§ã‚µãƒ¼ãƒ“ã‚¹ã‚¯ãƒ©ã‚¹ã‚’ãƒ©ãƒƒãƒ—**

**src/hooks/useDataverseProjectTasks.ts ã®ä½œæˆ:**
**src/hooks/useDataverseProjectTasks.ts ã®ä½œæˆ:**
```typescript
import { useState, useCallback } from 'react';
import { Geek_project_tasksService } from '../generated/services/Geek_project_tasksService';
import type { Geek_project_tasks } from '../generated/models/Geek_project_tasksModel';
import type { 
  CreateProjectTaskRequest, 
  UpdateProjectTaskRequest,
  TaskPriority,
  TaskStatus,
  TaskCategory
} from '@/types/dataverse';

export const useDataverseProjectTasks = () => {
  const [tasks, setTasks] = useState<Geek_project_tasks[]>([]);
  const [loading, setLoading] = useState(false);
  const [error, setError] = useState<string | null>(null);

  // å…¨ã‚¿ã‚¹ã‚¯å–å¾—
  const getAllTasks = useCallback(async () => {
    try {
      setLoading(true);
      setError(null);
      
      const result = await Geek_project_tasksService.getAll({
        select: [
          'geek_project_taskid',
          'geek_name', 
          'geek_description',
          'geek_priority',
          'geek_status',
          'geek_category',
          'geek_duedate',
          'createdon',
          'modifiedon',
          'geek_projectid',
          'ownerid'
        ],
        orderBy: 'createdon desc'
      });
      
      if (result.isSuccess && result.value) {
        setTasks(result.value);
        return result.value;
      } else {
        throw new Error('ã‚¿ã‚¹ã‚¯ä¸€è¦§ã®å–å¾—ã«å¤±æ•—ã—ã¾ã—ãŸ');
      }
    } catch (err) {
      const errorMessage = err instanceof Error ? err.message : 'Unknown error';
      console.error('Dataverse getAllTasks error:', err);
      setError(errorMessage);
      throw err;
    } finally {
      setLoading(false);
    }
  }, []);

  // å˜ä¸€ã‚¿ã‚¹ã‚¯å–å¾—
  const getTask = useCallback(async (taskId: string) => {
    try {
      setLoading(true);
      setError(null);
      
      const result = await Geek_project_tasksService.get(taskId);
      
      if (result.isSuccess && result.value) {
        return result.value;
      } else {
        throw new Error('ã‚¿ã‚¹ã‚¯ã®å–å¾—ã«å¤±æ•—ã—ã¾ã—ãŸ');
      }
    } catch (err) {
      const errorMessage = err instanceof Error ? err.message : 'Unknown error';
      console.error('Dataverse getTask error:', err);
      setError(errorMessage);
      throw err;
    } finally {
      setLoading(false);
    }
  }, []);

  // æ–°è¦ã‚¿ã‚¹ã‚¯ä½œæˆ  
  const createTask = useCallback(async (taskData: CreateProjectTaskRequest) => {
    try {
      setLoading(true);
      setError(null);
      
      // Choiceå€¤ã®æ¤œè¨¼
      validateChoiceValues(taskData);
      
      // IDãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’é™¤å¤–ã—ã¦ãƒ¬ã‚³ãƒ¼ãƒ‰ä½œæˆ
      const recordData: Omit<Geek_project_tasks, 'geek_project_taskid'> = {
        geek_name: taskData.geek_name,
        geek_description: taskData.geek_description,
        geek_priority: taskData.geek_priority,
        geek_status: taskData.geek_status,
        geek_category: taskData.geek_category,
        geek_duedate: taskData.geek_duedate,
        geek_projectid: taskData.geek_projectid,
        ownerid: taskData.ownerid
      };
      
      const result = await Geek_project_tasksService.create(recordData);
      
      if (result.isSuccess && result.value) {
        // ã‚¿ã‚¹ã‚¯ä¸€è¦§ã‚’å†å–å¾—
        await getAllTasks();
        return result.value;
      } else {
        throw new Error('ã‚¿ã‚¹ã‚¯ã®ä½œæˆã«å¤±æ•—ã—ã¾ã—ãŸ');
      }
    } catch (err) {
      const errorMessage = err instanceof Error ? err.message : 'Unknown error';
      console.error('Dataverse createTask error:', err);
      setError(errorMessage);
      throw err;
    } finally {
      setLoading(false);
    }
  }, [getAllTasks]);

  // ã‚¿ã‚¹ã‚¯æ›´æ–°
  const updateTask = useCallback(async (
    taskId: string, 
    updateData: UpdateProjectTaskRequest
  ) => {
    try {
      setLoading(true);
      setError(null);
      
      // Choiceå€¤ã®æ¤œè¨¼ï¼ˆæ›´æ–°æ™‚ï¼‰
      if (updateData.geek_priority !== undefined || 
          updateData.geek_status !== undefined || 
          updateData.geek_category !== undefined) {
        validateChoiceValues(updateData);
      }
      
      const result = await Geek_project_tasksService.update(taskId, updateData);
      
      if (result.isSuccess && result.value) {
        // ã‚¿ã‚¹ã‚¯ä¸€è¦§ã‚’å†å–å¾—
        await getAllTasks();
        return result.value;
      } else {
        throw new Error('ã‚¿ã‚¹ã‚¯ã®æ›´æ–°ã«å¤±æ•—ã—ã¾ã—ãŸ');
      }
    } catch (err) {
      const errorMessage = err instanceof Error ? err.message : 'Unknown error';
      console.error('Dataverse updateTask error:', err);
      setError(errorMessage);
      throw err;
    } finally {
      setLoading(false);
    }
  }, [getAllTasks]);

  // ã‚¿ã‚¹ã‚¯å‰Šé™¤
  const deleteTask = useCallback(async (taskId: string) => {
    try {
      setLoading(true);
      setError(null);
      
      await Geek_project_tasksService.delete(taskId);
      
      // ã‚¿ã‚¹ã‚¯ä¸€è¦§ã‚’å†å–å¾—
      await getAllTasks();
    } catch (err) {
      const errorMessage = err instanceof Error ? err.message : 'Unknown error';
      console.error('Dataverse deleteTask error:', err);
      setError(errorMessage);
      throw err;
    } finally {
      setLoading(false);
    }
  }, [getAllTasks]);

  // Choiceå€¤ã®æ¤œè¨¼é–¢æ•°
  const validateChoiceValues = (data: CreateProjectTaskRequest | UpdateProjectTaskRequest) => {
    if ('geek_priority' in data && data.geek_priority !== undefined && 
        ![0, 1, 2, 3].includes(data.geek_priority)) {
      throw new Error(`ç„¡åŠ¹ãªå„ªå…ˆåº¦: ${data.geek_priority}`);
    }
    if ('geek_status' in data && data.geek_status !== undefined && 
        ![0, 1, 2].includes(data.geek_status)) {
      throw new Error(`ç„¡åŠ¹ãªçŠ¶æ…‹: ${data.geek_status}`);
    }
    if ('geek_category' in data && data.geek_category !== undefined && 
        ![0, 1, 2, 3].includes(data.geek_category)) {
      throw new Error(`ç„¡åŠ¹ãªã‚«ãƒ†ã‚´ãƒª: ${data.geek_category}`);
    }
  };

  return {
    tasks,
    loading,
    error,
    getAllTasks,
    getTask,
    createTask,
    updateTask,
    deleteTask
  };
};
```

**ä¸»è¦ãªãƒã‚¤ãƒ³ãƒˆ:**
- âœ… **è‡ªå‹•ç”Ÿæˆã‚µãƒ¼ãƒ“ã‚¹ã‚¯ãƒ©ã‚¹** (`Geek_project_tasksService`) ã‚’ä½¿ç”¨
- âœ… **IOperationResult** ã® `isSuccess` ã§ã‚¨ãƒ©ãƒ¼ãƒã‚§ãƒƒã‚¯
- âœ… **Choice ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®æ¤œè¨¼** ã‚’å®Ÿè£…
- âœ… **éƒ¨åˆ†æ›´æ–°** ã«å¯¾å¿œï¼ˆupdateãƒ¡ã‚½ãƒƒãƒ‰ï¼‰
- âœ… **ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°** ã‚’å„æ“ä½œã§å®Ÿè£…

### **Step 5: UIã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã§ã®ä½¿ç”¨**

**src/pages/ProjectTasksPage.tsx ã®ä½œæˆ:**
```typescript
import React, { useEffect, useState } from 'react';
import { useDataverseProjectTasks } from '../hooks/useDataverseProjectTasks';
import type { Geek_project_tasks } from '../generated/models/Geek_project_tasksModel';
import type { CreateProjectTaskRequest, UpdateProjectTaskRequest } from '@/types/dataverse';
import { 
  TaskPriorityMap, 
  TaskStatusMap, 
  TaskCategoryMap,
  TaskPriorityReverseMap,
  TaskStatusReverseMap,
  TaskCategoryReverseMap
} from '@/types/dataverse';

export const ProjectTasksPage: React.FC = () => {
  const { 
    tasks, 
    loading, 
    error, 
    getAllTasks, 
    createTask, 
    updateTask, 
    deleteTask 
  } = useDataverseProjectTasks();

  const [isCreateModalOpen, setIsCreateModalOpen] = useState(false);
  const [editingTask, setEditingTask] = useState<Geek_project_tasks | null>(null);

  // åˆæœŸèª­ã¿è¾¼ã¿
  useEffect(() => {
    getAllTasks();
  }, [getAllTasks]);

  // ã‚¿ã‚¹ã‚¯ä½œæˆå‡¦ç†
  const handleCreateTask = async (formData: CreateProjectTaskRequest) => {
    try {
      await createTask(formData);
      setIsCreateModalOpen(false);
    } catch (err) {
      console.error('ã‚¿ã‚¹ã‚¯ä½œæˆã‚¨ãƒ©ãƒ¼:', err);
    }
  };

  // ã‚¿ã‚¹ã‚¯æ›´æ–°å‡¦ç†
  const handleUpdateTask = async (taskId: string, updateData: UpdateProjectTaskRequest) => {
    try {
      await updateTask(taskId, updateData);
      setEditingTask(null);
    } catch (err) {
      console.error('ã‚¿ã‚¹ã‚¯æ›´æ–°ã‚¨ãƒ©ãƒ¼:', err);
    }
  };

  // ã‚¿ã‚¹ã‚¯å‰Šé™¤å‡¦ç†
  const handleDeleteTask = async (taskId: string) => {
    if (confirm('ã“ã®ã‚¿ã‚¹ã‚¯ã‚’å‰Šé™¤ã—ã¦ã‚‚ã‚ˆã‚ã—ã„ã§ã™ã‹?')) {
      try {
        await deleteTask(taskId);
      } catch (err) {
        console.error('ã‚¿ã‚¹ã‚¯å‰Šé™¤ã‚¨ãƒ©ãƒ¼:', err);
      }
    }
  };

  // ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹å¤‰æ›´å‡¦ç†
  const handleStatusChange = async (task: Geek_project_tasks, newStatus: number) => {
    try {
      await updateTask(task.geek_project_taskid, { geek_status: newStatus });
    } catch (err) {
      console.error('ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹å¤‰æ›´ã‚¨ãƒ©ãƒ¼:', err);
    }
  };

  if (loading && tasks.length === 0) {
    return (
      <div className="flex items-center justify-center p-8">
        <div className="animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"></div>
        <span className="ml-2">Loading tasks...</span>
      </div>
    );
  }

  return (
    <div className="container mx-auto p-6">
      <div className="flex justify-between items-center mb-6">
        <h1 className="text-3xl font-bold">Project Tasks</h1>
        <button
          onClick={() => setIsCreateModalOpen(true)}
          className="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700"
        >
          + New Task
        </button>
      </div>

      {error && (
        <div className="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4">
          {error}
        </div>
      )}

      {/* ã‚¿ã‚¹ã‚¯ä¸€è¦§ */}
      <div className="grid gap-4">
        {tasks.map((task) => (
          <div key={task.geek_project_taskid} className="bg-white shadow rounded-lg p-6">
            <div className="flex justify-between items-start">
              <div className="flex-1">
                <h3 className="text-xl font-semibold">{task.geek_name}</h3>
                {task.geek_description && (
                  <p className="text-gray-600 mt-2">{task.geek_description}</p>
                )}
                
                {/* Choice ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰è¡¨ç¤º */}
                <div className="flex gap-2 mt-4">
                  {/* å„ªå…ˆåº¦ãƒãƒƒã‚¸ */}
                  <span className={`px-3 py-1 rounded-full text-sm font-medium ${
                    task.geek_priority === 0 ? 'bg-red-100 text-red-800' :
                    task.geek_priority === 1 ? 'bg-orange-100 text-orange-800' :
                    task.geek_priority === 2 ? 'bg-yellow-100 text-yellow-800' :
                    'bg-green-100 text-green-800'
                  }`}>
                    {TaskPriorityMap[task.geek_priority]}
                  </span>

                  {/* ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒãƒƒã‚¸ */}
                  <span className={`px-3 py-1 rounded-full text-sm font-medium ${
                    task.geek_status === 0 ? 'bg-green-100 text-green-800' :
                    task.geek_status === 1 ? 'bg-blue-100 text-blue-800' :
                    'bg-gray-100 text-gray-800'
                  }`}>
                    {TaskStatusMap[task.geek_status]}
                  </span>

                  {/* ã‚«ãƒ†ã‚´ãƒªãƒãƒƒã‚¸ */}
                  <span className="px-3 py-1 rounded-full text-sm font-medium bg-purple-100 text-purple-800">
                    {TaskCategoryMap[task.geek_category]}
                  </span>
                </div>

                {/* æœŸé™è¡¨ç¤º */}
                {task.geek_duedate && (
                  <p className="text-sm text-gray-500 mt-2">
                    æœŸé™: {new Date(task.geek_duedate).toLocaleDateString('ja-JP')}
                  </p>
                )}
              </div>

              {/* ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãƒœã‚¿ãƒ³ */}
              <div className="flex gap-2 ml-4">
                {/* ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹å¤‰æ›´ */}
                {task.geek_status !== 0 && (
                  <button
                    onClick={() => handleStatusChange(task, 0)}
                    disabled={loading}
                    className="px-3 py-1 bg-green-600 text-white rounded text-sm hover:bg-green-700 disabled:opacity-50"
                  >
                    å®Œäº†
                  </button>
                )}
                
                {/* ç·¨é›† */}
                <button
                  onClick={() => setEditingTask(task)}
                  disabled={loading}
                  className="px-3 py-1 bg-blue-600 text-white rounded text-sm hover:bg-blue-700 disabled:opacity-50"
                >
                  ç·¨é›†
                </button>
                
                {/* å‰Šé™¤ */}
                <button
                  onClick={() => handleDeleteTask(task.geek_project_taskid)}
                  disabled={loading}
                  className="px-3 py-1 bg-red-600 text-white rounded text-sm hover:bg-red-700 disabled:opacity-50"
                >
                  å‰Šé™¤
                </button>
              </div>
            </div>
          </div>
        ))}
      </div>

      {tasks.length === 0 && !loading && (
        <div className="text-center py-12 text-gray-500">
          <p>ã‚¿ã‚¹ã‚¯ãŒã‚ã‚Šã¾ã›ã‚“</p>
          <button
            onClick={() => setIsCreateModalOpen(true)}
            className="mt-4 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700"
          >
            æœ€åˆã®ã‚¿ã‚¹ã‚¯ã‚’ä½œæˆ
          </button>
        </div>
      )}
    </div>
  );
};
```

**ä¸»è¦ãªãƒã‚¤ãƒ³ãƒˆ:**
- âœ… **è‡ªå‹•ç”Ÿæˆã•ã‚ŒãŸå‹å®šç¾©** ã‚’ä½¿ç”¨ (`Geek_project_tasks`)
- âœ… **Choice ãƒãƒƒãƒ”ãƒ³ã‚°** ã§ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ•ãƒ¬ãƒ³ãƒ‰ãƒªãƒ¼ãªè¡¨ç¤º
- âœ… **CRUD æ“ä½œ** ã‚’ã™ã¹ã¦å®Ÿè£…
- âœ… **ã‚¨ãƒ©ãƒ¼è¡¨ç¤º** ã¨ **Loading çŠ¶æ…‹** ã‚’é©åˆ‡ã«ç®¡ç†
- âœ… **Dataverseã‚¹ã‚­ãƒ¼ãƒ** ã«å®Œå…¨æº–æ‹ 

#### **Choiceå€¤ã«å¯¾å¿œã—ãŸãƒ•ã‚©ãƒ¼ãƒ ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ**

**src/components/TaskForm.tsx ã®ä½œæˆ:**
```typescript
import React, { useState } from 'react';
import { Button } from '@/components/ui/button';
import { Input } from '@/components/ui/input';
import { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select';
import { Textarea } from '@/components/ui/textarea';
import type { 
  CreateProjectTaskRequest, 
  UpdateProjectTaskRequest,
  TaskPriority,
  TaskStatus, 
  TaskCategory
} from '@/types/dataverse';
import { 
  TaskPriorityLabels, 
  TaskStatusLabels, 
  TaskCategoryLabels 
} from '@/types/dataverse';

interface TaskFormProps {
  onSubmit: (data: CreateProjectTaskRequest | UpdateProjectTaskRequest) => Promise<void>;
  initialData?: Partial<CreateProjectTaskRequest>;
  isEdit?: boolean;
}

export const TaskForm: React.FC<TaskFormProps> = ({ 
  onSubmit, 
  initialData = {}, 
  isEdit = false 
}) => {
  const [formData, setFormData] = useState({
    geek_name: initialData.geek_name || '',
    geek_description: initialData.geek_description || '',
    geek_priority: initialData.geek_priority ?? 1, // Default: High
    geek_status: initialData.geek_status ?? 2,     // Default: NotStarted
    geek_category: initialData.geek_category ?? 0, // Default: Planning
    geek_duedate: initialData.geek_duedate ? new Date(initialData.geek_duedate).toISOString().split('T')[0] : '',
    ownerid: initialData.ownerid || ''
  });

  const handleSubmit = async (e: React.FormEvent) => {
    e.preventDefault();
    
    const submitData = {
      ...formData,
      geek_duedate: formData.geek_duedate ? new Date(formData.geek_duedate) : undefined
    };

    await onSubmit(submitData);
  };

  return (
    <form onSubmit={handleSubmit} className="space-y-4">
      <div>
        <label className="block text-sm font-medium mb-1">ã‚¿ã‚¹ã‚¯å *</label>
        <Input
          value={formData.geek_name}
          onChange={(e) => setFormData({ ...formData, geek_name: e.target.value })}
          required
          placeholder="ã‚¿ã‚¹ã‚¯åã‚’å…¥åŠ›"
        />
      </div>

      <div>
        <label className="block text-sm font-medium mb-1">èª¬æ˜</label>
        <Textarea
          value={formData.geek_description}
          onChange={(e) => setFormData({ ...formData, geek_description: e.target.value })}
          placeholder="ã‚¿ã‚¹ã‚¯ã®è©³ç´°ã‚’å…¥åŠ›"
        />
      </div>

      <div className="grid grid-cols-3 gap-4">
        <div>
          <label className="block text-sm font-medium mb-1">å„ªå…ˆåº¦</label>
          <Select
            value={formData.geek_priority.toString()}
            onValueChange={(value) => setFormData({ ...formData, geek_priority: parseInt(value) as TaskPriority })}
          >
            <SelectTrigger>
              <SelectValue />
            </SelectTrigger>
            <SelectContent>
              {Object.entries(TaskPriorityLabels).map(([value, label]) => (
                <SelectItem key={value} value={value}>
                  {label}
                </SelectItem>
              ))}
            </SelectContent>
          </Select>
        </div>

        <div>
          <label className="block text-sm font-medium mb-1">çŠ¶æ…‹</label>
          <Select
            value={formData.geek_status.toString()}
            onValueChange={(value) => setFormData({ ...formData, geek_status: parseInt(value) as TaskStatus })}
          >
            <SelectTrigger>
              <SelectValue />
            </SelectTrigger>
            <SelectContent>
              {Object.entries(TaskStatusLabels).map(([value, label]) => (
                <SelectItem key={value} value={value}>
                  {label}
                </SelectItem>
              ))}
            </SelectContent>
          </Select>
        </div>

        <div>
          <label className="block text-sm font-medium mb-1">ã‚«ãƒ†ã‚´ãƒª</label>
          <Select
            value={formData.geek_category.toString()}
            onValueChange={(value) => setFormData({ ...formData, geek_category: parseInt(value) as TaskCategory })}
          >
            <SelectTrigger>
              <SelectValue />
            </SelectTrigger>
            <SelectContent>
              {Object.entries(TaskCategoryLabels).map(([value, label]) => (
                <SelectItem key={value} value={value}>
                  {label}
                </SelectItem>
              ))}
            </SelectContent>
          </Select>
        </div>
      </div>

      <div>
        <label className="block text-sm font-medium mb-1">æœŸé™æ—¥</label>
        <Input
          type="date"
          value={formData.geek_duedate}
          onChange={(e) => setFormData({ ...formData, geek_duedate: e.target.value })}
        />
      </div>

      <Button type="submit" className="w-full">
        {isEdit ? 'ã‚¿ã‚¹ã‚¯ã‚’æ›´æ–°' : 'ã‚¿ã‚¹ã‚¯ã‚’ä½œæˆ'}
      </Button>
    </form>
  );
};
```

### **ğŸ“‹ Dataverseçµ±åˆã®ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹**

> **ğŸ“˜ Dataverseå®Ÿè£…ãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹**
> ã‚ˆã‚Šè©³ç´°ãªå®Ÿè£…ä¾‹ã€ã‚¹ã‚­ãƒ¼ãƒå–å¾—æ–¹æ³•ã€ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã«ã¤ã„ã¦ã¯ä»¥ä¸‹ã‚’å‚ç…§ã—ã¦ãã ã•ã„:
> - **[Lookupãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰å®Ÿè£…ã‚¬ã‚¤ãƒ‰](./docs/LOOKUP_FIELD_GUIDE.md)** - Lookupå®Œå…¨å®Ÿè£…
> - **[Dataverseã‚¹ã‚­ãƒ¼ãƒãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹](./docs/DATAVERSE_SCHEMA_REFERENCE.md)** - ã‚¹ã‚­ãƒ¼ãƒå®šç¾©ã¨Choiceå€¤
> - **[ã‚¹ã‚­ãƒ¼ãƒå–å¾—æ–¹æ³•](./docs/HOW_TO_GET_DATAVERSE_SCHEMA.md)** - 5ã¤ã®å–å¾—æ–¹æ³•
> - **[Dataverseãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°](./docs/DATAVERSE_TROUBLESHOOTING.md)** - ã‚ˆãã‚ã‚‹å•é¡Œã¨è§£æ±ºæ³•

#### **ã‚¹ã‚­ãƒ¼ãƒåã®å–å¾—ã¨ã‚µãƒ¼ãƒ“ã‚¹ã‚¯ãƒ©ã‚¹ç”Ÿæˆ**

**1. customizations.xml ã‹ã‚‰ãƒ†ãƒ¼ãƒ–ãƒ«æƒ…å ±ã‚’å–å¾—:**
```powershell
# ãƒ†ãƒ¼ãƒ–ãƒ«ã®ã‚¹ã‚­ãƒ¼ãƒåã‚’ç¢ºèª
.\Extract-DataverseChoices.ps1 -XmlPath ".\customizations.xml" -EntityName "{è«–ç†å}"

# ä¾‹: ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚¿ã‚¹ã‚¯ãƒ†ãƒ¼ãƒ–ãƒ«ã®å ´åˆ
.\Extract-DataverseChoices.ps1 -XmlPath ".\customizations.xml" -EntityName "geek_project_task"

# å‡ºåŠ›ä¾‹:
# Schema name: geek_project_task
# Publisher prefix: geek
# Table logical name: project_task
# Primary ID field: geek_project_taskid
```

**2. pac code ã‚³ãƒãƒ³ãƒ‰ã§ã‚µãƒ¼ãƒ“ã‚¹ã‚¯ãƒ©ã‚¹ã‚’ç”Ÿæˆ:**
```bash
# Dataverseæ¥ç¶šä½œæˆå¾Œ
pac code add-data-source -a "shared_commondataserviceforapps" -c "{æ¥ç¶šID}"

# ç”Ÿæˆã•ã‚Œã‚‹ãƒ•ã‚¡ã‚¤ãƒ«:
# src/generated/services/{ã‚¹ã‚­ãƒ¼ãƒåãƒ—ãƒ¬ãƒ•ã‚£ãƒƒã‚¯ã‚¹}_{ãƒ†ãƒ¼ãƒ–ãƒ«å}Service.ts
# ä¾‹: Geek_project_tasksService.ts
```

**3. ã‚µãƒ¼ãƒ“ã‚¹ã‚¯ãƒ©ã‚¹ã®å‘½åè¦å‰‡:**
- **ã‚¯ãƒ©ã‚¹å**: `{Prefix}_{TableName}Service` (å…ˆé ­å¤§æ–‡å­—ã€è¤‡æ•°å½¢)
  - ä¾‹: `Geek_project_tasksService`
- **dataSourceName**: `{prefix}_{table_name}` (å°æ–‡å­—ã€è¤‡æ•°å½¢)
  - ä¾‹: `geek_project_tasks`
- **ãƒ—ãƒ©ã‚¤ãƒãƒªã‚­ãƒ¼**: `{prefix}_{table_name}id`
  - ä¾‹: `geek_project_taskid`

#### **ãƒ†ãƒ¼ãƒ–ãƒ«ã‚¹ã‚­ãƒ¼ãƒåã®ãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€ãƒ¼**

é–‹ç™ºæ™‚ã¯ä»¥ä¸‹ã®ãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€ãƒ¼ã‚’ä½¿ç”¨ã—ã€å®Ÿéš›ã®ã‚¹ã‚­ãƒ¼ãƒåã«ç½®ãæ›ãˆã¦ãã ã•ã„:

```typescript
// âŒ ãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€ãƒ¼ï¼ˆé–‹ç™ºæ™‚ï¼‰
import { {Prefix}_{TableName}Service } from '../generated/services/{Prefix}_{TableName}Service';
import type { {Prefix}_{TableName} } from '../generated/models/{Prefix}_{TableName}Model';

// ã‚µãƒ¼ãƒ“ã‚¹ã‚¯ãƒ©ã‚¹ä½¿ç”¨
const result = await {Prefix}_{TableName}Service.getAll();

// âœ… å®Ÿéš›ã®ä¾‹ï¼ˆGeek_project_tasksã®å ´åˆï¼‰
import { Geek_project_tasksService } from '../generated/services/Geek_project_tasksService';
import type { Geek_project_tasks } from '../generated/models/Geek_project_tasksModel';

// ã‚µãƒ¼ãƒ“ã‚¹ã‚¯ãƒ©ã‚¹ä½¿ç”¨
const result = await Geek_project_tasksService.getAll();
```

**ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰åã®ãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€ãƒ¼:**
```typescript
// ãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€ãƒ¼å½¢å¼
{prefix}_{fieldname}     // é€šå¸¸ã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰
{prefix}_{tablename}id   // ãƒ—ãƒ©ã‚¤ãƒãƒªã‚­ãƒ¼

// å®Ÿä¾‹ï¼ˆgeek ãƒ—ãƒ¬ãƒ•ã‚£ãƒƒã‚¯ã‚¹ï¼‰
geek_name               // åå‰ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰
geek_description        // èª¬æ˜ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰
geek_priority           // å„ªå…ˆåº¦ï¼ˆChoiceï¼‰
geek_project_taskid     // ãƒ—ãƒ©ã‚¤ãƒãƒªã‚­ãƒ¼
```

#### **Choice ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®å‹ãƒãƒƒãƒ”ãƒ³ã‚°**

```typescript
// customizations.xml ã‹ã‚‰æŠ½å‡ºã•ã‚ŒãŸ Choice å€¤
export type TaskPriority = 0 | 1 | 2 | 3;
export type TaskStatus = 0 | 1 | 2;
export type TaskCategory = 0 | 1 | 2 | 3;

// è¡¨ç¤ºåãƒãƒƒãƒ”ãƒ³ã‚°ï¼ˆUIã§ä½¿ç”¨ï¼‰
export const TaskPriorityMap: Record<TaskPriority, string> = {
  0: 'Critical',
  1: 'High',
  2: 'Medium',
  3: 'Low'
};

// é€†å¼•ããƒãƒƒãƒ”ãƒ³ã‚°ï¼ˆãƒ•ã‚©ãƒ¼ãƒ é€ä¿¡æ™‚ã«ä½¿ç”¨ï¼‰
export const TaskPriorityReverseMap: Record<string, TaskPriority> = {
  'Critical': 0,
  'High': 1,
  'Medium': 2,
  'Low': 3
};
```

#### **å¿…é ˆãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ: Dataverseæ¥ç¶šå‰**

**é–‹ç™ºè€…ã¸ã®ä¾é ¼äº‹é …:**
- [ ] **customizations.xmlãƒ•ã‚¡ã‚¤ãƒ«å–å¾—**: Power Apps ãƒãƒ¼ã‚¿ãƒ«ã‹ã‚‰ã‚½ãƒªãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ
- [ ] **customizations.xmlã‚’ãƒ¯ãƒ¼ã‚¯ã‚¹ãƒšãƒ¼ã‚¹ãƒ«ãƒ¼ãƒˆã«é…ç½®**: `.\customizations.xml`
- [ ] **ã‚¹ã‚­ãƒ¼ãƒæŠ½å‡ºå®Ÿè¡Œ**: PowerShellã‚¹ã‚¯ãƒªãƒ—ãƒˆã§ãƒ†ãƒ¼ãƒ–ãƒ«æ§‹é€ ãƒ»Choiceå€¤ã‚’æŠ½å‡º
- [ ] **ãƒ†ãƒ¼ãƒ–ãƒ«ã‚¹ã‚­ãƒ¼ãƒåã®ç¢ºèª**: `{prefix}_{tablename}` å½¢å¼ã‚’ç‰¹å®š
- [ ] **pac code add-data-source å®Ÿè¡Œ**: ã‚µãƒ¼ãƒ“ã‚¹ã‚¯ãƒ©ã‚¹ã®è‡ªå‹•ç”Ÿæˆ
- [ ] **TypeScriptå‹å®šç¾©ä½œæˆ**: æŠ½å‡ºæƒ…å ±ã«åŸºã¥ãã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹å®šç¾©
- [ ] **Choiceå€¤ãƒãƒƒãƒ”ãƒ³ã‚°**: æ•°å€¤â‡”è¡¨ç¤ºåã®å¤‰æ›ãƒ†ãƒ¼ãƒ–ãƒ«ä½œæˆ
- [ ] **ã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯ä½œæˆ**: ã‚µãƒ¼ãƒ“ã‚¹ã‚¯ãƒ©ã‚¹ã‚’ãƒ©ãƒƒãƒ—
- [ ] **UIãƒ•ã‚©ãƒ¼ãƒ æ›´æ–°**: Choiceå€¤ã‚’ãƒ‰ãƒ­ãƒƒãƒ—ãƒ€ã‚¦ãƒ³ã§é¸æŠå¯èƒ½ãªãƒ•ã‚©ãƒ¼ãƒ 
- [ ] **å‹å®‰å…¨æ€§ç¢ºèª**: TypeScriptã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã‚¨ãƒ©ãƒ¼0ä»¶
- [ ] **çµ±åˆãƒ†ã‚¹ãƒˆ**: ãƒ¢ãƒƒã‚¯ãƒ‡ãƒ¼ã‚¿â†’ãƒªã‚¢ãƒ«ãƒ‡ãƒ¼ã‚¿åˆ‡ã‚Šæ›¿ãˆãƒ†ã‚¹ãƒˆ

### **âš ï¸ ã‚ˆãã‚ã‚‹å•é¡Œã¨å¯¾å‡¦æ³•**

#### **1. Choiceå€¤ã®ä¸ä¸€è‡´ã‚¨ãƒ©ãƒ¼**
```
âŒ ã‚¨ãƒ©ãƒ¼ä¾‹: "Invalid option value '4' for attribute 'geek_priority'"
âœ… å¯¾å‡¦æ³•: customizations.xmlã‹ã‚‰æ­£ç¢ºãªChoiceå€¤ã‚’æŠ½å‡ºãƒ»æ›´æ–°
```

#### **2. å¿…é ˆãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚¨ãƒ©ãƒ¼**  
```
âŒ ã‚¨ãƒ©ãƒ¼ä¾‹: "Required attribute 'geek_name' is missing"
âœ… å¯¾å‡¦æ³•: XMLã®IsValidForCreateå±æ€§ã§Requiredåˆ¤å®šãƒ»ãƒ•ã‚©ãƒ¼ãƒ å¿…é ˆè¨­å®š
```

#### **3. ãƒ‡ãƒ¼ã‚¿å‹ä¸ä¸€è‡´ã‚¨ãƒ©ãƒ¼**
```
âŒ ã‚¨ãƒ©ãƒ¼ä¾‹: "Date format error for 'geek_duedate'"
âœ… å¯¾å‡¦æ³•: ISO8601å½¢å¼ï¼ˆYYYY-MM-DDTHH:mm:ssZï¼‰ã§ã®æ—¥ä»˜é€ä¿¡
```

#### **4. dataSourceName ã‚¨ãƒ©ãƒ¼**
```
âŒ ã‚¨ãƒ©ãƒ¼ä¾‹: "Data source '______' not found"
âœ… å¯¾å‡¦æ³•: ã‚µãƒ¼ãƒ“ã‚¹ã‚¯ãƒ©ã‚¹ã® dataSourceName ã‚’ dataSourcesInfo.ts ã®å®Ÿéš›ã®åå‰ã«ä¿®æ­£
```

#### **5. ã‚µãƒ¼ãƒ“ã‚¹ã‚¯ãƒ©ã‚¹ãŒç”Ÿæˆã•ã‚Œãªã„**
```
âŒ å•é¡Œ: pac code add-data-source å®Ÿè¡Œå¾Œã‚‚ãƒ•ã‚¡ã‚¤ãƒ«ãŒç”Ÿæˆã•ã‚Œãªã„
âœ… å¯¾å‡¦æ³•: 
  - Power Apps ã§æ¥ç¶šãŒæ­£ã—ãä½œæˆã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª
  - æ¥ç¶šIDãŒæ­£ã—ã„ã‹ç¢ºèª
  - pac auth list ã§èªè¨¼çŠ¶æ…‹ã‚’ç¢ºèª
```

ã“ã®æ‰‹é †ã«ã‚ˆã‚Šã€Dataverseã¨ã®æ¥ç¶šã§ç™ºç”Ÿã™ã‚‹ä¸€èˆ¬çš„ãªã‚¹ã‚­ãƒ¼ãƒä¸æ•´åˆã‚¨ãƒ©ãƒ¼ã‚’äº‹å‰ã«é˜²æ­¢ã—ã€å®‰å…¨ã«ãƒ¢ãƒƒã‚¯ãƒ‡ãƒ¼ã‚¿ã‹ã‚‰ãƒªã‚¢ãƒ«ãƒ‡ãƒ¼ã‚¿ã¸ç§»è¡Œã§ãã¾ã™ã€‚

### **ğŸ“‹ å¿…é ˆãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ: Dataverseæ¥ç¶šå‰**

#### **é–‹ç™ºè€…ã¸ã®ä¾é ¼äº‹é …**
- [ ] **customizations.xmlãƒ•ã‚¡ã‚¤ãƒ«å–å¾—**: Power Apps ãƒãƒ¼ã‚¿ãƒ«ã‹ã‚‰ã‚½ãƒªãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ
- [ ] **ã‚¹ã‚­ãƒ¼ãƒæŠ½å‡ºå®Ÿè¡Œ**: PowerShellã‚¹ã‚¯ãƒªãƒ—ãƒˆã§ãƒ†ãƒ¼ãƒ–ãƒ«æ§‹é€ ãƒ»Choiceå€¤ã‚’æŠ½å‡º
- [ ] **TypeScriptå‹å®šç¾©ä½œæˆ**: æŠ½å‡ºæƒ…å ±ã«åŸºã¥ãã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹å®šç¾©
- [ ] **Choiceå€¤ãƒãƒƒãƒ”ãƒ³ã‚°**: æ•°å€¤â‡”è¡¨ç¤ºåã®å¤‰æ›ãƒ†ãƒ¼ãƒ–ãƒ«ä½œæˆ
- [ ] **CRUDæ“ä½œæ›´æ–°**: å®Ÿéš›ã®ã‚¹ã‚­ãƒ¼ãƒã«å¯¾å¿œã—ãŸDataverseã‚µãƒ¼ãƒ“ã‚¹å®Ÿè£…
- [ ] **UIãƒ•ã‚©ãƒ¼ãƒ æ›´æ–°**: Choiceå€¤ã‚’ãƒ‰ãƒ­ãƒƒãƒ—ãƒ€ã‚¦ãƒ³ã§é¸æŠå¯èƒ½ãªãƒ•ã‚©ãƒ¼ãƒ 
- [ ] **å‹å®‰å…¨æ€§ç¢ºèª**: TypeScriptã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã‚¨ãƒ©ãƒ¼0ä»¶
- [ ] **çµ±åˆãƒ†ã‚¹ãƒˆ**: ãƒ¢ãƒƒã‚¯ãƒ‡ãƒ¼ã‚¿â†’ãƒªã‚¢ãƒ«ãƒ‡ãƒ¼ã‚¿åˆ‡ã‚Šæ›¿ãˆãƒ†ã‚¹ãƒˆ

### **âš ï¸ ã‚ˆãã‚ã‚‹å•é¡Œã¨å¯¾å‡¦æ³•**

#### **1. Choiceå€¤ã®ä¸ä¸€è‡´ã‚¨ãƒ©ãƒ¼**
```
âŒ ã‚¨ãƒ©ãƒ¼ä¾‹: "Invalid option value '4' for attribute 'geek_priority'"
âœ… å¯¾å‡¦æ³•: customizations.xmlã‹ã‚‰æ­£ç¢ºãªChoiceå€¤ã‚’æŠ½å‡ºãƒ»æ›´æ–°
```

#### **2. å¿…é ˆãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚¨ãƒ©ãƒ¼**  
```
âŒ ã‚¨ãƒ©ãƒ¼ä¾‹: "Required attribute 'geek_name' is missing"
âœ… å¯¾å‡¦æ³•: XMLã®IsValidForCreateå±æ€§ã§Requiredåˆ¤å®šãƒ»ãƒ•ã‚©ãƒ¼ãƒ å¿…é ˆè¨­å®š
```

#### **3. ãƒ‡ãƒ¼ã‚¿å‹ä¸ä¸€è‡´ã‚¨ãƒ©ãƒ¼**
```
âŒ ã‚¨ãƒ©ãƒ¼ä¾‹: "Date format error for 'geek_duedate'"
âœ… å¯¾å‡¦æ³•: ISO8601å½¢å¼ï¼ˆYYYY-MM-DDTHH:mm:ssZï¼‰ã§ã®æ—¥ä»˜é€ä¿¡
```

ã“ã®æ‰‹é †ã«ã‚ˆã‚Šã€Dataverseã¨ã®æ¥ç¶šã§ç™ºç”Ÿã™ã‚‹ä¸€èˆ¬çš„ãªã‚¹ã‚­ãƒ¼ãƒä¸æ•´åˆã‚¨ãƒ©ãƒ¼ã‚’äº‹å‰ã«é˜²æ­¢ã—ã€å®‰å…¨ã«ãƒ¢ãƒƒã‚¯ãƒ‡ãƒ¼ã‚¿ã‹ã‚‰ãƒªã‚¢ãƒ«ãƒ‡ãƒ¼ã‚¿ã¸ç§»è¡Œã§ãã¾ã™ã€‚

### ï¿½ **Dataverse CRUDæ“ä½œå®Ÿè£…ãƒ‘ã‚¿ãƒ¼ãƒ³**

#### **ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—: SDKåˆæœŸåŒ–ã®ç¢ºèª**

```typescript
// src/App.tsx - Power Apps SDKåˆæœŸåŒ–å¾…æ©Ÿ
import { useEffect, useState } from 'react';
import { initialize } from '@microsoft/power-apps';

export default function App() {
  const [isInitialized, setIsInitialized] = useState(false);
  const [error, setError] = useState<string | null>(null);
  const [loading, setLoading] = useState(true);

  useEffect(() => {
    // Power Apps SDK ã®éåŒæœŸåˆæœŸåŒ–
    const init = async () => {
      try {
        await initialize(); // SDKåˆæœŸåŒ–å®Œäº†ã¾ã§å¾…æ©Ÿ
        setIsInitialized(true); // ãƒ‡ãƒ¼ã‚¿æ“ä½œã®æº–å‚™å®Œäº†
      } catch (err) {
        setError('Power Apps SDK ã®åˆæœŸåŒ–ã«å¤±æ•—ã—ã¾ã—ãŸ');
        setLoading(false);
      }
    };

    init();
  }, []);

  // SDKåˆæœŸåŒ–å®Œäº†ã¾ã§ã¯ãƒ‡ãƒ¼ã‚¿æ“ä½œã‚’ç„¡åŠ¹åŒ–
  useEffect(() => {
    if (!isInitialized) return;
    // ã“ã“ã§ãƒ‡ãƒ¼ã‚¿èª­ã¿å–ã‚Šãƒ­ã‚¸ãƒƒã‚¯ã‚’é…ç½®
    setLoading(false);
  }, [isInitialized]);

  if (loading) return <div>Power Apps SDK åˆæœŸåŒ–ä¸­...</div>;
  if (error) return <div>ã‚¨ãƒ©ãƒ¼: {error}</div>;

  return (
    <div>
      {/* ã‚¢ãƒ—ãƒªã®ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ */}
    </div>
  );
}
```

#### **ã‚¤ãƒ³ãƒãƒ¼ãƒˆã¨å‹å®šç¾©**

```typescript
// ç”Ÿæˆã•ã‚ŒãŸã‚µãƒ¼ãƒ“ã‚¹ã¨ãƒ¢ãƒ‡ãƒ«ã®ã‚¤ãƒ³ãƒãƒ¼ãƒˆ
import { AccountsService } from './generated/services/AccountsService';
import type { Accounts } from './generated/models/AccountsModel';
```

#### **Create (ä½œæˆ) æ“ä½œ**

```typescript
// src/hooks/useAccounts.ts
import { useState } from 'react';
import { AccountsService } from '../generated/services/AccountsService';
import type { Accounts } from '../generated/models/AccountsModel';

export const useAccounts = () => {
  const [loading, setLoading] = useState(false);
  const [error, setError] = useState<string | null>(null);

  // æ–°è¦å–å¼•å…ˆä¼æ¥­ä½œæˆ
  const createAccount = async (accountData: Partial<Accounts>) => {
    try {
      setLoading(true);
      setError(null);

      // èª­ã¿å–ã‚Šå°‚ç”¨ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’é™¤å¤–ã—ã¦ä½œæˆ
      const newAccount = {
        name: accountData.name,
        accountnumber: accountData.accountnumber,
        telephone1: accountData.telephone1,
        address1_city: accountData.address1_city,
        statecode: 0, // ã‚¢ã‚¯ãƒ†ã‚£ãƒ–çŠ¶æ…‹
        // æ³¨æ„: accountid, ownerid ãªã©ã®è‡ªå‹•ç”Ÿæˆãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã¯å«ã‚ãªã„
      };

      const result = await AccountsService.create(
        newAccount as Omit<Accounts, 'accountid'>
      );

      if (result.data) {
        console.log('å–å¼•å…ˆä¼æ¥­ãŒä½œæˆã•ã‚Œã¾ã—ãŸ:', result.data);
        return result.data;
      }
    } catch (err) {
      const errorMessage = 'å–å¼•å…ˆä¼æ¥­ã®ä½œæˆã«å¤±æ•—ã—ã¾ã—ãŸ';
      console.error(errorMessage, err);
      setError(errorMessage);
      throw err;
    } finally {
      setLoading(false);
    }
  };

  return { createAccount, loading, error };
};
```

#### **Read (èª­ã¿å–ã‚Š) æ“ä½œ**

```typescript
// å˜ä¸€ãƒ¬ã‚³ãƒ¼ãƒ‰å–å¾—
const getAccount = async (accountId: string) => {
  try {
    const result = await AccountsService.get(accountId);
    if (result.data) {
      console.log('å–å¼•å…ˆä¼æ¥­ã‚’å–å¾—:', result.data);
      return result.data;
    }
  } catch (err) {
    console.error('å–å¼•å…ˆä¼æ¥­ã®å–å¾—ã«å¤±æ•—:', err);
    throw err;
  }
};

// è¤‡æ•°ãƒ¬ã‚³ãƒ¼ãƒ‰å–å¾—ï¼ˆãƒ•ã‚£ãƒ«ã‚¿ãƒ»ã‚½ãƒ¼ãƒˆå¯¾å¿œï¼‰
const getAllAccounts = async () => {
  try {
    const options = {
      select: ['name', 'accountnumber', 'address1_city', 'telephone1'], // å¿…è¦ãªãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®ã¿
      filter: "address1_country eq 'Japan'", // ODataãƒ•ã‚£ãƒ«ã‚¿ãƒ¼
      orderBy: ['name asc'], // ã‚½ãƒ¼ãƒˆæŒ‡å®š
      top: 100, // å–å¾—ä¸Šé™
      maxPageSize: 50, // ãƒšãƒ¼ã‚¸ã‚µã‚¤ã‚º
    };

    const result = await AccountsService.getAll(options);
    if (result.data) {
      console.log(`${result.data.length}ä»¶ã®å–å¼•å…ˆä¼æ¥­ã‚’å–å¾—`);
      return result.data;
    }
    return [];
  } catch (err) {
    console.error('å–å¼•å…ˆä¼æ¥­ä¸€è¦§ã®å–å¾—ã«å¤±æ•—:', err);
    return [];
  }
};
```

#### **Update (æ›´æ–°) æ“ä½œ**

```typescript
// å–å¼•å…ˆä¼æ¥­ã®éƒ¨åˆ†æ›´æ–°
const updateAccount = async (accountId: string, changes: Partial<Accounts>) => {
  try {
    setLoading(true);
    
    // å¤‰æ›´ã•ã‚ŒãŸãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®ã¿ã‚’å«ã‚ã‚‹ï¼ˆé‡è¦ï¼‰
    const updateData = {
      name: changes.name,
      telephone1: changes.telephone1,
      // å¤‰æ›´ã•ã‚Œã¦ã„ãªã„ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã¯å«ã‚ãªã„
    };

    await AccountsService.update(accountId, updateData);
    console.log('å–å¼•å…ˆä¼æ¥­ãŒæ›´æ–°ã•ã‚Œã¾ã—ãŸ');
    
    return true;
  } catch (err) {
    console.error('å–å¼•å…ˆä¼æ¥­ã®æ›´æ–°ã«å¤±æ•—:', err);
    setError('æ›´æ–°ã«å¤±æ•—ã—ã¾ã—ãŸ');
    throw err;
  } finally {
    setLoading(false);
  }
};
```

#### **Delete (å‰Šé™¤) æ“ä½œ**

```typescript
// å–å¼•å…ˆä¼æ¥­ã®å‰Šé™¤
const deleteAccount = async (accountId: string) => {
  try {
    setLoading(true);
    
    await AccountsService.delete(accountId);
    console.log('å–å¼•å…ˆä¼æ¥­ãŒå‰Šé™¤ã•ã‚Œã¾ã—ãŸ');
    
    return true;
  } catch (err) {
    console.error('å–å¼•å…ˆä¼æ¥­ã®å‰Šé™¤ã«å¤±æ•—:', err);
    setError('å‰Šé™¤ã«å¤±æ•—ã—ã¾ã—ãŸ');
    throw err;
  } finally {
    setLoading(false);
  }
};
```

### ğŸ¯ **ã‚µãƒãƒ¼ãƒˆã•ã‚Œã¦ã„ã‚‹æ©Ÿèƒ½**

- âœ… **CRUDæ“ä½œ**: Create, Read, Update, Delete
- âœ… **å§”ä»»ã‚¯ã‚¨ãƒª**: Filter, Sort, Top
- âœ… **ãƒšãƒ¼ã‚¸ãƒ³ã‚°**: maxPageSize, skipTokenå¯¾å¿œ
- âœ… **ODataã‚¯ã‚¨ãƒª**: select, filter, orderBy

### âš ï¸ **æœªã‚µãƒãƒ¼ãƒˆæ©Ÿèƒ½**

- âŒ **é¸æŠãƒªã‚¹ãƒˆã®è¡¨ç¤ºåå–å¾—**: ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆæ¸ˆã¿å€¤ã®å–å¾—
- âŒ **å‚ç…§ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰**: Lookup fields (å¤šæ…‹çš„å‚ç…§å«ã‚€)
- âŒ **Dataverse ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãƒ»é–¢æ•°**: ã‚«ã‚¹ã‚¿ãƒ å‡¦ç†
- âŒ **FetchXML**: è¤‡é›‘ãªã‚¯ã‚¨ãƒªæ§‹æ–‡
- âŒ **ä»£æ›¿ã‚­ãƒ¼**: ãƒ—ãƒ©ã‚¤ãƒãƒªã‚­ãƒ¼ä»¥å¤–ã§ã®ã‚¢ã‚¯ã‚»ã‚¹

## ğŸ”— **Azure SQL Database æ¥ç¶šçµ±åˆ (Microsoft å…¬å¼ä»•æ§˜)**

> **å‚è€ƒãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ**: [Connect your code app to Azure SQL](https://learn.microsoft.com/en-us/power-apps/developer/code-apps/how-to/connect-to-azure-sql)

### ğŸ“‹ **å‰ææ¡ä»¶**

- **Azureã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³**: Azure SQL Databaseä½œæˆæ¨©é™
- **Azure ãƒãƒ¼ã‚¿ãƒ«**: ã‚¢ã‚¯ã‚»ã‚¹æ¨©é™
- **Power Platformç’°å¢ƒ**: Code Appsæœ‰åŠ¹åŒ–æ¸ˆã¿
- **é–‹ç™ºç’°å¢ƒ**: Visual Studio Code + Node.js LTS
- **æ‹¡å¼µæ©Ÿèƒ½**: Power Platform Tools + SQL Server (mssql)

### ğŸ—ï¸ **Step 1: Azure SQL Server & Database ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—**

#### **1.1 Azure SQL Database ä½œæˆ**

```bash
# Azure ãƒãƒ¼ã‚¿ãƒ«æ‰‹é † (https://portal.azure.com/#create/Microsoft.AzureSQL):
# 1. ã€ŒSQL databaseã€â†’ã€ŒSingle databaseã€â†’ã€ŒCreateã€
# 2. Resource Group: rg-codeapps-dev (æ–°è¦ä½œæˆ)
# 3. Database Name: sqldb-codeapps-dev  
# 4. Server: sql-codeapps-dev (æ–°è¦ä½œæˆ)
# 5. Authentication: Microsoft Entra-only authentication (æ¨å¥¨)
# 6. Compute: General Purpose - Serverless (é–‹ç™ºç”¨)
# 7. Networking: Public endpoint, Azure services = Yes, Client IP = Yes
```

#### **1.2 VS Code ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶š**

```bash
# SQL Server (mssql) æ‹¡å¼µæ©Ÿèƒ½ã§ã®æ¥ç¶š:
# 1. Ctrl + Shift + X â†’ SQL Server (mssql) ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
# 2. Ctrl + Alt + D â†’ ã€Œ+ Add Connectionã€
# 3. ã€ŒBrowse Azureã€â†’ Subscription â†’ Server â†’ Database é¸æŠ
# 4. Authentication: Microsoft Entra ID - Universal with MFA support
# 5. ã€ŒSign Inã€â†’ã€ŒConnectã€
```

#### **1.3 ã‚µãƒ³ãƒ—ãƒ«ã‚¹ã‚­ãƒ¼ãƒä½œæˆ**

```sql
-- Projects ãƒ†ãƒ¼ãƒ–ãƒ«ãƒ»ã‚¹ãƒˆã‚¢ãƒ‰ãƒ—ãƒ­ã‚·ãƒ¼ã‚¸ãƒ£ä½œæˆ (Ctrl + Shift + E ã§å®Ÿè¡Œ)

-- æ—¢å­˜ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆå‰Šé™¤ (å®‰å…¨ãªå†å®Ÿè¡Œ)
IF OBJECT_ID('dbo.GetAllProjects', 'P') IS NOT NULL DROP PROCEDURE dbo.GetAllProjects;
IF OBJECT_ID('dbo.Projects', 'U') IS NOT NULL DROP TABLE dbo.Projects;
GO

-- Projects ãƒ†ãƒ¼ãƒ–ãƒ«
CREATE TABLE [dbo].[Projects](
    [ProjectId] [int] IDENTITY(1,1) NOT NULL,
    [Name] [nvarchar](255) NOT NULL,
    [Description] [nvarchar](max) NULL,
    [StartDate] [date] NULL,
    [EndDate] [date] NULL,
    [Status] [nvarchar](50) NOT NULL DEFAULT ('Planning'),
    [Priority] [nvarchar](20) NOT NULL DEFAULT ('Medium'),
    [Budget] [decimal](18, 2) NULL,
    [ProjectManagerEmail] [nvarchar](255) NOT NULL,
    [CreatedBy] [nvarchar](255) NOT NULL,
    [CreatedDate] [datetime2](7) NOT NULL DEFAULT (getutcdate()),
    [IsActive] [bit] NOT NULL DEFAULT (1),
    CONSTRAINT [PK_Projects] PRIMARY KEY ([ProjectId])
);
GO

-- åˆ¶ç´„è¿½åŠ 
ALTER TABLE [dbo].[Projects] ADD CONSTRAINT [CK_Projects_Status] 
CHECK ([Status] IN ('Planning', 'Active', 'On Hold', 'Completed', 'Cancelled'));
ALTER TABLE [dbo].[Projects] ADD CONSTRAINT [CK_Projects_Priority] 
CHECK ([Priority] IN ('Low', 'Medium', 'High', 'Critical'));
GO

-- ã‚¹ãƒˆã‚¢ãƒ‰ãƒ—ãƒ­ã‚·ãƒ¼ã‚¸ãƒ£: å…¨ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå–å¾—
CREATE PROCEDURE [dbo].[GetAllProjects]
AS
BEGIN
    SET NOCOUNT ON;
    SELECT [ProjectId], [Name], [Description], [StartDate], [EndDate],
           [Status], [Priority], [Budget], [ProjectManagerEmail],
           [CreatedBy], [CreatedDate], [IsActive]
    FROM [dbo].[Projects]
    WHERE [IsActive] = 1
    ORDER BY [CreatedDate] DESC;
END
GO

-- ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿
INSERT INTO [dbo].[Projects] ([Name], [Description], [StartDate], [EndDate], [Status], [Priority], [Budget], [ProjectManagerEmail], [CreatedBy]) VALUES
('Website Redesign', 'Complete redesign of company website with modern UI/UX', '2025-06-01', '2025-08-31', 'Active', 'High', 75000.00, 'sarah.johnson@company.com', 'admin@company.com'),
('Mobile App Development', 'Develop iOS and Android mobile application', '2025-07-01', '2025-12-31', 'Planning', 'Critical', 150000.00, 'mike.chen@company.com', 'admin@company.com'),
('Database Migration', 'Migrate legacy database to cloud', '2025-05-15', '2025-09-30', 'Active', 'Medium', 50000.00, 'lisa.williams@company.com', 'admin@company.com');
GO
```

### ğŸ”— **Step 2: Power Platform SQL Server æ¥ç¶šä½œæˆ**

```bash
# Power Apps ã§ã®æ¥ç¶šä½œæˆ:
# 1. https://make.powerapps.com/ â†’ ç’°å¢ƒé¸æŠ
# 2. ã€Œæ¥ç¶šã€â†’ã€Œ+ æ–°ã—ã„æ¥ç¶šã€
# 3. ã€ŒSQL Serverã€é¸æŠ
# 4. Authentication type: Microsoft Entra ID Integrated
# 5. ã€Œä½œæˆã€â†’ èªè¨¼æ‰¿èª
```

### âš¡ **Step 3: Code Apps ã‚¹ãƒˆã‚¢ãƒ‰ãƒ—ãƒ­ã‚·ãƒ¼ã‚¸ãƒ£çµ±åˆ**

```bash
# æ¥ç¶šIDç¢ºèª
pac connection list

# ã‚¹ãƒˆã‚¢ãƒ‰ãƒ—ãƒ­ã‚·ãƒ¼ã‚¸ãƒ£è¿½åŠ 
pac code add-data-source \
  -a "shared_sql" \
  -c "[æ¥ç¶šID]" \
  -d "sql-codeapps-dev.database.windows.net,sqldb-codeapps-dev" \
  -sp "dbo.GetAllProjects"

# ç”Ÿæˆãƒ•ã‚¡ã‚¤ãƒ«:
# src/generated/services/GetAllProjectsService.ts
# src/generated/models/GetAllProjectsModel.ts
```

### ğŸš€ **Step 4: React + Fluent UI å®Ÿè£…**

#### **4.1 ä¾å­˜é–¢ä¿‚ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«**

```bash
# React 18 + Fluent UI
npm install react@^18.0.0 react-dom@^18.0.0 @types/react@^18.0.0 @types/react-dom@^18.0.0
npm install @fluentui/react-components
```

#### **4.2 ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ†ãƒ¼ãƒ–ãƒ«å®Ÿè£…**

```typescript
// src/components/ProjectsTable.tsx - Azure SQL ãƒ‡ãƒ¼ã‚¿è¡¨ç¤º
import React, { useEffect, useState, useCallback } from 'react';
import {
  DataGrid, DataGridHeader, DataGridRow, DataGridHeaderCell,
  DataGridCell, DataGridBody, TableColumnDefinition,
  Spinner, MessageBar, Badge
} from '@fluentui/react-components';
import { GetAllProjectsService } from '../generated/services/GetAllProjectsService';

type ProjectItem = {
  ProjectId?: number;
  Name?: string;
  Status?: string;
  Priority?: string;
  StartDate?: string;
  EndDate?: string;
};

const COLUMNS: TableColumnDefinition<ProjectItem>[] = [
  {
    columnId: 'name',
    renderHeaderCell: () => 'ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå',
    renderCell: (item) => item.Name || '',
  },
  {
    columnId: 'status', 
    renderHeaderCell: () => 'ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹',
    renderCell: (item) => <StatusBadge status={item.Status || ''} />,
  },
  {
    columnId: 'priority',
    renderHeaderCell: () => 'å„ªå…ˆåº¦', 
    renderCell: (item) => <PriorityBadge priority={item.Priority || ''} />,
  },
];

const StatusBadge: React.FC<{ status: string }> = ({ status }) => {
  const getProps = () => {
    switch (status?.toLowerCase()) {
      case 'active': return { appearance: 'filled' as const, color: 'brand' as const };
      case 'completed': return { appearance: 'filled' as const, color: 'success' as const };
      default: return { appearance: 'outline' as const, color: 'subtle' as const };
    }
  };
  return <Badge {...getProps()}>{status}</Badge>;
};

const PriorityBadge: React.FC<{ priority: string }> = ({ priority }) => {
  const getProps = () => {
    switch (priority?.toLowerCase()) {
      case 'critical': return { appearance: 'filled' as const, color: 'danger' as const };
      case 'high': return { appearance: 'filled' as const, color: 'important' as const };
      default: return { appearance: 'outline' as const, color: 'subtle' as const };
    }
  };
  return <Badge {...getProps()}>{priority}</Badge>;
};

const ProjectsTable: React.FC = () => {
  const [projects, setProjects] = useState<ProjectItem[]>([]);
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState<string | null>(null);

  const fetchProjects = useCallback(async () => {
    try {
      setLoading(true);
      const result = await GetAllProjectsService.GetAllProjects();
      
      if (result.success && result.data?.ResultSets?.Table1) {
        const data = Array.isArray(result.data.ResultSets.Table1)
          ? result.data.ResultSets.Table1 as ProjectItem[]
          : [result.data.ResultSets.Table1] as ProjectItem[];
        setProjects(data);
      } else {
        setError('ãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸ');
      }
    } catch (err) {
      setError(err instanceof Error ? err.message : 'ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ');
    } finally {
      setLoading(false);
    }
  }, []);

  useEffect(() => {
    fetchProjects();
  }, [fetchProjects]);

  if (loading) return <Spinner label="èª­ã¿è¾¼ã¿ä¸­..." />;
  if (error) return <MessageBar intent="error">{error}</MessageBar>;
  if (projects.length === 0) return <MessageBar intent="info">ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚Šã¾ã›ã‚“</MessageBar>;

  return (
    <div style={{ padding: '20px' }}>
      <h2>Azure SQL ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ ({projects.length}ä»¶)</h2>
      <DataGrid
        items={projects}
        columns={COLUMNS}
        sortable={true}
        getRowId={(item) => item.ProjectId?.toString() || 'unknown'}
      >
        <DataGridHeader>
          <DataGridRow>
            {({ renderHeaderCell }) => <DataGridHeaderCell>{renderHeaderCell()}</DataGridHeaderCell>}
          </DataGridRow>
        </DataGridHeader>
        <DataGridBody>
          {({ item, rowId }) => (
            <DataGridRow key={rowId}>
              {({ renderCell }) => <DataGridCell>{renderCell(item)}</DataGridCell>}
            </DataGridRow>
          )}
        </DataGridBody>
      </DataGrid>
    </div>
  );
};

export default React.memo(ProjectsTable);
```

### ğŸ§ª **Step 5: ãƒ†ã‚¹ãƒˆãƒ»ãƒ‡ãƒ—ãƒ­ã‚¤**

```bash
# ãƒ­ãƒ¼ã‚«ãƒ«ãƒ†ã‚¹ãƒˆ
npm run dev
# åŒæ„ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã§ã€Œè¨±å¯ã€â†’ Azure SQL ãƒ‡ãƒ¼ã‚¿è¡¨ç¤ºç¢ºèª

# ãƒ‡ãƒ—ãƒ­ã‚¤
npm run build
pac code push
```

### âš ï¸ **ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°**

#### **æ¥ç¶šã‚¨ãƒ©ãƒ¼**
- **ãƒ•ã‚¡ã‚¤ã‚¢ã‚¦ã‚©ãƒ¼ãƒ«**: Azure services = Yes, Client IPè¿½åŠ 
- **èªè¨¼**: Microsoft Entra ID - Universal with MFA
- **ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯**: `Test-NetConnection -ComputerName "server.database.windows.net" -Port 1433`

#### **Runtime ã‚¨ãƒ©ãƒ¼**
- **æ¥ç¶šç¢ºèª**: Power Platform ã§ SQL Serveræ¥ç¶šã®å‹•ä½œç¢ºèª
- **åŒæ„**: ã‚¢ãƒ—ãƒªåˆå›èµ·å‹•æ™‚ã®æ¨©é™è¨±å¯å¿…é ˆ
- **ç’°å¢ƒ**: ãƒ–ãƒ©ã‚¦ã‚¶ãƒ¼ã¨Power Platformç’°å¢ƒã®ä¸€è‡´ç¢ºèª

### ï¿½ğŸ“š **è¿½åŠ ãƒªã‚½ãƒ¼ã‚¹**

- **Azure SQLã®è©³ç´°ã‚¬ã‚¤ãƒ‰**: [ã‚³ãƒ¼ãƒ‰ ã‚¢ãƒ—ãƒªã‚’ Azure SQL ã«æ¥ç¶šã™ã‚‹](https://learn.microsoft.com/ja-jp/power-apps/developer/code-apps/how-to/connect-to-azure-sql)
- **Dataverseçµ±åˆ**: [ã‚³ãƒ¼ãƒ‰ ã‚¢ãƒ—ãƒªã‚’ Dataverse ã«æ¥ç¶šã™ã‚‹](https://learn.microsoft.com/en-us/power-apps/developer/code-apps/how-to/connect-to-dataverse)
- **PAC CLI ãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹**: [pac code ã‚³ãƒãƒ³ãƒ‰](https://learn.microsoft.com/ja-jp/power-platform/developer/cli/reference/code)

## ğŸŒ **å¤–éƒ¨API ã‚¢ã‚¯ã‚»ã‚¹ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³**

### ğŸš¨ **é‡è¦: Power Apps ç’°å¢ƒã§ã® CORS åˆ¶é™**

Power Apps Code Apps ã¯ Power Platform ç’°å¢ƒã§å®Ÿè¡Œã•ã‚Œã‚‹ãŸã‚ã€å¤–éƒ¨APIã¸ã®ç›´æ¥ã‚¢ã‚¯ã‚»ã‚¹ã«ã¯ **CORS (Cross-Origin Resource Sharing)** åˆ¶é™ãŒã‚ã‚Šã¾ã™ã€‚

#### **ğŸ“‹ ã‚¢ã‚¯ã‚»ã‚¹æ–¹æ³•ã®åŒºåˆ†**

| ã‚¢ã‚¯ã‚»ã‚¹å¯¾è±¡ | æ¨å¥¨æ–¹æ³• | ç†ç”± |
|-------------|---------|------|
| **Power Platform ã‚³ãƒã‚¯ã‚¿ãƒ¼** | âœ… ç›´æ¥ã‚¢ã‚¯ã‚»ã‚¹ | CORSåˆ¶é™ãªã—ã€èªè¨¼è‡ªå‹•å‡¦ç† |
| **å¤–éƒ¨API (REST/GraphQL)** | âš ï¸ CORSãƒ—ãƒ­ã‚­ã‚·çµŒç”± | Power Platformç’°å¢ƒã‹ã‚‰ã® CORS åˆ¶é™å›é¿ |
| **Azure Functions/Logic Apps** | âœ… ç›´æ¥ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½ | é©åˆ‡ãª CORS è¨­å®šã«ã‚ˆã‚Šå¯èƒ½ |

### ğŸ”„ **CORSãƒ—ãƒ­ã‚­ã‚·å®Ÿè£…ãƒ‘ã‚¿ãƒ¼ãƒ³**

#### **æ–¹å¼1: Azure Functions ãƒ—ãƒ­ã‚­ã‚· (æ¨å¥¨)**

```typescript
// Azure Functions ãƒ—ãƒ­ã‚­ã‚·å®Ÿè£…ä¾‹
// functions/api/external-proxy/index.ts
import { AzureFunction, Context, HttpRequest } from '@azure/functions';

const httpTrigger: AzureFunction = async (context: Context, req: HttpRequest): Promise<void> => {
    // CORS ãƒ˜ãƒƒãƒ€ãƒ¼è¨­å®š
    context.res = {
        headers: {
            'Access-Control-Allow-Origin': 'https://apps.powerapps.com',
            'Access-Control-Allow-Methods': 'GET, POST, PUT, DELETE, OPTIONS',
            'Access-Control-Allow-Headers': 'Content-Type, Authorization',
        }
    };

    if (req.method === 'OPTIONS') {
        context.res.status = 200;
        return;
    }

    try {
        const targetUrl = req.query.url || req.body?.url;
        const method = req.query.method || req.body?.method || 'GET';
        
        const response = await fetch(targetUrl, {
            method,
            headers: {
                'Content-Type': 'application/json',
                'User-Agent': 'PowerApps-CodeApp-Proxy/1.0',
                ...(req.body?.headers || {})
            },
            body: method !== 'GET' ? JSON.stringify(req.body?.data) : undefined
        });

        const data = await response.json();
        
        context.res = {
            ...context.res,
            status: response.status,
            body: data
        };
    } catch (error) {
        context.res = {
            ...context.res,
            status: 500,
            body: { error: 'ãƒ—ãƒ­ã‚­ã‚·ã‚¨ãƒ©ãƒ¼', details: error.message }
        };
    }
};

export default httpTrigger;
```

#### **æ–¹å¼2: Logic Apps HTTP ãƒˆãƒªã‚¬ãƒ¼**

```json
{
    "definition": {
        "$schema": "https://schema.management.azure.com/providers/Microsoft.Logic/schemas/2016-06-01/workflowdefinition.json#",
        "triggers": {
            "manual": {
                "type": "Request",
                "kind": "Http",
                "inputs": {
                    "schema": {
                        "type": "object",
                        "properties": {
                            "url": { "type": "string" },
                            "method": { "type": "string" },
                            "headers": { "type": "object" },
                            "body": { "type": "object" }
                        }
                    }
                }
            }
        },
        "actions": {
            "HTTP_Request": {
                "type": "Http",
                "inputs": {
                    "method": "@triggerBody()['method']",
                    "uri": "@triggerBody()['url']",
                    "headers": "@triggerBody()['headers']",
                    "body": "@triggerBody()['body']"
                }
            },
            "Response": {
                "type": "Response",
                "inputs": {
                    "statusCode": "@outputs('HTTP_Request')['statusCode']",
                    "headers": {
                        "Access-Control-Allow-Origin": "https://apps.powerapps.com",
                        "Content-Type": "application/json"
                    },
                    "body": "@outputs('HTTP_Request')['body']"
                }
            }
        }
    }
}
```

### âš¡ **React å®Ÿè£…ãƒ‘ã‚¿ãƒ¼ãƒ³**

#### **CORSãƒ—ãƒ­ã‚­ã‚·ç”¨ã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯**

```typescript
// src/hooks/useExternalApi.ts
import { useState, useCallback } from 'react';

interface ExternalApiConfig {
    proxyUrl: string; // Azure Functions ã¾ãŸã¯ Logic Apps ã®ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ
    timeout?: number;
}

interface ApiRequest {
    url: string;
    method?: 'GET' | 'POST' | 'PUT' | 'DELETE';
    headers?: Record<string, string>;
    data?: any;
}

export const useExternalApi = (config: ExternalApiConfig) => {
    const [loading, setLoading] = useState(false);
    const [error, setError] = useState<string | null>(null);

    const callApi = useCallback(async <T = any>(request: ApiRequest): Promise<T> => {
        setLoading(true);
        setError(null);

        try {
            const response = await fetch(config.proxyUrl, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    url: request.url,
                    method: request.method || 'GET',
                    headers: request.headers,
                    data: request.data
                }),
                signal: AbortSignal.timeout(config.timeout || 10000)
            });

            if (!response.ok) {
                throw new Error(`HTTP ${response.status}: ${response.statusText}`);
            }

            const data = await response.json();
            return data as T;
        } catch (err) {
            const errorMessage = err instanceof Error ? err.message : 'ä¸æ˜ãªã‚¨ãƒ©ãƒ¼';
            setError(errorMessage);
            throw new Error(errorMessage);
        } finally {
            setLoading(false);
        }
    }, [config.proxyUrl, config.timeout]);

    return { callApi, loading, error };
};
```

#### **ä½¿ç”¨ä¾‹: å¤–éƒ¨APIé€£æºã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ**

```typescript
// src/components/ExternalApiExample.tsx
import React, { useState, useEffect } from 'react';
import { useExternalApi } from '../hooks/useExternalApi';

interface WeatherData {
    location: string;
    temperature: number;
    description: string;
}

const ExternalApiExample: React.FC = () => {
    const [weatherData, setWeatherData] = useState<WeatherData | null>(null);
    
    // CORSãƒ—ãƒ­ã‚­ã‚·çµŒç”±ã§ã®APIæ¥ç¶š
    const { callApi, loading, error } = useExternalApi({
        proxyUrl: 'https://your-function-app.azurewebsites.net/api/external-proxy',
        timeout: 15000
    });

    const fetchWeather = async () => {
        try {
            const data = await callApi<WeatherData>({
                url: 'https://api.openweathermap.org/data/2.5/weather',
                method: 'GET',
                headers: {
                    'X-API-Key': process.env.REACT_APP_WEATHER_API_KEY || ''
                }
            });
            setWeatherData(data);
        } catch (err) {
            console.error('å¤©æ°—ãƒ‡ãƒ¼ã‚¿å–å¾—ã‚¨ãƒ©ãƒ¼:', err);
        }
    };

    useEffect(() => {
        fetchWeather();
    }, []);

    if (loading) return <div>èª­ã¿è¾¼ã¿ä¸­...</div>;
    if (error) return <div>ã‚¨ãƒ©ãƒ¼: {error}</div>;

    return (
        <div>
            <h3>å¤–éƒ¨APIé€£æºä¾‹</h3>
            {weatherData ? (
                <div>
                    <p>å ´æ‰€: {weatherData.location}</p>
                    <p>æ°—æ¸©: {weatherData.temperature}Â°C</p>
                    <p>å¤©æ°—: {weatherData.description}</p>
                </div>
            ) : (
                <p>å¤©æ°—ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚Šã¾ã›ã‚“</p>
            )}
        </div>
    );
};

export default ExternalApiExample;
```

### ğŸ›¡ï¸ **ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è€ƒæ…®äº‹é …**

#### **ãƒ—ãƒ­ã‚­ã‚·ã‚µãƒ¼ãƒãƒ¼ã®ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£**

- **èªè¨¼**: Azure AD èªè¨¼ã«ã‚ˆã‚‹ãƒ—ãƒ­ã‚­ã‚·ã‚¢ã‚¯ã‚»ã‚¹åˆ¶é™
- **ãƒ¬ãƒ¼ãƒˆåˆ¶é™**: DOS æ”»æ’ƒé˜²æ­¢ã®ãŸã‚ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆåˆ¶é™
- **ãƒ­ã‚°è¨˜éŒ²**: API ã‚¢ã‚¯ã‚»ã‚¹ãƒ­ã‚°ã®è¨˜éŒ²ãƒ»ç›£è¦–
- **APIã‚­ãƒ¼ä¿è­·**: ãƒ—ãƒ­ã‚­ã‚·ã‚µãƒ¼ãƒãƒ¼å´ã§ã®æ©Ÿå¯†æƒ…å ±ç®¡ç†

#### **å®Ÿè£…ä¾‹: ã‚»ã‚­ãƒ¥ã‚¢ãƒ—ãƒ­ã‚­ã‚·**

```typescript
// ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å¼·åŒ–ç‰ˆãƒ—ãƒ­ã‚­ã‚·
const secureHttpTrigger: AzureFunction = async (context: Context, req: HttpRequest) => {
    // 1. Origin æ¤œè¨¼
    const allowedOrigins = ['https://apps.powerapps.com', 'https://make.powerapps.com'];
    const origin = req.headers.origin;
    if (!allowedOrigins.includes(origin)) {
        context.res = { status: 403, body: 'Forbidden origin' };
        return;
    }

    // 2. ãƒ¬ãƒ¼ãƒˆåˆ¶é™ (Redis Cacheåˆ©ç”¨)
    const clientId = req.headers['x-client-id'] || req.ip;
    const rateLimit = await checkRateLimit(clientId);
    if (!rateLimit.allowed) {
        context.res = { status: 429, body: 'Rate limit exceeded' };
        return;
    }

    // 3. URL ãƒ›ãƒ¯ã‚¤ãƒˆãƒªã‚¹ãƒˆæ¤œè¨¼
    const targetUrl = req.body?.url;
    const allowedDomains = ['api.openweathermap.org', 'jsonplaceholder.typicode.com'];
    const urlDomain = new URL(targetUrl).hostname;
    if (!allowedDomains.includes(urlDomain)) {
        context.res = { status: 403, body: 'Domain not allowed' };
        return;
    }

    // 4. API å®Ÿè¡Œãƒ»ãƒ­ã‚°è¨˜éŒ²
    try {
        const result = await executeApiRequest(req.body);
        await logApiRequest(clientId, targetUrl, result.status);
        
        context.res = {
            headers: {
                'Access-Control-Allow-Origin': origin,
                'Access-Control-Allow-Credentials': 'true'
            },
            body: result.data
        };
    } catch (error) {
        await logApiError(clientId, targetUrl, error);
        context.res = { status: 500, body: 'Internal server error' };
    }
};
```

          photo
        };
      } catch (error) {
        console.error('Failed to fetch user profile:', error);
        // ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯
        return {
          displayName: 'ã‚²ã‚¹ãƒˆãƒ¦ãƒ¼ã‚¶ãƒ¼',
          userPrincipalName: 'guest@example.com',
        };
      }
    },
    staleTime: 5 * 60 * 1000, // 5åˆ†é–“ã‚­ãƒ£ãƒƒã‚·ãƒ¥
    retry: 2,
  });
};
```

### Azure SQL Server çµ±åˆ (Microsoft å…¬å¼)

#### å‰ææ¡ä»¶ã¨ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

**å¿…è¦ãªå‰ææ¡ä»¶:**
- Azure ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³
- Power Platform ç’°å¢ƒ (Code Apps æœ‰åŠ¹åŒ–æ¸ˆã¿)
- Visual Studio Code + Power Platform Tools æ‹¡å¼µæ©Ÿèƒ½
- SQL Server (mssql) VS Code æ‹¡å¼µæ©Ÿèƒ½
- Node.js (LTSç‰ˆ)

#### Azure SQL Database ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

**1. Azure SQL Server & Database ä½œæˆ**
```bash
# Azure ãƒãƒ¼ã‚¿ãƒ«ã§ä»¥ä¸‹ã‚’è¨­å®š
ãƒªã‚½ãƒ¼ã‚¹ã‚°ãƒ«ãƒ¼ãƒ—: rg-codeapps-dev
ã‚µãƒ¼ãƒãƒ¼å: sql-codeapps-dev
ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹å: sqldb-codeapps-dev
èªè¨¼æ–¹æ³•: Microsoft Entra ID ã®ã¿
æ¥ç¶šæ–¹æ³•: ãƒ‘ãƒ–ãƒªãƒƒã‚¯ ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ
ãƒ•ã‚¡ã‚¤ã‚¢ã‚¦ã‚©ãƒ¼ãƒ«: Azure ã‚µãƒ¼ãƒ“ã‚¹ã‚¢ã‚¯ã‚»ã‚¹è¨±å¯ + ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ IP è¿½åŠ 
```

**2. VS Code ã§ã®ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒ†ãƒ¼ãƒ–ãƒ«ä½œæˆ**
```sql
-- Projects ãƒ†ãƒ¼ãƒ–ãƒ«ä½œæˆ (Microsoft ã‚µãƒ³ãƒ—ãƒ«)
CREATE TABLE [dbo].[Projects](
    [ProjectId] [int] IDENTITY(1,1) NOT NULL,
    [Name] [nvarchar](255) NOT NULL,
    [Description] [nvarchar](max) NULL,
    [StartDate] [date] NULL,
    [EndDate] [date] NULL,
    [Status] [nvarchar](50) NOT NULL DEFAULT ('Planning'),
    [Priority] [nvarchar](20) NOT NULL DEFAULT ('Medium'),
    [Budget] [decimal](18, 2) NULL,
    [ProjectManagerEmail] [nvarchar](255) NOT NULL,
    [CreatedBy] [nvarchar](255) NOT NULL,
    [CreatedDate] [datetime2](7) NOT NULL DEFAULT (getutcdate()),
    [IsActive] [bit] NOT NULL DEFAULT (1),
    CONSTRAINT [PK_Projects] PRIMARY KEY ([ProjectId])
);

-- ã‚¹ãƒˆã‚¢ãƒ‰ãƒ—ãƒ­ã‚·ãƒ¼ã‚¸ãƒ£ä½œæˆ
CREATE PROCEDURE [dbo].[GetAllProjects]
AS
BEGIN
    SELECT [ProjectId], [Name], [Description], [StartDate], [EndDate],
           [Status], [Priority], [Budget], [ProjectManagerEmail],
           [CreatedBy], [CreatedDate], [IsActive]
    FROM [dbo].[Projects]
    WHERE [IsActive] = 1
    ORDER BY [CreatedDate] DESC;
END
```

#### Power Platform çµ±åˆ

**3. SQL Server ã‚³ãƒã‚¯ã‚·ãƒ§ãƒ³ä½œæˆ**
```bash
# Power Apps (make.powerapps.com) ã§å®Ÿè¡Œ
1. Connections â†’ + New Connection â†’ SQL Server
2. èªè¨¼ã‚¿ã‚¤ãƒ—: Microsoft Entra ID Integrated
3. Create & ã‚µã‚¤ãƒ³ã‚¤ãƒ³
```

**4. Code Apps ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆåˆæœŸåŒ–**
```bash
# Vite ã‚¢ãƒ—ãƒªä½œæˆ (ãƒãƒ¼ãƒˆ3000å›ºå®š)
mkdir C:\CodeApps -Force; cd C:\CodeApps
npm create vite@latest ProjectManagementApp -- --template react-ts
cd C:\CodeApps\ProjectManagementApp
npm install
npm i --save-dev @types/node

# vite.config.ts è¨­å®š (ãƒãƒ¼ãƒˆ3000å¿…é ˆ)
server: { host: "::", port: 3000 }

# Power Platform èªè¨¼ & åˆæœŸåŒ–
pac auth create
pac env select -env <ENVIRONMENT_URL>
pac code init --displayName "Project Management App"
npm install --save-dev @microsoft/power-apps

# package.json æ›´æ–°
"dev": "start pac code run && vite"
```

**5. ã‚¹ãƒˆã‚¢ãƒ‰ãƒ—ãƒ­ã‚·ãƒ¼ã‚¸ãƒ£ã‚’ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ã¨ã—ã¦è¿½åŠ **
```bash
# ã‚³ãƒã‚¯ã‚·ãƒ§ãƒ³ ID ç¢ºèª
pac connection list

# ã‚¹ãƒˆã‚¢ãƒ‰ãƒ—ãƒ­ã‚·ãƒ¼ã‚¸ãƒ£ã‚’ Code Apps ã«è¿½åŠ 
pac code add-data-source -a "shared_sql" -c "[CONNECTION-ID]" \
  -d "[SQL-SERVER].database.windows.net,[DATABASE]" \
  -sp "dbo.GetAllProjects"

# ç”Ÿæˆã•ã‚Œã‚‹ãƒ•ã‚¡ã‚¤ãƒ«:
# generated/services/GetAllProjectsService.ts
# generated/models/GetAllProjectsModel.ts
```

#### TypeScript å®Ÿè£…ãƒ‘ã‚¿ãƒ¼ãƒ³

**6. React + Fluent UI ãƒ‡ãƒ¼ã‚¿ã‚°ãƒªãƒƒãƒ‰å®Ÿè£…**
```typescript
// src/components/ProjectsTable.tsx
import { useEffect, useState, useCallback } from 'react';
import { DataGrid, Spinner, MessageBar } from '@fluentui/react-components';
import { GetAllProjectsService } from '../generated/services/GetAllProjectsService';

type ProjectItem = {
  ProjectId?: number;
  Name?: string;
  Description?: string;
  StartDate?: string;
  EndDate?: string;
  Status?: string;
  Priority?: string;
  Budget?: number;
  ProjectManagerEmail?: string;
};

export const ProjectsTable: React.FC = () => {
  const [projects, setProjects] = useState<ProjectItem[]>([]);
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState<string | null>(null);

  const fetchProjects = useCallback(async () => {
    try {
      setLoading(true);
      setError(null);
      
      const result = await GetAllProjectsService.GetAllProjects();
      
      if (result.success && result.data?.ResultSets?.Table1) {
        const projectsData = Array.isArray(result.data.ResultSets.Table1)
          ? result.data.ResultSets.Table1 as ProjectItem[]
          : [result.data.ResultSets.Table1] as ProjectItem[];
        setProjects(projectsData);
      } else {
        setError('ãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸ');
      }
    } catch (error) {
      setError('äºˆæœŸã—ãªã„ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ');
      console.error('Error fetching projects:', error);
    } finally {
      setLoading(false);
    }
  }, []);

  useEffect(() => {
    fetchProjects();
  }, [fetchProjects]);

  if (loading) return <Spinner label="ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã¿ä¸­..." />;
  if (error) return <MessageBar intent="error">{error}</MessageBar>;

  return (
    <DataGrid items={projects} sortable>
      {/* DataGrid ã‚«ãƒ©ãƒ å®Ÿè£… */}
    </DataGrid>
  );
};
```

**7. ä¾å­˜é–¢ä¿‚ã¨Fluent UIçµ±åˆ**
```bash
# React 18 & Fluent UI ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ« (å¿…é ˆ)
npm install react@^18.0.0 react-dom@^18.0.0 \
  @types/react@^18.0.0 @types/react-dom@^18.0.0
npm install @fluentui/react-components
```

```typescript
// src/main.tsx - FluentProvider è¿½åŠ 
import { FluentProvider, webLightTheme } from '@fluentui/react-components';
import PowerProvider from './PowerProvider';
import ProjectsTable from './ProjectsTable';

createRoot(document.getElementById('root')!).render(
  <StrictMode>
    <PowerProvider>
      <FluentProvider theme={webLightTheme}>
        <ProjectsTable />
      </FluentProvider>
    </PowerProvider>
  </StrictMode>
);
```

#### åˆ¶ç´„äº‹é …ã¨æ³¨æ„ç‚¹

**é‡è¦ãªåˆ¶ç´„:**
- **ãƒãƒ¼ãƒˆ3000å›ºå®š**: Power SDK ã¯é–‹ç™ºæ™‚ã«ãƒãƒ¼ãƒˆ3000ã‚’è¦æ±‚
- **tsconfigè¨­å®š**: `verbatimModuleSyntax: false` ãŒå¿…è¦ (Power SDK åˆ¶é™)
- **React 18å¿…é ˆ**: Fluent UI ã¨ã®äº’æ›æ€§ã®ãŸã‚
- **ã‚¹ãƒˆã‚¢ãƒ‰ãƒ—ãƒ­ã‚·ãƒ¼ã‚¸ãƒ£æ¨å¥¨**: è¤‡é›‘ãªã‚¯ã‚¨ãƒªã¯ã‚¹ãƒˆã‚¢ãƒ‰ãƒ—ãƒ­ã‚·ãƒ¼ã‚¸ãƒ£ã§å®Ÿè£…
- **Microsoft Entra ID**: SQL Server èªè¨¼ã¯ Microsoft Entra ID ã®ã¿ã‚µãƒãƒ¼ãƒˆ

**ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°:**
```bash
# ãƒãƒ¼ãƒˆ3000ãŒä½¿ç”¨ä¸­ã®å ´åˆ
netstat -ano | findstr :3000
taskkill /PID [PID] /F

# SQLæ¥ç¶šã‚¨ãƒ©ãƒ¼ã®å ´åˆ
# 1. Azure SQL ãƒ•ã‚¡ã‚¤ã‚¢ã‚¦ã‚©ãƒ¼ãƒ«è¨­å®šç¢ºèª
# 2. Microsoft Entra ID èªè¨¼è¨­å®šç¢ºèª  
# 3. VS Code SQLæ‹¡å¼µæ©Ÿèƒ½ã§æ‰‹å‹•æ¥ç¶šãƒ†ã‚¹ãƒˆ
```

**SQL Server ã‚³ãƒã‚¯ã‚·ãƒ§ãƒ³è¨­å®š:**
```bash
# 1. Power Apps ã§ SQL Server ã‚³ãƒã‚¯ã‚·ãƒ§ãƒ³ä½œæˆ
# 2. PAC CLI ã§ãƒ†ãƒ¼ãƒ–ãƒ«è¿½åŠ 
pac code add-data-source -a "shared_sql" -c "connection-id" -t "[dbo].[Employees]" -d "server.database.windows.net,database"

# ç”Ÿæˆã•ã‚Œã‚‹ãƒ•ã‚¡ã‚¤ãƒ«:
# /generated/services/EmployeesService.ts
# /generated/models/EmployeesModel.ts
```

**ç”Ÿæˆã•ã‚ŒãŸSQLã‚µãƒ¼ãƒ“ã‚¹ã®ä½¿ç”¨:**
```typescript
// src/hooks/useEmployees.ts
import { useQuery, useMutation, useQueryClient } from '@tanstack/react-query';
import { EmployeesService } from '../generated/services/EmployeesService';
import type { Employees } from '../generated/models/EmployeesModel';

export const useEmployees = () => {
  const queryClient = useQueryClient();

  // å¾“æ¥­å“¡ä¸€è¦§å–å¾—
  const getEmployees = async () => {
    try {
      const result = await EmployeesService.getall();
      return result || [];
    } catch (error) {
      console.error('Failed to fetch employees:', error);
      throw error;
    }
  };

  // å¾“æ¥­å“¡ä½œæˆ
  const createEmployee = async (employeeData: Partial<Employees>) => {
    try {
      const result = await EmployeesService.create(employeeData);
      return result;
    } catch (error) {
      console.error('Failed to create employee:', error);
      throw error;
    }
  };

  // å¾“æ¥­å“¡æ›´æ–°ï¼ˆå¤‰æ›´ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®ã¿ï¼‰
  const updateEmployee = async (id: string, changedFields: Partial<Employees>) => {
    try {
      await EmployeesService.update(id, changedFields);
    } catch (error) {
      console.error(`Failed to update employee ${id}:`, error);
      throw error;
    }
  };

  // å¾“æ¥­å“¡å‰Šé™¤
  const deleteEmployee = async (id: string) => {
    try {
      await EmployeesService.delete(id);
    } catch (error) {
      console.error(`Failed to delete employee ${id}:`, error);
      throw error;
    }
  };

  return {
    getEmployees,
    createEmployee,
    updateEmployee,
    deleteEmployee
  };
};

// React Query ãƒ•ãƒƒã‚¯
export const useEmployeesQuery = () => {
  const { getEmployees } = useEmployees();
  
  return useQuery({
    queryKey: ['employees'],
    queryFn: getEmployees,
    staleTime: 10 * 60 * 1000, // 10åˆ†é–“ã‚­ãƒ£ãƒƒã‚·ãƒ¥
  });
};

export const useCreateEmployeeMutation = () => {
  const { createEmployee } = useEmployees();
  const queryClient = useQueryClient();
  
  return useMutation({
    mutationFn: createEmployee,
    onSuccess: () => {
      queryClient.invalidateQueries({ queryKey: ['employees'] });
    },
  });
};
```

#### Step 2: ãƒ­ãƒ¼ã‚«ãƒ«é–‹ç™ºãƒ»æ¤œè¨¼

**é–‹ç™ºã‚µãƒ¼ãƒèµ·å‹•:**
```bash
# ä¾å­˜é–¢ä¿‚ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
npm install

# ãƒ“ãƒ«ãƒ‰ç¢ºèª
npm run build

# Power Apps Code åˆæœŸåŒ–
pac code init

# ãƒ­ãƒ¼ã‚«ãƒ«é–‹ç™ºé–‹å§‹ (Vite + pac code run)
npm run dev
```

**package.json ã‚¹ã‚¯ãƒªãƒ—ãƒˆä¾‹ (Microsoft å…¬å¼ãƒ‘ã‚¿ãƒ¼ãƒ³):**
```json
{
  "scripts": {
    "dev": "start vite && start pac code run",
    "build": "vite build",
    "build:dev": "vite build --mode development", 
    "lint": "eslint .",
    "preview": "vite preview"
  },
  "dependencies": {
    "@microsoft/power-apps": "^0.3.1",
    "@radix-ui/react-dialog": "^1.x.x",
    "@radix-ui/react-dropdown-menu": "^1.x.x",
    "@radix-ui/react-avatar": "^1.x.x",
    "@tanstack/react-query": "^5.x.x",
    "react-hook-form": "^7.x.x",
    "class-variance-authority": "^0.7.x",
    "clsx": "^2.x.x",
    "lucide-react": "^0.x.x",
    "tailwind-merge": "^2.x.x"
  },
  "devDependencies": {
    "tailwindcss-animate": "^1.x.x"
  }
}
```

**é‡è¦**: 
- `dev` ã‚¹ã‚¯ãƒªãƒ—ãƒˆã§ `vite` ã¨ `pac code run` ã‚’åŒæ™‚èµ·å‹•
- `build:dev` ã§é–‹ç™ºãƒ¢ãƒ¼ãƒ‰ç”¨ãƒ“ãƒ«ãƒ‰
- shadcn/ui ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãƒ©ã‚¤ãƒ–ãƒ©ãƒªã¨TailwindCSSè¨­å®šã‚’å«ã‚€

#### Step 3: ãƒ‡ãƒ¼ã‚¿ã‚³ãƒã‚¯ã‚¿çµ±åˆ (ã‚ªãƒ—ã‚·ãƒ§ãƒ³)

### å…¬å¼ã‚µãƒãƒ¼ãƒˆã‚³ãƒã‚¯ã‚¿ãƒ¼ä¸€è¦§

**Microsoft å…¬å¼ã‚µãƒãƒ¼ãƒˆæ¸ˆã¿ã‚³ãƒã‚¯ã‚¿ãƒ¼:**
- âœ… **SQL Server** (`shared_sql`)
- âœ… **SharePoint** (`shared_sharepoint`)  
- âœ… **Office 365 Users** (`shared_office365users`)
- âœ… **Office 365 Groups** (`shared_office365groups`)
- âœ… **Azure Data Explorer** (`shared_kusto`)
- âœ… **OneDrive for Business** (`shared_onedriveforbusiness`)
- âœ… **Power Apps for Makers** (`shared_powerappsforappmakers`)
- âœ… **Microsoft Teams** (`shared_teams`)
- âœ… **MSN Weather** (`shared_msnweather`)
- âœ… **Microsoft Translator V2** (`shared_microsofttranslator`)
- âœ… **Dataverse** (CRUD æ“ä½œ)

**ã‚³ãƒã‚¯ã‚¿è¨­å®šä¾‹:**
```bash
# Office 365 Users
pac code add-data-source -a "shared_office365users" -c "<connection-id>"

# SQL Server  
pac code add-data-source -a "shared_sql" -c "<connection-id>" -t "[dbo].[TableName]" -d "<server,database>"

# SharePoint
pac code add-data-source -a "shared_sharepoint" -c "<connection-id>" -t "<list-id>" -d "<site-url>"

# Microsoft Teams
pac code add-data-source -a "shared_teams" -c "<connection-id>"

# MSN Weather
pac code add-data-source -a "shared_msnweather" -c "<connection-id>"
  
  const getCurrentUser = async () => {
    try {
      const result = await office365.MyProfile();
      return result.data;
    } catch (error) {
      console.error('Failed to get current user:', error);
      return null;
    }
  };
  
  return { getCurrentUser, office365, outlook };
};
```

#### Step 4: Power Apps ç’°å¢ƒãƒ‡ãƒ—ãƒ­ã‚¤ (Code Apps ã¨ã—ã¦)

**é‡è¦: PCF ã§ã¯ãªã Code Apps ã¨ã—ã¦ãƒ‡ãƒ—ãƒ­ã‚¤**

**Code Apps ãƒ‡ãƒ—ãƒ­ã‚¤ã‚³ãƒãƒ³ãƒ‰:**
```bash
# Power Apps ç’°å¢ƒã« Code Apps ã¨ã—ã¦å…¬é–‹
pac code push
```

**âŒ é–“é•ã„ (PCFç”¨ã‚³ãƒãƒ³ãƒ‰):**
```bash
# ã“ã‚Œã¯ PCF ç”¨ã§ã™ã€‚Code Apps ã§ã¯ä½¿ç”¨ã—ãªã„ã§ãã ã•ã„
pac pcf push  
```

**æˆåŠŸæ™‚ã®å‡ºåŠ›ä¾‹:**
```
Successfully deployed Code App to Power Apps environment
App URL: https://apps.powerapps.com/play/[app-id]
Your Code App is now available as a full application in Power Apps
```

> **ç¢ºèªãƒã‚¤ãƒ³ãƒˆ**: ãƒ‡ãƒ—ãƒ­ã‚¤å¾Œã€Power Apps ã§ **ã‚¢ãƒ—ãƒªä¸€è¦§** ã«è¡¨ç¤ºã•ã‚Œã¾ã™ï¼ˆã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãƒ©ã‚¤ãƒ–ãƒ©ãƒªã§ã¯ã‚ã‚Šã¾ã›ã‚“ï¼‰ã€‚

### ã‚µãƒ³ãƒ—ãƒ«å®Ÿè£…

#### ã‚³ãƒã‚¯ã‚¿åˆ©ç”¨ä¾‹

**Office 365 ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±å–å¾—:**
```typescript
// src/components/UserProfile.tsx
import { useEffect, useState } from 'react';
import { useOffice365 } from '../hooks/useOffice365';

export const UserProfile = () => {
  const [user, setUser] = useState(null);
  const { getCurrentUser } = useOffice365();
  
  useEffect(() => {
    const loadUser = async () => {
      const userData = await getCurrentUser();
      setUser(userData);
    };
    
    loadUser();
  }, []);
  
  if (!user) return <div>Loading...</div>;
  
  return (
    <div>
      <h2>{user.DisplayName}</h2>
      <p>Email: {user.Mail}</p>
      <p>Department: {user.Department}</p>
    </div>
  );
};
```

**SQL ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ“ä½œ:**
```typescript
// src/hooks/useSqlData.ts
import { connector } from '@microsoft/power-apps';

export const useSqlData = () => {
  const sqlConnector = connector('shared_sql');
  
  const getProjects = async (skip = 0, take = 10) => {
    try {
      const result = await sqlConnector.getTable('Projects', {
        skip,
        take,
        orderBy: 'CreatedDate desc'
      });
      return result.data;
    } catch (error) {
      console.error('Failed to load projects:', error);
      return [];
    }
  };
  
  return { getProjects };
};
```

**Dataverse çµ±åˆ (Microsoft å…¬å¼ä»•æ§˜):**

**Step 1: PAC CLI ã§ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ã‚’è¿½åŠ :**
```bash
# Dataverse ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’ã‚³ãƒ¼ãƒ‰ã‚¢ãƒ—ãƒªã«è¿½åŠ 
pac code add-data-source -a dataverse -t accounts
pac code add-data-source -a dataverse -t contacts
pac code add-data-source -a dataverse -t cr123_customtable

# ç”Ÿæˆã•ã‚Œã‚‹ãƒ•ã‚¡ã‚¤ãƒ«:
# /generated/services/AccountsService.ts
# /generated/models/AccountsModel.ts
# /generated/services/ContactsService.ts  
# /generated/models/ContactsModel.ts
```

**Step 2: ç”Ÿæˆã•ã‚ŒãŸã‚µãƒ¼ãƒ“ã‚¹ã‚’ä½¿ç”¨:**
```typescript
// src/hooks/useDataverse.ts
import { useQuery, useMutation, useQueryClient } from '@tanstack/react-query';
import { AccountsService } from '../generated/services/AccountsService';
import { ContactsService } from '../generated/services/ContactsService';
import type { Accounts } from '../generated/models/AccountsModel';
import type { Contacts } from '../generated/models/ContactsModel';

// ã‚¯ã‚¨ãƒªã‚ªãƒ—ã‚·ãƒ§ãƒ³ã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ (Microsoft å…¬å¼)
interface IGetAllOptions {
  maxPageSize?: number;    // ãƒšãƒ¼ã‚¸ã‚ãŸã‚Šã®æœ€å¤§ãƒ¬ã‚³ãƒ¼ãƒ‰æ•°
  select?: string[];       // å–å¾—ã™ã‚‹ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰
  filter?: string;         // OData ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼
  orderBy?: string[];      // ã‚½ãƒ¼ãƒˆ
  top?: number;           // æœ€å¤§å–å¾—æ•°
  skip?: number;          // ã‚¹ã‚­ãƒƒãƒ—æ•°
  skipToken?: string;     // ãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³ç”¨ãƒˆãƒ¼ã‚¯ãƒ³
}

export const useDataverseAccounts = () => {
  const queryClient = useQueryClient();

  // ã‚¢ã‚«ã‚¦ãƒ³ãƒˆä¸€è¦§å–å¾—
  const getAccounts = async (options?: IGetAllOptions) => {
    try {
      const result = await AccountsService.getAll(options);
      return result.data || [];
    } catch (error) {
      console.error('Failed to fetch accounts:', error);
      throw error;
    }
  };

  // å˜ä¸€ã‚¢ã‚«ã‚¦ãƒ³ãƒˆå–å¾—
  const getAccount = async (accountId: string) => {
    try {
      const result = await AccountsService.get(accountId);
      return result.data;
    } catch (error) {
      console.error(`Failed to fetch account ${accountId}:`, error);
      throw error;
    }
  };

  // ã‚¢ã‚«ã‚¦ãƒ³ãƒˆä½œæˆ
  const createAccount = async (accountData: Omit<Accounts, 'accountid'>) => {
    try {
      const result = await AccountsService.create(accountData);
      return result.data;
    } catch (error) {
      console.error('Failed to create account:', error);
      throw error;
    }
  };

  // ã‚¢ã‚«ã‚¦ãƒ³ãƒˆæ›´æ–° (å¤‰æ›´ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®ã¿)
  const updateAccount = async (accountId: string, changes: Partial<Accounts>) => {
    try {
      await AccountsService.update(accountId, changes);
    } catch (error) {
      console.error(`Failed to update account ${accountId}:`, error);
      throw error;
    }
  };

  // ã‚¢ã‚«ã‚¦ãƒ³ãƒˆå‰Šé™¤
  const deleteAccount = async (accountId: string) => {
    try {
      await AccountsService.delete(accountId);
    } catch (error) {
      console.error(`Failed to delete account ${accountId}:`, error);
      throw error;
    }
  };

  return {
    getAccounts,
    getAccount,
    createAccount,
    updateAccount,
    deleteAccount
  };
};

export const useDataverseContacts = () => {
  const queryClient = useQueryClient();

  // é€£çµ¡å…ˆä¸€è¦§å–å¾—
  const getContacts = async (options?: IGetAllOptions) => {
    try {
      const result = await ContactsService.getAll(options);
      return result.data || [];
    } catch (error) {
      console.error('Failed to fetch contacts:', error);
      throw error;
    }
  };

  // å˜ä¸€é€£çµ¡å…ˆå–å¾—
  const getContact = async (contactId: string) => {
    try {
      const result = await ContactsService.get(contactId);
      return result.data;
    } catch (error) {
      console.error(`Failed to fetch contact ${contactId}:`, error);
      throw error;
    }
  };

  // é€£çµ¡å…ˆä½œæˆ
  const createContact = async (contactData: Omit<Contacts, 'contactid'>) => {
    try {
      const result = await ContactsService.create(contactData);
      return result.data;
    } catch (error) {
      console.error('Failed to create contact:', error);
      throw error;
    }
  };

  // é€£çµ¡å…ˆæ›´æ–° (å¤‰æ›´ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®ã¿)
  const updateContact = async (contactId: string, changes: Partial<Contacts>) => {
    try {
      await ContactsService.update(contactId, changes);
    } catch (error) {
      console.error(`Failed to update contact ${contactId}:`, error);
      throw error;
    }
  };

  // é€£çµ¡å…ˆå‰Šé™¤
  const deleteContact = async (contactId: string) => {
    try {
      await ContactsService.delete(contactId);
    } catch (error) {
      console.error(`Failed to delete contact ${contactId}:`, error);
      throw error;
    }
  };

  return {
    getContacts,
    getContact,
    createContact,
    updateContact,
    deleteContact
  };
};

// React Query çµ±åˆãƒ•ãƒƒã‚¯ (Microsoft å…¬å¼ãƒ‘ã‚¿ãƒ¼ãƒ³)
export const useAccountsQuery = (options?: IGetAllOptions) => {
  const { getAccounts } = useDataverseAccounts();
  
  return useQuery({
    queryKey: ['dataverse', 'accounts', options],
    queryFn: () => getAccounts(options),
    staleTime: 5 * 60 * 1000, // 5åˆ†é–“ã‚­ãƒ£ãƒƒã‚·ãƒ¥
  });
};

export const useAccountQuery = (accountId: string) => {
  const { getAccount } = useDataverseAccounts();
  
  return useQuery({
    queryKey: ['dataverse', 'accounts', accountId],
    queryFn: () => getAccount(accountId),
    enabled: !!accountId,
  });
};

export const useCreateAccountMutation = () => {
  const { createAccount } = useDataverseAccounts();
  const queryClient = useQueryClient();
  
  return useMutation({
    mutationFn: (accountData: Omit<Accounts, 'accountid'>) => createAccount(accountData),
    onSuccess: () => {
      queryClient.invalidateQueries({ queryKey: ['dataverse', 'accounts'] });
    },
  });
};

export const useUpdateAccountMutation = () => {
  const { updateAccount } = useDataverseAccounts();
  const queryClient = useQueryClient();
  
  return useMutation({
    mutationFn: ({ accountId, changes }: { accountId: string; changes: Partial<Accounts> }) => 
      updateAccount(accountId, changes),
    onSuccess: (_, { accountId }) => {
      queryClient.invalidateQueries({ queryKey: ['dataverse', 'accounts'] });
      queryClient.invalidateQueries({ queryKey: ['dataverse', 'accounts', accountId] });
    },
  });
};

export const useDeleteAccountMutation = () => {
  const { deleteAccount } = useDataverseAccounts();
  const queryClient = useQueryClient();
  
  return useMutation({
    mutationFn: (accountId: string) => deleteAccount(accountId),
    onSuccess: (_, accountId) => {
      queryClient.invalidateQueries({ queryKey: ['dataverse', 'accounts'] });
      queryClient.removeQueries({ queryKey: ['dataverse', 'accounts', accountId] });
    },
  });
};
```

**å®Ÿç”¨çš„ãªã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆä¾‹ (Microsoft å…¬å¼ãƒ‘ã‚¿ãƒ¼ãƒ³):**
```typescript
// src/components/AccountManager.tsx
import { useState } from 'react';
import { useAccountsQuery, useCreateAccountMutation, useUpdateAccountMutation } from '@/hooks/useDataverse';
import type { Accounts } from '../generated/models/AccountsModel';

export const AccountManager = () => {
  // ã‚¢ã‚«ã‚¦ãƒ³ãƒˆä¸€è¦§å–å¾—ï¼ˆãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰åˆ¶é™ã¨ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ä»˜ãï¼‰
  const { data: accounts, isLoading, error } = useAccountsQuery({
    select: ['name', 'accountnumber', 'address1_city', 'telephone1'],
    filter: "address1_country eq 'USA'",
    orderBy: ['name asc'],
    top: 50
  });

  // ãƒŸãƒ¥ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³
  const createAccountMutation = useCreateAccountMutation();
  const updateAccountMutation = useUpdateAccountMutation();

  // æ–°è¦ã‚¢ã‚«ã‚¦ãƒ³ãƒˆä½œæˆ
  const handleCreateAccount = async (accountData: Partial<Accounts>) => {
    try {
      // ã‚·ã‚¹ãƒ†ãƒ ç®¡ç†ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã¯é™¤å¤–
      const newAccount = {
        name: accountData.name!,
        statecode: 0, // Active
        accountnumber: accountData.accountnumber,
        telephone1: accountData.telephone1,
        address1_city: accountData.address1_city
        // accountid, ownerid ãªã©ã¯å«ã‚ãªã„
      };

      const result = await createAccountMutation.mutateAsync(newAccount as Omit<Accounts, 'accountid'>);
      
      if (result) {
        console.log('Account created:', result);
      }
    } catch (error) {
      console.error('Failed to create account:', error);
    }
  };

  // ã‚¢ã‚«ã‚¦ãƒ³ãƒˆæ›´æ–°ï¼ˆå¤‰æ›´ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®ã¿ï¼‰
  const handleUpdateAccount = async (accountId: string, changes: Partial<Accounts>) => {
    try {
      // å¤‰æ›´ã•ã‚ŒãŸãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®ã¿ã‚’é€ä¿¡
      const updateData = {
        name: changes.name,
        telephone1: changes.telephone1
        // å¤‰æ›´ã—ã¦ã„ãªã„ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã¯å«ã‚ãªã„
      };

      await updateAccountMutation.mutateAsync({
        accountId,
        changes: updateData
      });
      
      console.log('Account updated successfully');
    } catch (error) {
      console.error('Failed to update account:', error);
    }
  };

  if (isLoading) return <div className="p-4">ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’èª­ã¿è¾¼ã¿ä¸­...</div>;
  if (error) return <div className="p-4 text-red-500">ã‚¨ãƒ©ãƒ¼: {error.message}</div>;

  return (
    <div className="space-y-4">
      <h2 className="text-xl font-bold">ã‚¢ã‚«ã‚¦ãƒ³ãƒˆç®¡ç†</h2>
      
      {accounts?.map((account: Accounts) => (
        <div key={account.accountid} className="p-4 border rounded-lg">
          <h3 className="font-semibold">{account.name}</h3>
          <p className="text-gray-600">ç•ªå·: {account.accountnumber}</p>
          <p className="text-gray-600">éƒ½å¸‚: {account.address1_city}</p>
          <p className="text-gray-600">é›»è©±: {account.telephone1}</p>
        </div>
      ))}
      
      {createAccountMutation.isPending && (
        <div className="text-blue-500">ä½œæˆä¸­...</div>
      )}
    </div>
  );
};
```

**ã‚«ã‚¹ã‚¿ãƒ ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã®æ“ä½œä¾‹:**
```typescript
// src/hooks/useProjectManagement.ts - ã‚«ã‚¹ã‚¿ãƒ ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ä¾‹
import { useDataverseEntities, useCreateDataverseEntity } from '@/hooks/useDataverse';

// ã‚«ã‚¹ã‚¿ãƒ ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£: ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆç®¡ç†
export const useProjectManagement = () => {
  // ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä¸€è¦§ï¼ˆã‚«ã‚¹ã‚¿ãƒ ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£: new_projectï¼‰
  const useProjects = () => useDataverseEntities('new_projects', {
    $select: 'new_projectid,new_name,new_description,new_startdate,new_enddate,new_status',
    $orderby: 'new_startdate desc'
  });

  // ã‚¿ã‚¹ã‚¯ä¸€è¦§ï¼ˆã‚«ã‚¹ã‚¿ãƒ ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£: new_taskï¼‰
  const useProjectTasks = (projectId: string) => useDataverseEntities('new_tasks', {
    $select: 'new_taskid,new_name,new_description,new_duedate,new_status,new_assignedto',
    $filter: `_new_projectid_value eq ${projectId}`,
    $orderby: 'new_duedate asc'
  });

  // ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä½œæˆ
  const useCreateProject = () => useCreateDataverseEntity('new_projects');

  return {
    useProjects,
    useProjectTasks,
    useCreateProject
  };
};

// ã‚¿ã‚¤ãƒ—ã‚»ãƒ¼ãƒ•ãªã‚¤ãƒ³ã‚¿ãƒ¼faceså®šç¾©
export interface Contact extends DataverseEntity {
  contactid: string;
  firstname?: string;
  lastname?: string;
  fullname?: string;
  emailaddress1?: string;
  telephone1?: string;
  birthdate?: string;
  accountid?: string;
}

export interface Account extends DataverseEntity {
  accountid: string;
  name: string;
  websiteurl?: string;
  telephone1?: string;
  emailaddress1?: string;
}

// ã‚¿ã‚¤ãƒ—ã‚»ãƒ¼ãƒ•ãªä½¿ç”¨ä¾‹
export const ContactsList = () => {
  const { data: contacts, isLoading, error } = useDataverseEntities('contacts', {
    $select: 'contactid,firstname,lastname,emailaddress1,telephone1',
    $orderby: 'lastname asc',
    $top: 100
  });

  const createContactMutation = useCreateDataverseEntity('contacts');

  const handleCreateContact = async (contactData: Partial<Contact>) => {
    try {
      await createContactMutation.mutateAsync({
        firstname: contactData.firstname,
        lastname: contactData.lastname,
        emailaddress1: contactData.emailaddress1,
        telephone1: contactData.telephone1
      });
    } catch (error) {
      console.error('é€£çµ¡å…ˆä½œæˆã‚¨ãƒ©ãƒ¼:', error);
      // ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ•ãƒ¬ãƒ³ãƒ‰ãƒªãƒ¼ãªã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸è¡¨ç¤º
    }
  };

  if (isLoading) return <div className="p-4">é€£çµ¡å…ˆã‚’èª­ã¿è¾¼ã¿ä¸­...</div>;
  if (error) return <div className="p-4 text-red-500">ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ: {error.message}</div>;

  return (
    <div className="space-y-4">
      <h2 className="text-xl font-bold">é€£çµ¡å…ˆä¸€è¦§</h2>
      {contacts?.map((contact: Contact) => (
        <div key={contact.contactid} className="p-4 border rounded-lg">
          <h3 className="font-semibold">
            {contact.firstname} {contact.lastname}
          </h3>
          {contact.emailaddress1 && (
            <p className="text-gray-600">Email: {contact.emailaddress1}</p>
          )}
          {contact.telephone1 && (
            <p className="text-gray-600">Tel: {contact.telephone1}</p>
          )}
        </div>
      ))}
    </div>
  );
};
```

### ã‚³ãƒã‚¯ã‚¿çµ±åˆã®ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹

**1. ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ç®¡ç†ã®ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼:**
```bash
# ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹è¿½åŠ 
pac code add-data-source -a "shared_office365users" -c "<connection-id>"

# ç”Ÿæˆã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«ç¢ºèª
ls generated/services/   # Office365UsersService.ts
ls generated/models/     # Office365UsersModel.ts

# ã‚¹ã‚­ãƒ¼ãƒå¤‰æ›´æ™‚ã®å¯¾å¿œ
pac code delete-data-source -a "shared_sql" -ds "TableName"
pac code add-data-source -a "shared_sql" -c "<connection-id>" -t "[dbo].[TableName]" -d "<server,database>"

# ä¸è¦ãªãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹å‰Šé™¤
pac code delete-data-source -a "shared_sharepoint" -ds "ListName"
```

**2. ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–:**
```typescript
// é©åˆ‡ãªã‚­ãƒ£ãƒƒã‚·ãƒ¥æˆ¦ç•¥
export const useOptimizedData = () => {
  return useQuery({
    queryKey: ['data', 'optimized'],
    queryFn: fetchData,
    staleTime: 10 * 60 * 1000,  // 10åˆ†ã‚­ãƒ£ãƒƒã‚·ãƒ¥
    cacheTime: 30 * 60 * 1000,  // 30åˆ†ä¿æŒ
    refetchOnWindowFocus: false, // ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ãƒ•ã‚©ãƒ¼ã‚«ã‚¹æ™‚ã®å†å–å¾—ç„¡åŠ¹
  });
};

// ãƒãƒƒãƒå‡¦ç†ã¨ãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³
const processBatch = async (items: any[], batchSize = 10) => {
  const batches = [];
  for (let i = 0; i < items.length; i += batchSize) {
    batches.push(items.slice(i, i + batchSize));
  }
  
  for (const batch of batches) {
    await Promise.all(batch.map(item => processItem(item)));
    // ãƒãƒƒãƒé–“ã®å¾…æ©Ÿã§ API ãƒ¬ãƒ¼ãƒˆåˆ¶é™å›é¿
    await new Promise(resolve => setTimeout(resolve, 100));
  }
};
```

**3. ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ãƒ‘ã‚¿ãƒ¼ãƒ³:**
```typescript
// åŒ…æ‹¬çš„ãªã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°
export const useRobustDataFetch = () => {
  return useQuery({
    queryKey: ['data'],
    queryFn: async () => {
      try {
        return await DataService.getData();
      } catch (error: any) {
        // ã‚³ãƒã‚¯ã‚·ãƒ§ãƒ³å›ºæœ‰ã®ã‚¨ãƒ©ãƒ¼å‡¦ç†
        if (error?.status === 401) {
          throw new Error('èªè¨¼ãŒå¿…è¦ã§ã™ã€‚Power Apps ã§å†åº¦ã‚µã‚¤ãƒ³ã‚¤ãƒ³ã—ã¦ãã ã•ã„ã€‚');
        }
        if (error?.status === 403) {
          throw new Error('ã‚¢ã‚¯ã‚»ã‚¹æ¨©é™ãŒã‚ã‚Šã¾ã›ã‚“ã€‚ç®¡ç†è€…ã«ãŠå•ã„åˆã‚ã›ãã ã•ã„ã€‚');
        }
        if (error?.status >= 500) {
          throw new Error('ã‚µãƒ¼ãƒãƒ¼ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚ã—ã°ã‚‰ãå¾…ã£ã¦ã‹ã‚‰å†è©¦è¡Œã—ã¦ãã ã•ã„ã€‚');
        }
        throw new Error(`ãƒ‡ãƒ¼ã‚¿å–å¾—ã‚¨ãƒ©ãƒ¼: ${error?.message || 'Unknown error'}`);
      }
    },
    retry: (failureCount, error: any) => {
      // 4xx ã‚¨ãƒ©ãƒ¼ã¯ãƒªãƒˆãƒ©ã‚¤ã—ãªã„
      if (error?.status >= 400 && error?.status < 500) {
        return false;
      }
      // 3å›ã¾ã§ãƒªãƒˆãƒ©ã‚¤
      return failureCount < 3;
    },
    retryDelay: attemptIndex => Math.min(1000 * 2 ** attemptIndex, 30000),
  });
};
```

**é‡è¦ãªå®Ÿè£…ãƒã‚¤ãƒ³ãƒˆ (Microsoft å…¬å¼ä»•æ§˜):**

**1. SDK åˆæœŸåŒ–ã®ç¢ºèª:**
```typescript
// src/App.tsx - å¿…é ˆã®åˆæœŸåŒ–ãƒ‘ã‚¿ãƒ¼ãƒ³
import { useEffect, useState } from 'react';
import { initialize } from '@microsoft/power-apps/app';

export default function App() {
  const [isInitialized, setIsInitialized] = useState(false);
  const [error, setError] = useState<string | null>(null);

  useEffect(() => {
    const init = async () => {
      try {
        await initialize(); // SDK åˆæœŸåŒ–ã‚’å¾…æ©Ÿ
        setIsInitialized(true);
      } catch (err) {
        setError('Failed to initialize Power Apps SDK');
        console.error('SDK initialization failed:', err);
      }
    };
    
    init();
  }, []);

  // åˆæœŸåŒ–å®Œäº†ã¾ã§å¾…æ©Ÿ
  if (!isInitialized) {
    return <div>Power Apps SDK ã‚’åˆæœŸåŒ–ä¸­...</div>;
  }

  if (error) {
    return <div>ã‚¨ãƒ©ãƒ¼: {error}</div>;
  }

  return <YourMainComponent />;
}
```

**2. Dataverse ãƒ†ãƒ¼ãƒ–ãƒ«è¿½åŠ ã®ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼:**
```bash
# 1. ç’°å¢ƒã«æ¥ç¶š
pac auth create --url https://yourenvironment.crm.dynamics.com

# 2. Code Apps ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã« Dataverse ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’è¿½åŠ 
pac code add-data-source -a dataverse -t accounts
pac code add-data-source -a dataverse -t contacts
pac code add-data-source -a dataverse -t cr123_projects  # ã‚«ã‚¹ã‚¿ãƒ ãƒ†ãƒ¼ãƒ–ãƒ«

# 3. è‡ªå‹•ç”Ÿæˆã•ã‚Œã‚‹ãƒ•ã‚¡ã‚¤ãƒ«ç¢ºèª
ls generated/services/   # AccountsService.ts, ContactsService.ts
ls generated/models/     # AccountsModel.ts, ContactsModel.ts
```

**3. ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰åˆ¶é™ã¨ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹:**
```typescript
// å¸¸ã« select ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã§ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’åˆ¶é™
const options: IGetAllOptions = {
  select: ['name', 'accountnumber', 'telephone1'], // å¿…è¦ãªãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®ã¿
  filter: "statecode eq 0", // ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ã®ã¿
  top: 100 // é©åˆ‡ãªä¸Šé™è¨­å®š
};

// ã™ã¹ã¦ã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’å–å¾—ã™ã‚‹ã®ã¯é¿ã‘ã‚‹
// const badOptions = { }; // ã“ã‚Œã¯é¿ã‘ã‚‹
```

### è¡¨å½¢å¼ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ã®é«˜åº¦ãªæ´»ç”¨

**SharePoint ãƒªã‚¹ãƒˆçµ±åˆ:**
```bash
# SharePoint ãƒªã‚¹ãƒˆã®è¿½åŠ 
pac code add-data-source -a "shared_sharepoint" -c "<connection-id>" -t "<list-guid>" -d "<site-url>"

# Dataset name ã¨ Table ID ã®å–å¾—æ–¹æ³•:
# 1. Canvas ã‚¢ãƒ—ãƒªã§ã‚³ãƒã‚¯ã‚·ãƒ§ãƒ³ã‚’ã‚®ãƒ£ãƒ©ãƒªãƒ¼ã«æ¥ç¶š
# 2. ã‚¢ãƒ—ãƒªã‚’å…¬é–‹ãƒ»å®Ÿè¡Œ
# 3. ãƒ–ãƒ©ã‚¦ã‚¶é–‹ç™ºè€…ãƒ„ãƒ¼ãƒ«ã§ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¿ãƒ–ã‚’ç¢ºèª
# 4. APIM ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‹ã‚‰å€¤ã‚’æŠ½å‡º:
# https://.../sharepoint/<Connection-ID>/datasets/<Dataset-name>/tables/<Table-ID>/items
```

**ã‚¹ãƒˆã‚¢ãƒ‰ãƒ—ãƒ­ã‚·ãƒ¼ã‚¸ãƒ£ãƒ¼æ´»ç”¨:**
```bash
# ã‚¹ãƒˆã‚¢ãƒ‰ãƒ—ãƒ­ã‚·ãƒ¼ã‚¸ãƒ£ãƒ¼ã‚’ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ã¨ã—ã¦è¿½åŠ 
pac code add-data-source -a "shared_sql" -c "<connection-id>" -d "<server,database>" -sp "[dbo].[GetUserReports]"

# ç”Ÿæˆã•ã‚Œã‚‹ã‚µãƒ¼ãƒ“ã‚¹ä¾‹:
# GetUserReportsService.ts
```

```typescript
// src/hooks/useStoredProcedures.ts
import { GetUserReportsService } from '../generated/services/GetUserReportsService';

export const useUserReports = () => {
  const getUserReports = async (userId: string, startDate: string, endDate: string) => {
    try {
      // ã‚¹ãƒˆã‚¢ãƒ‰ãƒ—ãƒ­ã‚·ãƒ¼ã‚¸ãƒ£ãƒ¼ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿æ¸¡ã—
      const result = await GetUserReportsService.execute({
        UserId: userId,
        StartDate: startDate,
        EndDate: endDate
      });
      return result;
    } catch (error) {
      console.error('Failed to execute stored procedure:', error);
      throw error;
    }
  };

  return { getUserReports };
};
```

**Azure Data Explorer (Kusto) çµ±åˆ:**
```bash
# Kusto ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹è¿½åŠ 
pac code add-data-source -a "shared_kusto" -c "<connection-id>"
```

```typescript
// src/hooks/useKustoQuery.ts
import { KustoService } from '../generated/services/KustoService';

export const useKustoAnalytics = () => {
  const runKustoQuery = async (query: string) => {
    try {
      const result = await KustoService.query({
        Query: query,
        Database: 'analytics-db'
      });
      return result.data;
    } catch (error) {
      console.error('Kusto query failed:', error);
      throw error;
    }
  };

  // ä½¿ç”¨ä¾‹: ãƒ­ã‚°åˆ†æ
  const getErrorLogs = async (timeRange: string) => {
    const query = `
      LogsTable
      | where TimeGenerated > ago(${timeRange})
      | where Level == "Error"
      | summarize count() by bin(TimeGenerated, 1h)
      | order by TimeGenerated desc
    `;
    
    return runKustoQuery(query);
  };

  return { runKustoQuery, getErrorLogs };
};
```

**4. ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°:**
```typescript
// æ¥ç¶šè¨ºæ–­ãƒ˜ãƒ«ãƒ‘ãƒ¼
export const diagnoseConnections = async () => {
  const results = [];
  
  try {
    // Office 365 Users æ¥ç¶šãƒ†ã‚¹ãƒˆ
    const profile = await Office365UsersService.MyProfile();
    results.push({ service: 'Office365Users', status: 'OK', data: profile });
  } catch (error) {
    results.push({ service: 'Office365Users', status: 'ERROR', error: error.message });
  }

  try {
    // SQL æ¥ç¶šãƒ†ã‚¹ãƒˆ  
    const sqlTest = await SqlService.getall();
    results.push({ service: 'SQL', status: 'OK', count: sqlTest?.length || 0 });
  } catch (error) {
    results.push({ service: 'SQL', status: 'ERROR', error: error.message });
  }

  return results;
};

// é–‹ç™ºç’°å¢ƒã§ã®ã¿å®Ÿè¡Œ
if (process.env.NODE_ENV === 'development') {
  diagnoseConnections().then(console.log);
}
```

**5. ç¾åœ¨æœªå¯¾å¿œã®æ©Ÿèƒ½:**
```typescript
// Microsoft å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚ˆã‚Šã€ä»¥ä¸‹ã¯æœªå¯¾å¿œ:
// - æ–°è¦ã‚³ãƒã‚¯ã‚·ãƒ§ãƒ³ä½œæˆ (PAC CLI çµŒç”±)
// - ä¸€éƒ¨ã‚³ãƒã‚¯ã‚¿ãƒ¼ã®é«˜åº¦ãªæ©Ÿèƒ½
// - ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ é€šçŸ¥ãƒ»Webhook
// - ãƒãƒ«ã‚¯æ“ä½œã®æœ€é©åŒ–
```
```

**ãƒ¢ãƒƒã‚¯ ãƒ‡ãƒ¼ã‚¿ã‹ã‚‰å®Ÿãƒ‡ãƒ¼ã‚¿ã¸ã®ç§»è¡Œ:**
```typescript
// é–‹ç™ºæ™‚: ãƒ¢ãƒƒã‚¯ãƒ‡ãƒ¼ã‚¿ä½¿ç”¨
import { mockUsers } from '../mockData/office365Data';
const users = mockUsers;

// æœ¬ç•ª: å®Ÿã‚³ãƒã‚¯ã‚¿ä½¿ç”¨
const { office365 } = useOffice365();
const users = await office365.SearchUser(searchTerm, 50);
```

### æ¤œè¨¼ãƒ»ãƒ†ã‚¹ãƒˆ

#### MVP æ¤œè¨¼ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

**ãƒ­ãƒ¼ã‚«ãƒ«æ¤œè¨¼:**
- [ ] `pac code init` ãŒæˆåŠŸã™ã‚‹
- [ ] `npm run dev` ã§ãƒ­ãƒ¼ã‚«ãƒ«é–‹ç™ºã‚µãƒ¼ãƒãŒèµ·å‹•ã™ã‚‹
- [ ] Power Platform SDK ãŒæ­£å¸¸ã«åˆæœŸåŒ–ã•ã‚Œã‚‹
- [ ] React ã‚¢ãƒ—ãƒªãŒæ­£å¸¸ã«è¡¨ç¤ºã•ã‚Œã‚‹
- [ ] ãƒ–ãƒ©ã‚¦ã‚¶ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã«ã‚¨ãƒ©ãƒ¼ãŒå‡ºãªã„

**Code Apps ãƒ‡ãƒ—ãƒ­ã‚¤æ¤œè¨¼:**
- [ ] `pac code push` ã§ **Code Apps ã¨ã—ã¦** ãƒ‡ãƒ—ãƒ­ã‚¤ãŒæˆåŠŸã™ã‚‹
- [ ] Power Apps ã® **ã‚¢ãƒ—ãƒªä¸€è¦§** ã«è¡¨ç¤ºã•ã‚Œã‚‹ (ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãƒ©ã‚¤ãƒ–ãƒ©ãƒªã§ã¯ãªã„)
- [ ] Power Apps URL ã§ã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹
- [ ] Power Platform ç’°å¢ƒå†…ã§ **ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã¨ã—ã¦** æ­£å¸¸å‹•ä½œã™ã‚‹
- [ ] ã‚³ãƒã‚¯ã‚¿ãŒæ­£å¸¸ã«æ¥ç¶šã•ã‚Œã‚‹ (ä½¿ç”¨æ™‚)

> **ç¢ºèªæ–¹æ³•**: [make.powerapps.com](https://make.powerapps.com) â†’ ã‚¢ãƒ—ãƒª â†’ ã‚ãªãŸã® Code Apps ãŒä¸€è¦§ã«è¡¨ç¤ºã•ã‚Œã‚‹

#### ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹å®Ÿè£…

```typescript
// tests/PowerProvider.test.tsx
import { render, screen } from '@testing-library/react';
import { vi } from 'vitest';
import PowerProvider from '../src/PowerProvider';

// Power Apps SDK ã®ãƒ¢ãƒƒã‚¯
vi.mock('@microsoft/power-apps/app', () => ({
  initialize: vi.fn().mockResolvedValue(undefined)
}));

describe('PowerProvider', () => {
  test('å­ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãŒãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã•ã‚Œã‚‹', () => {
    render(
      <PowerProvider>
        <div>Test Child</div>
      </PowerProvider>
    );
    
    expect(screen.getByText('Test Child')).toBeInTheDocument();
  });
  
  test('SDKåˆæœŸåŒ–ãŒå‘¼ã°ã‚Œã‚‹', async () => {
    const { initialize } = await import('@microsoft/power-apps/app');
    
    render(
      <PowerProvider>
        <div>Test</div>
      </PowerProvider>
    );
    
    expect(initialize).toHaveBeenCalled();
  });
});
```

#### çµ±åˆãƒ†ã‚¹ãƒˆ

```typescript
// tests/integration/connector.test.ts
import { renderHook } from '@testing-library/react';
import { useOffice365 } from '../src/hooks/useOffice365';

// æ³¨æ„: å®Ÿéš›ã®ã‚³ãƒã‚¯ã‚¿ãƒ†ã‚¹ãƒˆã¯ Power Apps ç’°å¢ƒãŒå¿…è¦
describe('Office 365 Connector Integration', () => {
  test('ãƒ•ãƒƒã‚¯ãŒæ­£å¸¸ã«åˆæœŸåŒ–ã•ã‚Œã‚‹', () => {
    const { result } = renderHook(() => useOffice365());
    
    expect(result.current.getCurrentUser).toBeDefined();
  });
});
```

---
